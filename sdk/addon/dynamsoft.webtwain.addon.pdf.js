/*! 20230919170045
* Dynamsoft JavaScript Library
* Product: Dynamic Web TWAIN
* Web Site: https://www.dynamsoft.com
*
* Copyright 2023, Dynamsoft Corporation
* Author: Dynamsoft Support Team
*
* Module: PDF
* Version: 18.4.2
* 
*/
var Dynamsoft=self.Dynamsoft||{};Dynamsoft.DWT=Dynamsoft.DWT||{},Dynamsoft.aryAddonReadyFun=Dynamsoft.aryAddonReadyFun||[],Dynamsoft.AddonReady=Dynamsoft.AddonReady||function(n){Dynamsoft.aryAddonReadyFun.push(n)},function(){Dynamsoft.DWT.EnumDWT_ConvertMode={CM_RENDERALL:1,CM_IMAGEONLY:2,CM_AUTO:3,CM_RENDERALLWITHANNOTATION:4},Dynamsoft.DWT.EnumDWT_PDFCompressionType={PDF_AUTO:0,PDF_FAX3:1,PDF_FAX4:2,PDF_LZW:3,PDF_RLE:4,PDF_JPEG:5,PDF_JP2000:6,PDF_JBIG2:7}}(),Dynamsoft.AddonReady(function(t,n){var o,e;t.product.bHTML5Edition&&(o={code:-2830,message:"The PDF resolution must be a positive number."},t.DynamicLoadAddonFuns)&&t.DynamicLoadAddonFuns.push(function(i){var n,a=t.html5.Funs;e=i.__serverPlatform==Dynamsoft.DWT.EnumDWT_PlatformType.enumMac?i._b64bit?"libDynamicPdfCorex64_"+Dynamsoft.DWT.PdfVersion+".dylib":"libDynamicPdfCore_"+Dynamsoft.DWT.PdfVersion+".dylib":i.__serverPlatform==Dynamsoft.DWT.EnumDWT_PlatformType.enumLinux||i.__serverPlatform==Dynamsoft.DWT.EnumDWT_PlatformType.enumEmbed||i.__serverPlatform==Dynamsoft.DWT.EnumDWT_PlatformType.enumChromeOS?"libDynamicPdfCore_"+Dynamsoft.DWT.PdfVersion+".so":i._b64bit?"DynamicPdfCorex64_"+Dynamsoft.DWT.PdfVersion+".dll":"DynamicPdfCore_"+Dynamsoft.DWT.PdfVersion+".dll";try{i._innerSend("GetAddOnVersion",a.makeParams("pdf",e),!0,!1,!1).catch(function(){})}catch(n){}n={PDF:{IsModuleInstalled:function(){var n=i;return n._resetErr(),""!=n._innerFun("GetAddOnVersion",a.makeParams("pdf",e))},IsModuleInstalledAsync:function(){var n=i;return n._resetErr(),n._innerFunV2("GetAddOnVersion",a.makeParams("pdf",e)).then(function(n){return""!=n})},ConvertToImage:function(n,e,r,o){var n=a.replaceLocalFilename(n),t="ConvertPDFToImage",s=i;return s._resetErr(),a.showMask(t),s._innerSend(t,a.makeParams(n,e),!0,function(n){return a.hideMask(t),r&&r(),!0},function(n){return a.hideMask(t),o&&o(),!1}),!0},SetPassword:function(n){var e=i,r=n||"";return e._resetErr(),r=e._mixSavedPdfReaderOptions({password:r}),(r=e._setReaderOptions(r,!1))&&(e._pdfOptions.password=n),r},SetConvertMode:function(n){return i._setConvertMode(n)},SetConvertModeAsync:function(n){return i._setConvertModeAsync(n)},GetConvertMode:function(){var n=i;return n._resetErr(),n._pdfConvertMode},SetResolution:function(n){var e=i,r=n;return e._resetErr(),r=e._mixSavedPdfReaderOptions({renderOptions:{resolution:r}}),(r=e._setReaderOptions(r,!1))&&(e._pdfOptions.renderOptions.resolution=n),r},SetResolutionAsync:function(e){var r=i;return r._resetErr(),!Dynamsoft.Lib.isNumber(e)||e<=0?Dynamsoft.Lib.Promise.reject(o):r._innerFunV2("SetPDFResolution",a.makeParams(e)).then(function(n){n&&(r._pdfOptions.renderOptions.resolution=e)})},SetReaderOptions:function(n){return i._setReaderOptions(n,!0)},GetReaderOptions:function(){var n,e=i;return e._resetErr(),n=i._innerFun("GetPDFReaderOptions"),n=Dynamsoft.Lib.parse(n),e._pdfOptions=e._mixSavedPdfReaderOptions(n),Dynamsoft.Lib.clone(e._pdfOptions)},IsTextBasedPDF:function(n,e,r){var o=i,n=(o._resetErr(),a.replaceLocalFilename(n)),n=i._innerFun("IsTextBasedPDF",a.makeParams(n));return 0==o.ErrorCode?t.isFunction(e)&&e(n):t.isFunction(r)&&r(o.ErrorCode,o.ErrorString),n},Write:{Setup:function(n){var n=(n=n)||{version:15},e=(2<t.stringify(n).length&&(t.isNumber(n.version)?1<=n.version&&n.version<2&&(n.version=parseInt(10*n.version)):n.version=15),t.isNumber(n.compression)&&n.compression==Dynamsoft.DWT.EnumDWT_PDFCompressionType.PDF_FAX3&&(n.compression=Dynamsoft.DWT.EnumDWT_PDFCompressionType.PDF_FAX4),i),n=(e._resetErr(),t.stringify(n)),n=t.replaceAll(n,'"','\\"');return e._innerFun("SetPDFSettings",['["',n,'"]'].join(""))}}}},i.__addon=i.__addon||{},t.mix(i.__addon,n)})}),Dynamsoft.AddonReady(function(i,n){i.product.bActiveXEdition&&i.DynamicLoadAddonFuns&&i.DynamicLoadAddonFuns.push(function(t){var n,s,e;if(!t.getSWebTwain()||!t.getSWebTwain().Addon)return!1;Dynamsoft.navInfoSync.bWin&&(e=!Dynamsoft.navInfo.bOSx64||Dynamsoft.navInfo.bWOW64?"DynamicPdfCore_"+Dynamsoft.DWT.PdfVersion+".dll":"DynamicPdfCorex64_"+Dynamsoft.DWT.PdfVersion+".dll"),s=t.getSWebTwain(),n={PDF:{IsModuleInstalled:function(){var n=s.GetAddOnVersion("pdf",e);return i.setErrorString(t),""!=n},IsModuleInstalledAsync:function(){var n=s.GetAddOnVersion("pdf",e);return i.setErrorString(t),i.Promise.resolve(""!=n)},ConvertToImage:function(n,e,r,o){n=s.ConvertPDFToImage(n,e);return i.wrapperRet(t,n,r,o)},SetPassword:function(n){n=s.SetPDFPassword(n);return i.wrapperRet(t,n)},SetConvertMode:function(n){return t._setConvertMode(n)},SetConvertModeAsync:function(n){return Promise.resolve(t._setConvertMode(n))},GetConvertMode:function(){return t._resetErr(),t._pdfConvertMode},SetResolution:function(n){n=s.SetPDFResolution(n);return i.wrapperRet(t,n)},SetResolutionAsync:function(n){n=s.SetPDFResolution(n);return i.Promise.resolve(i.wrapperRet(t,n))},SetReaderOptions:function(){return!1},GetReaderOptions:function(){return{}},IsTextBasedPDF:function(n){n=s.IsTextBasedPDF(n);return i.wrapperRet(t,n)}}},t.Addon=t.Addon||{},i.mix(t.Addon,n)})});