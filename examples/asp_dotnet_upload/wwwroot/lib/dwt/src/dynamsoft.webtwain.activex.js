/*! 20231129p1 - based on 20230615134222
* Dynamsoft JavaScript Library
* Product: Dynamic Web TWAIN
* Web Site: https://www.dynamsoft.com
*
* Copyright 2023, Dynamsoft Corporation
* Author: Dynamsoft Support Team
* Version: 18.4.2
*/
!function(){"use strict";function e(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(Jn){return void n(Jn)}s.done?t(u):Promise.resolve(u).then(r,i)}function t(t){return function(){var n=this,r=arguments;return new Promise((function(i,o){var a=t.apply(n,r);function s(t){e(a,i,o,s,u,"next",t)}function u(t){e(a,i,o,s,u,"throw",t)}s(undefined)}))}}function n(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e["default"]:e}var r={exports:{}},i={exports:{}};!function(e){function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports["default"]=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports["default"]=e.exports}(i);var o=i.exports;!function(e){var t=o["default"];function n(){e.exports=n=function(){return r},e.exports.__esModule=!0,e.exports["default"]=e.exports;var r={},i=Object.prototype,o=i.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},s="function"==typeof Symbol?Symbol:{},u=s.iterator||"@@iterator",c=s.asyncIterator||"@@asyncIterator",l=s.toStringTag||"@@toStringTag";function f(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{f({},"")}catch(O){f=function(e,t,n){return e[t]=n}}function d(e,t,n,r){var i=t&&t.prototype instanceof g?t:g,o=Object.create(i.prototype),s=new y(r||[]);return a(o,"_invoke",{value:w(e,n,s)}),o}function T(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(O){return{type:"throw",arg:O}}}r.wrap=d;var h={};function g(){}function p(){}function m(){}var _={};f(_,u,(function(){return this}));var S=Object.getPrototypeOf,I=S&&S(S(P([])));I&&I!==i&&o.call(I,u)&&(_=I);var E=m.prototype=g.prototype=Object.create(_);function v(e){["next","throw","return"].forEach((function(t){f(e,t,(function(e){return this._invoke(t,e)}))}))}function b(e,n){function r(i,a,s,u){var c=T(e[i],e,a);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==t(f)&&o.call(f,"__await")?n.resolve(f.__await).then((function(e){r("next",e,s,u)}),(function(e){r("throw",e,s,u)})):n.resolve(f).then((function(e){l.value=e,s(l)}),(function(e){return r("throw",e,s,u)}))}u(c.arg)}var i;a(this,"_invoke",{value:function(e,t){function o(){return new n((function(n,i){r(e,t,n,i)}))}return i=i?i.then(o,o):o()}})}function w(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return D()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=C(a,n);if(s){if(s===h)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=T(e,t,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===h)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}function C(e,t){var n=t.method,r=e.iterator[n];if(undefined===r)return t.delegate=null,"throw"===n&&e.iterator["return"]&&(t.method="return",t.arg=undefined,C(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=T(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,h;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=undefined),t.delegate=null,h):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,h)}function A(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function W(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function y(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function P(e){if(e){var t=e[u];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(o.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=undefined,t.done=!0,t};return r.next=r}}return{next:D}}function D(){return{value:undefined,done:!0}}return p.prototype=m,a(E,"constructor",{value:m,configurable:!0}),a(m,"constructor",{value:p,configurable:!0}),p.displayName=f(m,l,"GeneratorFunction"),r.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},r.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,f(e,l,"GeneratorFunction")),e.prototype=Object.create(E),e},r.awrap=function(e){return{__await:e}},v(b.prototype),f(b.prototype,c,(function(){return this})),r.AsyncIterator=b,r.async=function(e,t,n,i,o){void 0===o&&(o=Promise);var a=new b(d(e,t,n,i),o);return r.isGeneratorFunction(t)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},v(E),f(E,l,"Generator"),f(E,u,(function(){return this})),f(E,"toString",(function(){return"[object Generator]"})),r.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function i(){for(;n.length;){var e=n.pop();if(e in t)return i.value=e,i.done=!1,i}return i.done=!0,i}},r.values=P,y.prototype={constructor:y,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=undefined,this.done=!1,this.delegate=null,this.method="next",this.arg=undefined,this.tryEntries.forEach(W),!e)for(var t in this)"t"===t.charAt(0)&&o.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=undefined)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=undefined),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var s=o.call(i,"catchLoc"),u=o.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&o.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),W(n),h}},"catch":function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;W(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:P(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=undefined),h}},r}e.exports=n,e.exports.__esModule=!0,e.exports["default"]=e.exports}(r);var a=(0,r.exports)(),s=a;try{regeneratorRuntime=a}catch(Fa){"object"==typeof globalThis?globalThis.regeneratorRuntime=a:Function("r","regeneratorRuntime = r")(a)}var u,c,l=n(s);function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function T(e){var t=function(e,t){if("object"!==f(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(n!==undefined){var r=n.call(e,t||"default");if("object"!==f(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===f(t)?t:String(t)}function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,T(r.key),r)}}function g(e,t,n){return t&&h(e.prototype,t),n&&h(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function p(e){var t=e?new Date(e):new Date,n="yyyy-MM-dd HH:mm:ss.SSSZ",r={"M+":t.getUTCMonth()+1,"d+":t.getUTCDate(),"H+":t.getUTCHours(),"h+":t.getUTCHours()%12||12,"m+":t.getUTCMinutes(),"s+":t.getUTCSeconds(),"q+":Math.floor((t.getUTCMonth()+3)/3),"S+":t.getUTCMilliseconds()};for(var i in/(y+)/.test(n)&&(n=n.replace(RegExp.$1,(t.getUTCFullYear()+"").substr(4-RegExp.$1.length))),r)new RegExp("("+i+")").test(n)&&(n=n.replace(RegExp.$1,1==RegExp.$1.length?r[i]:("000"+r[i]).substr(("000"+r[i]).length-RegExp.$1.length)));return n}function m(e){return e===c}function _(e){return e!==c}function S(e){return null===e}u="object"===("undefined"==typeof window?"undefined":f(window))?window:{};var I={"[object Function]":"function","[object AsyncFunction]":"function","[object String]":"string","[object Object]":"object","[object Boolean]":"boolean","[object Number]":"number","[object Array]":"array"};function E(e){return S(e)||m(e)?String(e):I[{}.toString.call(e)]||"object"}function v(e){return"function"===E(e)}function b(e){return"string"===E(e)}function w(e){return"object"===E(e)}function C(e){return"boolean"===E(e)}function A(e){return"number"===E(e)}function W(e){return Array.isArray?Array.isArray(e):"array"===E(e)}function y(e){if(null==e)return[];if(W(e))return e;var t=f(e.length),n=f(e);if("number"!==t||e.alert||"string"===n||"function"===n&&(!("item"in e)||"number"!==t))return[e];for(var r=[],i=0,o=e.length;i<o;i++)r[i]=e[i];return r}var P,D,O={debug:!1,showConsoleError:!1};function L(){return P}function N(e){P=e}function R(e,t,n,r){if(O.debug&&D&&v(D.log)){var i=p((new Date).getTime()),o=y(arguments);D.log(["[",i,"] ",o].join(""))}}function x(e,t,n,r){if((O.debug||O.showConsoleError)&&D&&v(D.error)){var i=p((new Date).getTime()),o=y(arguments);D.error(["[",i,"] ",o].join(""))}}function F(e,t,n,r){if(O.debug&&D&&v(D.warn)){var i=p((new Date).getTime()),o=y(arguments);D.warn(["[",i,"] ",o].join(""))}}function k(e,t,n,r){if(O.debug&&D&&v(D.info)){var i=p((new Date).getTime()),o=y(arguments);D.info(["[",i,"] ",o].join(""))}}u&&_(u.console)&&(v((D=u.console).log)&&v(D.error)?P={log:R,error:x,info:k,warn:F,debug:function(e,t,n,r){if(O.debug&&D&&v(D.debug)){var i=p((new Date).getTime()),o=y(arguments);D.debug(["[",i,"] ",o].join(""))}}}:(D=!1,P=!1));var M={queue:[],doNextStarted:!1,timer:null,pushToDo:function(e,t,n){M.queue.push({obj:e,method:t,args:n})},doNext:function(){if(M.doNextStarted)if(0!=M.queue.length){var e=M.queue[0],t=e.obj,n=e.method,r=e.args;if(M.queue.splice(0,1),t&&v(t[n])){var i=!1;if(r.length>2){var o=r[r.length-2],a=r[r.length-1];v(o)&&v(a)&&(r[r.length-2]=function(){try{o.apply(t,arguments)}catch(e){}M.timer=setTimeout(M.doNext,0)},r[r.length-1]=function(){try{a.apply(t,arguments)}catch(e){}M.timer=setTimeout(M.doNext,0)},i=!0)}try{t[n].apply(t,r)}catch(s){}i||(M.timer=setTimeout(M.doNext,0))}else if(null===t&&v(n)){try{n.apply(null,r)}catch(u){}M.timer=setTimeout(M.doNext,0)}else R("not invoke a function: "+n),M.timer=setTimeout(M.doNext,0)}else M.stop();else M.stop()},start:function(){M.doNextStarted||(M.doNextStarted=!0,M.timer=setTimeout(M.doNext,0))},stop:function(){clearTimeout(M.timer),M.timer=null,M.doNextStarted=!1,M.queue=[]}},B=!0,G=!1;function U(e,t,n){if(e){var r,i,o,a=0,s=e.length;if(n=n||null,m(s)||v(e))for(o=Object.keys(e);a<o.length&&(r=o[a],t.call(n,e[r],r,e)!==G);a++);else for(i=e[0];a<s&&t.call(n,i,a,e)!==G;i=e[++a]);}return e}var H={fire:function(e){var t,n=this;n.exec=n.exec||{},e=e.toLowerCase(),t=Array.prototype.slice.call(arguments,1),U(n.exec[e]||[],(function(e){var r=e.f,i=e.c||n;try{r.apply(i,t)}catch(o){R(o)}}))},on:function(e,t,n){var r=this;r.exec=r.exec||{},e=e.toLowerCase(),r.exec[e]=r.exec[e]||[],r.exec[e].push({f:t,c:n})},off:function(e,t,n){var r=this.exec;if(r)if(e)if(e=e.toLowerCase(),t)for(var i=r[e]||[],o=i.length-1;o>=0;o--)i[o]===t&&i.splice(o,1);else r[e]=null;else this.exec=null}};function j(e){return null!=e&&e==e.window}function V(e){e&&/\S/.test(e)&&(u.execScript?u.execScript(e):function(e){u.eval.call(u,e)}(e))}var X,K="";var z,J,Y,q,Q=navigator,Z=!0;if("userAgentData"in Q){var $=Q.userAgentData,ee=[];$.platform&&""!=$.platform&&("brands"in $&&Array.isArray($.brands)&&$.brands.length>0?ee=$.brands:"uaList"in $&&Array.isArray($.uaList)&&$.uaList.length>0&&(ee=$.uaList),ee.length>0&&(Z=!1,J=$.platform.toLowerCase(),z=function(e,t,n){var r,i,o,a,s,u,c,l,f,d=!1,T=!1,h=!1,g=e.mobile,p=!1,m=K,_=navigator.maxTouchPoints||0;for(i=t.length,r=0;r<i;r++){var S=t[r].brand.toLowerCase();if(S.indexOf("chrome")>=0){h=!0,m=t[r].version;break}if(S.indexOf("edge")>=0){d=!0,m=t[r].version;break}if(S.indexOf("opera")>=0){T=!0,m=t[r].version;break}}return h||d||T||(h=!0,m="100"),o=/windows/g.test(n),a=/mac/g.test(n),s=/linux/g.test(n),u=/android/g.test(n),c=/harmony/g.test(n),l=/(chromeos|chrome\sos)/g.test(n),f=/iphone/g.test(n),o||u||s||f||(p=/macintel/g.test(n)&&_>1),(u||c||f||p)&&(g=!0),{bUseUserAgent:!1,bWin:o,bMac:a,bLinux:s,bAndroid:u,bHarmonyOS:c,bChromeOS:l,bIE:!1,bEdge:d,bUC:!1,bPlaybook:!1,bBlackBerry:!1,bHuaWeiBrowser:!1,bOpera:T,bFirefox:!1,bChrome:h,bJSDom:!1,biPhone:f,biPad:p,bPad:u&&!e.mobile,bSafari:!1,bMobile:g,strBrowserVersion:m,bHTML5Edition:!0,IEVersion:0,IEMode:0}}($,ee,J)))}Z&&(Y||(Y=Q.userAgent.toLowerCase()),q||(q=Q.platform.toLowerCase()),z=function(e,t){var n,r=e.toLowerCase(),i=t.toLowerCase(),o=/harmonyos/g.test(r);"linux"==i&&r.indexOf("windows nt")>=0&&(i="harmonyos",o=!0);var a=!o&&/cros/.test(r),s=!o&&/android/g.test(r)||/android/g.test(i),u=/iphone/g.test(r)||/iphone/g.test(i),c=/macintosh/.test(r),l=navigator.maxTouchPoints||0,f=/ipad/g.test(r)||(c||"macintel"==i)&&l>1,d=/ucweb|ucbrowser/g.test(r),T=!d&&/nexus/g.test(r)&&/version\/[\d.]+.*safari\//g.test(r),h=/playbook/g.test(r),g=/hp-tablet/g.test(r),p=/blackberry|bb10/g.test(r),m=/symbian/g.test(r),_=/windows phone/g.test(r),S=/mobile/g.test(r),I=/arm64|aarch64/g.test(r),E=/mips64/g.test(r),v=/huaweibrowser/g.test(r),b=/jsdom/g.test(r),w=h||f||g,C=!w&&!a&&(u||T||p||m||_||s||o||S),A=!C&&!w&&!a,W=A&&/win32|win64|windows/.test(i),y=W&&/win64|x64/.test(r),P=A&&/mac68k|macppc|macintosh|macintel/.test(r),D=A&&/linux/.test(i),O="win64"==i||/wow64|x86_64|win64|x64/.test(r)||I||E,L=/wow64/g.test(r),N=G,R=/opera|opr/g.test(r),x=/360se/g.test(r),F=/maxthon/g.test(r),k=/tencenttraveler|qqbrowser/g.test(r),M=/the world/g.test(r),U=/metasr/g.test(r),H=/avant/g.test(r),j=/firefox|fxios/g.test(r),V=/gecko/g.test(r),X=!(j||v)&&/edge\/|edga\/|edgios\/|edg\//g.test(r),z=!(p||h||d||R||X||v||b)&&/chrome|crios/g.test(r),J=!1,Y=0,q=0,Q=K;if(W&&!X&&!j&&!z){var Z=r.indexOf("msie "),$=r.indexOf("trident"),ee=r.indexOf("rv:");J=-1!=Z||-1!=$||-1!=ee}if(!(P||u||f||W||p||h||T)||d||R||X||J||j||(n=r.match(/version\/([\d.]+).*safari\//))&&(p||h||T||(N=B,z=G),Q=n[1]),X){var te=r.indexOf("edge/");te>-1?te+=5:(te=r.indexOf("edg/"))>-1?te+=4:(te=r.indexOf("edga/"))>-1?te+=5:(te=r.indexOf("edgios/"))>-1&&(te+=7),te>-1&&(n=(Q=r.slice(te)).indexOf(" "))>-1&&(Q=Q.slice(0,n))}else if(j)if((n=r.indexOf("firefox/"))>-1){var ne=(n=r.slice(n+8)).indexOf(" ");ne>-1&&(n=n.slice(0,ne)),Q=n,(ne=n.indexOf("."))>-1&&(n=Q.slice(0,ne))}else(u||f)&&(n=r.indexOf("fxios/"))>-1&&(Q=n=(n=r.slice(n+6)).slice(0,n.indexOf(" ")));else if(J){var re=r.indexOf("msie "),ie=r.indexOf("trident"),oe=r.indexOf("rv:");-1!=re?n=(n=r.slice(re+5)).slice(0,n.indexOf(";")):-1!=oe?n=(n=(n=r.slice(oe+3)).slice(0,n.indexOf(";"))).slice(0,n.indexOf(")")):-1!=ie&&(n=(n=r.slice(ie+7)).slice(0,n.indexOf(";"))),Q=n}else if(N)(n=Q.indexOf("."))>-1&&(n=Q.slice(0,n));else if(d)(n=r.indexOf("ucweb"))>-1?Q=r.slice(n+5):(n=r.indexOf("ucbrowser/"))>-1&&(n=(Q=r.slice(n+10)).indexOf(" "))>-1&&(Q=Q.slice(0,n));else if(R)(n=r.indexOf("version/"))>-1?Q=r.slice(n+8):(n=r.indexOf("opr/"))>-1&&(Q=r.slice(n+4));else if(m)(n=r.indexOf("browserng/"))>-1&&(Q=r.slice(n+10));else if(_)(n=r.indexOf("iemobile/"))>-1&&(Q=r.slice(n+9));else if(z){var ae=r.indexOf("chrome/");ae>-1?(n=(Q=r.slice(ae+7)).indexOf(" "))>-1&&(Q=Q.slice(0,n)):(ae=r.indexOf("crios/"))>-1&&(n=(Q=r.slice(ae+6)).indexOf(" "))>-1&&(Q=Q.slice(0,n)),(n=Q.indexOf("."))>-1&&(n=Q.slice(0,n))}else if(v){var se=r.indexOf("huaweibrowser");se>-1&&(n=(Q=r.slice(se+14)).indexOf(" "))>-1&&(Q=Q.slice(0,n))}else if(b){var ue=r.indexOf("jsdom");ue>-1&&(n=(Q=r.slice(ue+6)).indexOf(" "))>-1&&(Q=Q.slice(0,n))}if(X||J){var ce=window.document;ce&&ce.documentMode?Y=ce.documentMode:(Y=5,ce.compatMode&&"CSS1Compat"==ce.compatMode&&(Y=7)),J&&(q=parseInt(Q))}return(P||D)&&(O=!0,P&&(n=r.match(/mac os x (\d+)(_|\.)(\d+)/))&&n.length>3&&(10==n[1]&&n[3]<14||n[1]<10)&&(O=!1)),W||P||D||I||E||(C=!0),{bUseUserAgent:!0,bWin:W,bMac:P,bLinux:D,bMobile:C,bPad:w,bChromeOS:a,bHarmonyOS:o,bArm64:I,bMips64:E,bEmbed:I||E,bAndroid:s,biPhone:u,biPad:f,bWin64:y,bWOW64:L,bOSx64:O,bIE:J,bEdge:X,bChrome:z,bFirefox:j,bSafari:N,bOpera:R,bNexus:T,bUC:d,b360SE:x,bMaxthon:F,bTencentTraveler:k,bTheWorld:M,bMetaSr:U,bAvant:H,bHuaWeiBrowser:v,bJSDom:b,bGecko:V,bHTML5Edition:!0,strBrowserVersion:Q,IEVersion:q,IEMode:Y}}(Y,q));var te=null===(X=null==u?void 0:u.location)||void 0===X?void 0:X.protocol;function ne(e){return z.bGecko&&"mousewheel"===e?"DOMMouseScroll":e}function re(e,t,n){var r=ne(t);e&&e.addEventListener(r,n,!1)}function ie(e,t,n){var r=ne(t);e&&e.removeEventListener(r,n,!1)}function oe(e){var t=e||u.event;t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.returnValue=!1,t.cancelBubble=!0}function ae(e,t){var n=u.document.createEvent("HTMLEvents");n.initEvent(e,B,B),t.dispatchEvent&&t.dispatchEvent(n)}te||(te="http:"),z.protocol=te,z.bSSL="https:"===te,z.bFileSystem="https:"!==te&&"http:"!==te;var se,ue,ce,le,fe=u.document,de=[],Te=de.push,he=de.slice,ge=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,pe=function(){ue()};function me(e,t,n,r){var i,o,a,s=t&&t.ownerDocument,u=t?t.nodeType:9;if(n=n||[],"string"!=typeof e||!e||1!==u&&9!==u&&11!==u)return n;if(!r&&((t?t.ownerDocument||t:fe)!==ce&&ue(t),t=t||ce,11!==u&&(a=ge.exec(e))))if(i=a[1]){if(9===u){if(!(o=t.getElementById(i)))return n;if(o.id===i)return n.push(o),n}else if(s&&(o=s.getElementById(i))&&le(t,o)&&o.id===i)return n.push(o),n}else{if(a[2])return Te.apply(n,t.getElementsByTagName(e)),n;if((i=a[3])&&t.getElementsByClassName)return Te.apply(n,t.getElementsByClassName(i)),n}return n}Te.apply(he.call(fe.childNodes),fe.childNodes),ue=me.setDocument=function(e){var t,n=e?e.ownerDocument||e:fe;return n!==ce&&9===n.nodeType&&n.documentElement?(fe!==(ce=n)&&(t=ce.defaultView)&&t.top!==t&&(t.addEventListener?t.addEventListener("unload",pe,!1):t.attachEvent&&t.attachEvent("onunload",pe)),le=function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},ce):ce},me.contains=function(e,t){return(e.ownerDocument||e)!==ce&&ue(e),le(e,t)},me.error=function(e){throw new Error("Syntax error: "+e)},se=me.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=se(e)}else if(3===i||4===i)return e.nodeValue}else for(;t=e[r++];)n+=se(t);return n},ue();var _e={encodeChars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",decodeChars:[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1]},Se={UTF16ToUTF8:function(e){for(var t,n,r=[],i=e.length,o=0;o<i;o++){var a=e.charCodeAt(o);if(a>0&&a<=127)r.push(e.charAt(o));else if(a>=128&&a<=2047)t=192|a>>6&31,n=128|63&a,r.push(String.fromCharCode(t),String.fromCharCode(n));else if(a>=2048&&a<=65535){t=224|a>>12&15,n=128|a>>6&63;var s=128|63&a;r.push(String.fromCharCode(t),String.fromCharCode(n),String.fromCharCode(s))}}return r.join("")},UTF8ToUTF16:function(e){var t,n,r,i,o=[],a=e.length;for(t=0;t<a;t++)0==((n=e.charCodeAt(t))>>7&255)?o.push(e.charAt(t)):6==(n>>5&255)?(i=(31&n)<<6|63&(r=e.charCodeAt(++t)),o.push(String.fromCharCode(i))):14==(n>>4&255)&&(i=(255&(n<<4|(r=e.charCodeAt(++t))>>2&15))<<8|((3&r)<<6|63&e.charCodeAt(++t)),o.push(String.fromCharCode(i)));return o.join("")},encode:function(e){for(var t,n,r,i=this.UTF16ToUTF8(e),o=[],a=0,s=i.length;a<s;){if(t=255&i.charCodeAt(a++),a==s){o.push(_e.encodeChars.charAt(t>>2)),o.push(_e.encodeChars.charAt((3&t)<<4)),o.push("==");break}if(n=i.charCodeAt(a++),a==s){o.push(_e.encodeChars.charAt(t>>2)),o.push(_e.encodeChars.charAt((3&t)<<4|(240&n)>>4)),o.push(_e.encodeChars.charAt((15&n)<<2)),o.push("=");break}r=i.charCodeAt(a++),o.push(_e.encodeChars.charAt(t>>2)),o.push(_e.encodeChars.charAt((3&t)<<4|(240&n)>>4)),o.push(_e.encodeChars.charAt((15&n)<<2|(192&r)>>6)),o.push(_e.encodeChars.charAt(63&r))}return o.join("")},encodeArray:function(e){for(var t,n,r,i=[],o=0,a=e.length;o<a;){if(t=255&e[o++],o==a){i.push(_e.encodeChars.charAt(t>>2)),i.push(_e.encodeChars.charAt((3&t)<<4)),i.push("==");break}if(n=255&e[o++],o==a){i.push(_e.encodeChars.charAt(t>>2)),i.push(_e.encodeChars.charAt((3&t)<<4|(240&n)>>4)),i.push(_e.encodeChars.charAt((15&n)<<2)),i.push("=");break}r=255&e[o++],i.push(_e.encodeChars.charAt(t>>2)),i.push(_e.encodeChars.charAt((3&t)<<4|(240&n)>>4)),i.push(_e.encodeChars.charAt((15&n)<<2|(192&r)>>6)),i.push(_e.encodeChars.charAt(63&r))}return i.join("")},decode:function(e,t){for(var n,r,i,o,a=this,s=[],u=0,c=e.length;u<c;){do{n=_e.decodeChars[255&e.charCodeAt(u++)]}while(u<c&&-1==n);if(-1==n)break;do{r=_e.decodeChars[255&e.charCodeAt(u++)]}while(u<c&&-1==r);if(-1==r)break;t?s.push(n<<2|(48&r)>>4):s.push(String.fromCharCode(n<<2|(48&r)>>4));do{if(61==(i=255&e.charCodeAt(u++)))return t?s:a.UTF8ToUTF16(s.join(""));i=_e.decodeChars[i]}while(u<c&&-1==i);if(-1==i)break;t?s.push((15&r)<<4|(60&i)>>2):s.push(String.fromCharCode((15&r)<<4|(60&i)>>2));do{if(61==(o=255&e.charCodeAt(u++)))return t?s:a.UTF8ToUTF16(s.join(""));o=_e.decodeChars[o]}while(u<c&&-1==o);if(-1==o)break;t?s.push((3&i)<<6|o):s.push(String.fromCharCode((3&i)<<6|o))}return t?s:a.UTF8ToUTF16(s.join(""))}},Ie={fromUTF16:function(e){for(var t,n=[],r=0,i=e.length;r<i;)(t=e.charCodeAt(r))>=1&&t<=127?n.push(e.charAt(r)):t>2047?(n.push(String.fromCharCode(224|t>>12&15)),n.push(String.fromCharCode(128|t>>6&63)),n.push(String.fromCharCode(128|t>>0&63))):(n.push(String.fromCharCode(192|t>>6&31)),n.push(String.fromCharCode(128|t>>0&63))),r++;return n.join("")},toUTF16:function(e){for(var t,n,r,i=[],o=0,a=e.length;o<a;)switch((t=e.charCodeAt(o++))>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:i.push(e.charAt(o-1));break;case 12:case 13:n=e.charCodeAt(o++),i.push(String.fromCharCode((31&t)<<6|63&n));break;case 14:n=e.charCodeAt(o++),r=e.charCodeAt(o++),i.push(String.fromCharCode((15&t)<<12|(63&n)<<6|(63&r)<<0))}return i.join("")}};function Ee(e){if(null==e||"object"!=f(e))return e;var t,n,r;if(e instanceof Date)return(t=new Date).setTime(e.getTime()),t;if(e instanceof Array){for(t=[],r=e.length,n=0;n<r;n++)t[n]=Ee(e[n]);return t}if(e instanceof Object){for(n in t={},e)e.hasOwnProperty(n)&&(t[n]=Ee(e[n]));return t}return 0}function ve(e){return Math.random().toString(16).substring(2,2+e)}function be(e){var t=[ve(8),"-",ve(4),"-",ve(4),"-",ve(4),"-",ve(8)];return e&&t.unshift(e),t.join("")}var we=Date.now||function(){return+new Date},Ce=function(){return""+we()};function Ae(){for(var e,t=we()%1e4,n=[],r=0;r<5;r++)e=Math.floor(10*Math.random()),0!=r||0!=e?n.push(e):r=-1;return t<10?n.push("000"):t<100?n.push("00"):t<1e3&&n.push("0"),n.push(t),n.join("")}function We(e,t){var n;for(n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function ye(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(t){o(t)}}function s(e){try{u(r["throw"](e))}catch(t){o(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))}var Pe=!1;"wakeLock"in navigator&&(Pe=!0);var De=null;function Oe(){Pe&&(null==De?function(){ye(this,void 0,void 0,l.mark((function e(){return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.wakeLock.request("screen");case 3:De=e.sent,e.next=9;break;case 6:e.prev=6,e.t0=e["catch"](0),De=null;case 9:case"end":return e.stop()}}),e,null,[[0,6]])})))}():De.release().then((function(){De=null})))}function Le(){return De}var Ne=Array.prototype;function Re(e,t,n){return Ne.filter.call(e,t,n||this)}function xe(e,t){return Ne.indexOf.call(t,e)}function Fe(e){var t,n,r=[],i=e.length;for(t=0;t<i;t++){for(n=t+1;n<i;n++)e[t]===e[n]&&(n=++t);r.push(e[t])}return r}var ke=/^(\/?)([\s\S]+\/(?!$)|\/)?((?:\.{1,2}$|[\s\S]+?)?(\.[^.\/]*)?)$/;function Me(e,t){var n,r=[];for(n=0;n<e.length;n++){var i=e[n];i&&"."!==i&&(".."===i?r.length&&".."!==r[r.length-1]?r.pop():t&&r.push(".."):r.push(i))}return r}function Be(e){var t="/"===e.charAt(0),n="/"===e.slice(-1);return(e=Me(Re(e.split("/"),(function(e){return!!e})),!t).join("/"))||t||(e="."),e&&n&&(e+="/"),(t?"/":"")+e}var Ge=function(){function e(){d(this,e)}return g(e,[{key:"resolve",value:function(){var e,t,n="",r=arguments,i=!1;for(e=r.length-1;e>=0&&!i;e--)b(t=r[e])&&t&&(n=t+"/"+n,i="/"===t.charAt(0));return(i?"/":"")+Me(Re(n.split("/"),(function(e){return!!e})),!i).join("/")||"."}},{key:"join",value:function(){return Be(Re(y(arguments),(function(e){return e&&b(e)})).join("/"))}},{key:"relative",value:function(e,t){e=Be(e),t=Be(t);var n,r,i=Re(e.split("/"),(function(e){return!!e})),o=[],a=Re(t.split("/"),(function(e){return!!e})),s=Math.min(i.length,a.length);for(n=0;n<s&&i[n]===a[n];n++);for(r=n;n<i.length;)o.push(".."),n++;return(o=o.concat(a.slice(r))).join("/")}},{key:"basename",value:function(e,t){var n;return n=(e.match(ke)||[])[3]||"",t&&n&&n.slice(-1*t.length)===t&&(n=n.slice(0,-1*t.length)),n}},{key:"dirname",value:function(e){var t=e.match(ke)||[],n=t[1]||"",r=t[2]||"";return n||r?(r&&(r=r.substring(0,r.length-1)),n+r):"."}},{key:"extname",value:function(e){return(e.match(ke)||[])[4]||""}}]),e}(),Ue={}.hasOwnProperty;function He(e){if(!e||"object"!==E(e)||e.nodeType||e.window==e)return G;var t,n;try{if((n=e.constructor)&&!Ue(e,"constructor")&&!Ue(n.prototype,"isPrototypeOf"))return G}catch(r){return G}for(t in e);return m(t)||Ue(e,t)}var je="object"===("undefined"==typeof HTMLElement?"undefined":f(HTMLElement));function Ve(e){return je?e instanceof HTMLElement:e&&"object"===f(e)&&(1===e.nodeType||9===e.nodeType)&&"string"==typeof e.nodeName}function Xe(e){var t=e;if(Ve(e))for(;!t&&t!=document.body;)t=t.parentNode;else t=0;return!!t}function Ke(e,t){return 0===e.lastIndexOf(t,0)}function ze(e,t){var n=e.length-t.length;return n>=0&&e.indexOf(t,n)===n}function Je(e){return null==e?K:String.prototype.trim.call(e)}function Ye(e){var t;if(e)for(t in e)if(!m(t))return!1;return!0}function qe(e){return b(e)?e.replace(/[^\x20-\x7E]/g,""):e}function Qe(e,t,n){return e.replace(new RegExp(t,"gi"),n)}function Ze(e){return e.charAt(0).toUpperCase()+e.substr(1)}var $e="none",et={getOffset:function(e,t,n){var r,i;e=e||u.event;for(var o,a,s=n||e.target,c=0,l=0,f=0,d=0,T=!1,h=u.document;s&&!isNaN(s.offsetLeft)&&!isNaN(s.offsetTop);)a=s.scrollLeft,o=s.scrollTop,"BODY"===s.tagName?T?(a=0,o=0):(a|=null===(r=h.documentElement)||void 0===r?void 0:r.scrollLeft,o|=null===(i=h.documentElement)||void 0===i?void 0:i.scrollTop):"fixed"===s.style.position&&(T=!0),c+=s.offsetLeft-a,l+=s.offsetTop-o,s=s.offsetParent;return t&&(f=t.Left,d=t.Top),{x:c=e.clientX-c-f,y:l=e.clientY-l-d}},getElDimensions:function(e,t){var n,r;return e?(n=e.style.display,e.style.display="",r=t?{offsetTop:e.offsetTop,offsetLeft:e.offsetLeft,offsetWidth:e.offsetWidth,offsetHeight:e.offsetHeight}:{clientTop:e.clientTop,clientLeft:e.clientLeft,clientWidth:e.clientWidth?e.clientWidth:parseInt(e.style.width)?parseInt(e.style.width):0,clientHeight:e.clientHeight?e.clientHeight:parseInt(e.style.height)?parseInt(e.style.height):0},e.style.display=n,r):{offsetTop:0,offsetLeft:0,offsetWidth:0,offsetHeight:0}}};function tt(e){return document.getElementById(e)}function nt(e){var t=b(e)?tt(e):e;t&&(t.length>0&&(t=t[0]),t.style.display=$e)}function rt(e){var t=b(e)?tt(e):e;t&&(t.length>0&&(t=t[0]),t.style.display=K)}function it(e){var t=b(e)?tt(e):e;t&&(t.length>0&&(t=t[0]),t.style.display===$e?t.style.display=K:t.style.display=$e)}function ot(e){if(e)for(;e.firstChild;)e.removeChild(e.firstChild)}function at(e){return encodeURIComponent(String(e))}function st(e){return decodeURIComponent(e.replace(/\+/g," "))}var ut=!0,ct=document,lt=ct&&ct.documentElement,ft=ct.getElementsByTagName("head")[0]||lt,dt=ct.createElement("script").readyState?function(e,t){var n=e.onreadystatechange;e.onreadystatechange=function(){var r=e.readyState;if("loaded"===r||"complete"===r){e.onreadystatechange=null,n&&n();t.call(this,{type:"load",path:[e]})}else"loading"===r||t.call(this,{type:"error",path:[e]})}}:function(e,t){e.addEventListener("load",t,G),e.addEventListener("error",t,G)};function Tt(e,t,n){return ht(e,t,!1,n)}function ht(e,t,n,r){var i,o,a=r;if(v(a)||(a=function(){}),b(e)&&e!=K)return i=ct.createElement("script"),o=["",e].join(K),i.src=o,t&&(i.async=ut),i.charset="utf-8",dt(i,a),n?ft.appendChild(i):ft.insertBefore(i,ft.firstChild),i;a()}function gt(e,t,n){return pt(e,t,!1,n)}function pt(e,t,n,r){var i=r;if(v(i)||(i=function(){}),z.bJSDom)i("ok");else if(W(e)){var o=e.length,a=function(e){e&&"load"==e.type?o--:(e&&"error"==e.type&&x(["Failed to load resource: ",e.target.src,"."].join("")),i()),o<=0&&i("ok")};o<=0?i("ok"):U(e,(function(e){ht(e,t,n,a)}))}else i()}function mt(e,t){return _t(e,!1,t)}function _t(e,t,n){var r,i=n;if(v(i)||(i=!1),b(e)&&e!=K){if(!z.bJSDom)return(r=ct.createElement("link")).href=e,r.rel="stylesheet",r.async=ut,i&&dt(r,i),t?ft.appendChild(r):ft.insertBefore(r,ft.firstChild),r;i&&i()}else i&&i()}function St(e,t){return It(e,!1,t)}function It(e,t,n){if(z.bJSDom)n&&n("ok");else if(W(e)){var r=e.length,i=function(e){e&&"load"==e.type&&r--,e&&"load"!=e.type&&(e&&"error"==e.type&&x(["Failed to load resource: ",e.target.href,"."].join("")),n()),r<=0&&n("ok")};U(e,(function(e){_t(e,t,i)}))}else n&&n()}function Et(e){var t,n;if(!z.bJSDom){var r=document;if(r&&b(n=e.body)&&n!=K){(t=r.createElement("script")).charset="utf-8",z.bIE?t.text=n:t.appendChild(r.createTextNode(n)),e.language?t.language=e.language:t.language="javascript",e.type?t.type=e.type:t.type="text/javascript";var i=r&&r.documentElement,o=r.getElementsByTagName("head")[0]||i;o.insertBefore(t,o.firstChild)}}}function vt(e){Et({body:e})}function bt(e){Et({body:e,language:"vbscript",type:"text/vbscript"})}var wt,Ct,At=new(function(){function e(){d(this,e),this.nil=undefined,this.bNode=!1,this.noop=function(){},this.mix=We,this.clone=Ee,this.keys=Object.keys,this.now=Ce,this.getFormatedNow=p,this.getRandom=Ae,this.guid=be,this.get=tt,this.show=rt,this.hide=nt,this.toggle=it,this.empty=ot,this.stringify=u.JSON.stringify,this.parse=u.JSON.parse,this.isDef=_,this.isUndef=m,this.isUndefined=m,this.isNull=S,this.isNaN=isNaN,this.isFunction=v,this.isString=b,this.isObject=w,this.isBoolean=C,this.isNumber=A,this.isArray=W,this.type=E,this.isPlainObject=He,this.isDOM=Ve,this.isDOMInBody=Xe,this.each=U,this.getLogger=L,this.setLogger=N,this.log=R,this.error=x,this.warn=F,this.info=k,this.filter=Re,this.indexOf=xe,this.uniq=Fe,this.startsWith=Ke,this.endsWith=ze,this.replaceAll=Qe,this.upperCaseFirst=Ze,this.removeNonPrintableChar=qe,this.trim=Je,this.makeArray=y,this.isEmptyObject=Ye,this.Path=new Ge,this.DOM=et,this.isWindow=j,this.globalEval=V,this.obj={customEvent:H},this.addEventListener=re,this.removeEventListener=ie,this.stopPropagation=oe,this.fireEvent=ae,this.base64=Se,this.utf8=Ie,this.btoa=function(e){return u.btoa(e)},this.atob=function(e){return u.atob(e)},this.asyncQueue=M,this.sizzle=me,this.toggleWakeLock=Oe,this.getWakeLock=Le,this.urlEncode=at,this.urlDecode=st,this.scriptOnload=dt,this.addAllCss=It,this.getAllCss=St,this.addCss=_t,this.getCss=mt,this.addScripts=pt,this.getScripts=gt,this.addScript=ht,this.getScript=Tt,this.addJS=vt,this.addVBS=bt}return g(e,[{key:"debug",get:function(){return O.debug},set:function(e){O.debug=e}},{key:"showConsoleError",get:function(){return O.debug},set:function(e){O.showConsoleError=e}}]),e}()),Wt=!!("object"==("undefined"==typeof global?"undefined":f(global))&&global.process&&global.process.release&&global.process.release.name&&"undefined"==typeof HTMLCanvasElement)?global:self||{},yt=Wt.Dynamsoft;yt?yt.Lib||(yt.Lib={}):(yt={Lib:{},DWT:{}},Wt&&(Wt.Dynamsoft=yt)),wt=At.mix(yt.Lib,At),(Ct=yt).DWT||(Ct.DWT={}),Ct.DWT.LTS||(Ct.DWT.LTS={}),Ct.Lib.UI||(Ct.Lib.UI={}),Ct.Lib.html5||(Ct.Lib.html5={});var Pt="18",Dt="4",Ot="".concat(Pt,",").concat(Dt,",").concat("2",",").concat("1110"),Lt="".concat(Pt,",").concat("4",",").concat("2",",").concat("1110");z.bAndroid;var Nt,Rt,xt={JSVersion:"18,4,2,1110",ServerVersionInfo:"18,4,2,1110",ServerLinuxVersionInfo:"18,4,2,1110",ServerMacVersionInfo:"18,4,2,1110",ActiveXVersion:"18,4,2,1212",ActiveXPdfVersion:"11.5.1.0926",PdfVersion:"11.5.1.0926",PdfLinuxVersion:"11.5.1.0926",PdfMacVersion:"11.5.1.0926"};!function(e){e.enumUnknown=-1,e.enumChrome=1,e.enumFirefox=2,e.enumEdge=3,e.enumSafari=4,e.enumIE=5,e.enumOpera=6,e.enumHuaWeiBrowser=7}(Nt||(Nt={})),function(e){e.enumUnknown=-1,e.enumWindow=0,e.enumMac=1,e.enumLinux=2,e.enumEmbed=3,e.enumChromeOS=4,e.enumHarmonyOS=5,e.enumAndroid=6,e.enumiOS=7}(Rt||(Rt={}));var Ft={getDSPath:function(e){var t=yt.DWT.ResourcesPath,n=e;return At.isString(t)&&t.length>0?"/"!=t[t.length-1]&&(t+="/"):t="Resources/",n||(n=z.bWin?".msi":z.bMac?".pkg":yt.navInfo.bArm64?"-arm64.deb":yt.navInfo.bMips64?"-mips64el.deb":yt.navInfo.bAndroid?".apk":z.bLinux||z.bChromeOS||z.bHarmonyOS?".deb":".msi"),[t,"dist/DynamsoftServiceSetup",n].join("")},getLinuxHTML5DebPath:function(){return Ft.getDSPath(".deb")},getLinuxHTML5RpmPath:function(){return Ft.getDSPath(".rpm")},getEnumPlatform:function(){return z.bAndroid?Rt.enumAndroid:z.bMac?Rt.enumMac:z.bChromeOS?Rt.enumChromeOS:z.bHarmonyOS?Rt.enumHarmonyOS:yt.navInfo.bEmbed?Rt.enumEmbed:z.bLinux?Rt.enumLinux:z.biPhone||z.biPad?Rt.enumiOS:Rt.enumWindow},getEnumBrowser:function(){return z.bEdge?Nt.enumEdge:z.bChrome?Nt.enumChrome:z.bFirefox?Nt.enumFirefox:z.bIE?Nt.enumIE:z.bSafari?Nt.enumSafari:z.bHuaWeiBrowser?Nt.enumHuaWeiBrowser:z.bOpera?Nt.enumOpera:Nt.enumUnknown}},kt=!0,Mt=!1,Bt=z.bHTML5Edition,Gt=0,Ut=Mt;z.bIE&&(""===(Gt=z.IEVersion)||Gt>=10?yt.DWT.IfUseActiveXForIE10Plus?(Bt=Mt,Ut=kt,z.bHTML5Edition=Bt):Bt=kt:(Bt=Mt,Gt>=9&&(Ut=kt))),Ut||Bt||(Bt=kt);var Ht={name:"Dynamic Web TWAIN",bHTML5Edition:Bt,bActiveXEdition:Ut,_iImageCaptureDriverType:3,_iBrokerProcessType:1,getChromeEditionPath:Ft.getDSPath,getPKGPath:function(){return yt.DWT.ResourcesPath+"/dist/mac/DynamicWebTWAINMacEdition.pkg"},getMSIPath:function(){return yt.DWT.ResourcesPath+"/dist/win/DynamicWebTWAINPlugIn.msi"},getActiveXCABx86Path:function(){return yt.DWT.ResourcesPath+"/dist/win/ActiveX/DynamicWebTWAIN.cab"},getActiveXCABx64Path:function(){return yt.DWT.ResourcesPath+"/dist/win/ActiveX/DynamicWebTWAINx64.cab"},onlineResources:"https://demo.dynamsoft.com/DWT/Resources/",strMIMEType:"Application/DynamicWebTwain-Plugin",strFullClassID:"E7DA7F8D-27AB-4EE9-8FC0-3FEC9ECFE758",scripts:{},dwtConfigLoaded:!1,dwtConfigLoading:!1,getServerVersionInfo:function(e){var t=xt.ServerVersionInfo;return z.bWin||(z.bMac?t=xt.ServerMacVersionInfo:(z.bLinux||z.bAndroid||z.bChromeOS||z.bHarmonyOS)&&(t=xt.ServerLinuxVersionInfo)),e?t:At.replaceAll(t,",","")},getDWTPrefix:function(){return!0===yt.DWT.CustomMode?"dwtc_":"dwt_"},loadResourcePath:!1,loadingResourcePath:!1,handshakeCode:undefined,organizationID:undefined,licenseServer:undefined,sessionPassword:"",bPublicLTS:!0,refProductKey:undefined,ltsDebug:!1,bDWTLoading:!1,bAndroidConnected:!1,unloadQueue:[],appendBrowserLicenseWhenServiceMode:function(){},bChromeEdition:Bt};function jt(e){var t=e.toLowerCase().replace(Ht.name.toLowerCase()+" ","");return(t=At.replaceAll(t,"[.]",",")).split(",")}var Vt,Xt=!1,Kt=!0;!function(e){e.TWAINSCANNER=16,e.WIASCANNER=32,e.TWAINX64SCANNER=64,e.ICASCANNER=128,e.SANESCANNER=256,e.ESCLSCANNER=512,e.WIFIDIRECTSCANNER=1024,e.WIATWAINSCANNER=2048}(Vt||(Vt={}));var zt=Vt.TWAINSCANNER|Vt.WIASCANNER|Vt.TWAINX64SCANNER|Vt.ICASCANNER|Vt.SANESCANNER|Vt.ESCLSCANNER|Vt.WIFIDIRECTSCANNER|Vt.WIATWAINSCANNER;Vt.TWAINSCANNER,Vt.WIASCANNER,Vt.TWAINX64SCANNER,Vt.ICASCANNER,Vt.SANESCANNER,Vt.TWAINSCANNER,Vt.WIATWAINSCANNER,Vt.TWAINX64SCANNER,Vt.ICASCANNER,Vt.SANESCANNER;var Jt=Vt.TWAINSCANNER|Vt.WIASCANNER|Vt.WIATWAINSCANNER;Vt.ESCLSCANNER,Vt.WIFIDIRECTSCANNER,Vt.TWAINSCANNER,Vt.WIATWAINSCANNER;var Yt=g((function ka(){d(this,ka)}));var qt=g((function Ma(){d(this,Ma)}));function Qt(e,t){var n,r=e.name,i="",o=e.deviceType;o==Vt.TWAINSCANNER?n="":o==Vt.TWAINX64SCANNER?n="Twain64-":o==Vt.WIASCANNER?n="WIA-":o==Vt.WIATWAINSCANNER?(r=At.replaceAll(r,"WIA-",""),n="WIATWAIN-"):n=o==Vt.ICASCANNER?"ICA-":o==Vt.SANESCANNER?"Sane-":o==Vt.ESCLSCANNER?"eSCL-":(Vt.WIFIDIRECTSCANNER,""),t&&t.attrs&&t.attrs.ty&&(i=" on ["+t.attrs.ty+"]"),e.displayName=[n,r,i].join("")}function Zt(e){if(e.ProductName){var t=e.ProductName;e.ProductName=At.base64.decode(t)}if(e.ProductFamily){var n=e.ProductFamily;e.ProductFamily=At.base64.decode(n)}if(e.Manufacturer){var r=e.Manufacturer;e.Manufacturer=At.base64.decode(r)}if(e.Version&&e.Version.Info){var i=e.Version.Info;e.Version.Info=At.base64.decode(i)}}function $t(e){var t=new qt;return e.deviceInfo&&(t.deviceInfo=At.clone(e.deviceInfo)),e.deviceType&&(t.deviceType=At.clone(e.deviceType)),e.displayName&&(t.displayName=At.clone(e.displayName)),e.name&&(t.name=At.clone(e.name)),e.serviceInfo&&(t.serviceInfo=function(e){var t=new Yt;return t.server=e.server,t.normal=!0,e.attrs&&(t.attrs=At.clone(e.attrs)),t}(e.serviceInfo)),t}wt.removeNonPrintableChar;var en,tn=function(){function e(t,n,r,i){d(this,e);var o=this;o._md5=r,o._length=n,o._content=i}return g(e,[{key:"getLength",value:function(){return this._length}},{key:"getMD5",value:function(){return this._md5}},{key:"getData",value:function(e,t){var n=this,r=t;return At.isNumber(e)&&At.isNumber(t)?e<0||t<=0?"":0==e&&r==n._length?n._content:(e+r>n._length&&(r=n._length-e),n._content.substr(e,r)):""}}]),e}();function nn(e,t,n){return(t=T(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}wt.html5.Base64Result=tn,function(e){e.SMF_NAME=1,e.SMF_TWAINVERSION=2,e.SMF_TWAINPROTOCOL=4,e.SMF_ICAUUID=8,e.SMF_ICAMODULEVERSION=16,e.SMF_ICALOCATIONTYPE=32}(en||(en={})),String.prototype.startsWith||(String.prototype.startsWith=function(e){return 0==this.indexOf(e)});var rn,on,an=function(e){var t,n=e,r=n._license||"",i=JSON.parse(JSON.stringify(n._licenseServer)),o=n._sessionPassword,a=0;if(r.startsWith("t")||r.startsWith("f"))a=0;else if(0===r.length||r.startsWith("P")||r.startsWith("L")||r.startsWith("Y")||r.startsWith("A"))a=1;else{a=2;var s=r.indexOf(":");if(-1!=s&&(r=r.substring(s+1)),r.startsWith("DLS2")){var u;try{var c=r.substring(4);c=Dynamsoft.Lib.atob(c),u=JSON.parse(c)}catch(f){throw new Error("Format Error: The license string you specified is invalid, please check to make sure it is correct.")}if("number"==typeof(r=u.handshakeCode?u.handshakeCode:u.organizationID?u.organizationID:"")&&(r=JSON.stringify(r)),0===i.length){var l=[];u.mainServerURL&&(l[0]=u.mainServerURL),u.standbyServerURL&&(l[1]=u.standbyServerURL),i=function(e){if(null==e)e=[];else{e instanceof Array||(e=[e]);for(var t=0;t<e.length;++t){if(document&&document.createElement){var n=document.createElement("a");n.href=e[t],e[t]=n.href}e[t].lastIndexOf("/")!=e[t].length-1&&(e[t]+="/")}}return e}(l)}!o&&u.sessionPassword&&(o=u.sessionPassword),t=u.remark}("200001"===r||r.startsWith("200001-"))&&(i&&i.length||(r="")),r||(a=1)}return 1===a&&(r=""),{lt:a,l:r,ls:i,sp:o,rmk:t}};function sn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function un(e,t){return un=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},un(e,t)}function cn(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&un(e,t)}function ln(e,t){if(t&&("object"===f(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return sn(e)}function fn(e){return fn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},fn(e)}!function(e){e.OK=0,e.Custom=-1,e.NWB=-4200,e.WS_DISCONN=-4201,e.CB=-5e3,e.JSON_REQUIRED=-5001,e.OBJECT_DISPOSED=-5002,e.INVALID_TASK=-5003,e.OBJECT_DISPOSING=-5004}(rn||(rn={})),function(e){e.WS_DISCONN="The Web Socket connection failed.",e.JSON_REQUIRED="The input is not a JSON object or JSON styled string.",e.OBJECT_DISPOSED="The object has been disposed.",e.INVALID_TASK="The task is invalid.",e.OBJECT_DISPOSING="The object need to be disposed."}(on||(on={}));var dn=function(){function e(){d(this,e)}return g(e,null,[{key:"message",value:function(e){return this._errorMessage[e]}},{key:"init",value:function(){this._errorMessage[rn.OK]="Successful.",this._errorMessage[rn.WS_DISCONN]=on.WS_DISCONN,this._errorMessage[rn.JSON_REQUIRED]=on.JSON_REQUIRED,this._errorMessage[rn.OBJECT_DISPOSED]=on.OBJECT_DISPOSED,this._errorMessage[rn.INVALID_TASK]=on.INVALID_TASK,this._errorMessage[rn.OBJECT_DISPOSING]=on.OBJECT_DISPOSING}}]),e}();nn(dn,"_errorMessage",Object.create(null)),dn.init();var Tn,hn=function(){function e(t,n){d(this,e),nn(this,"_code",rn.OK),this.name="DSError",this.message=null!=n?n:"string"==typeof t?t:dn.message(t),this._code="string"==typeof t?rn.Custom:t}return g(e,[{key:"code",get:function(){return this._code}}]),e}();!function(e){e.NONE=0,e.TRACE=1,e.DEBUG=2,e.INFO=4,e.WARN=8,e.ERROR=16}(Tn||(Tn={}));var gn,pn=At.getLogger(),mn=function(){function e(){d(this,e)}return g(e,null,[{key:"LogLevel",get:function(){return this._logLevel},set:function(e){this._logLevel=e}},{key:"LogFunc",set:function(e){this._logFunc=e}},{key:"all",value:function(e,t){if((this._logLevel&e)==e)if(this._logFunc)this._logFunc(t,e);else switch(e){case Tn.DEBUG:pn.debug(t);break;case Tn.ERROR:pn.error(t);break;case Tn.INFO:pn.info(t);break;case Tn.WARN:pn.warn(t);break;case Tn.TRACE:pn.trace(t)}}},{key:"trace",value:function(e){this.all(Tn.TRACE,e)}},{key:"debug",value:function(e){this.all(Tn.DEBUG,e)}},{key:"info",value:function(e){this.all(Tn.INFO,e)}},{key:"warn",value:function(e){this.all(Tn.WARN,e)}},{key:"error",value:function(e){this.all(Tn.ERROR,e)}}]),e}();nn(mn,"_logLevel",Tn.ERROR),nn(mn,"_logFunc",undefined),function(e){e.GET_TASKID=0,e.GET_EVENT_TASKID=1,e.ONMESSAGE_PROCESS_DATA=2,e.ONMESSAGE_GET_TASKID=3,e.ONMESSAGE_GET_EVENT_TASKID=4,e.HANDLE_RAW_MESSAGE=5,e.HANDLE_PROCESSED_MESSAGE=6}(gn||(gn={}));var _n,Sn,In=function(){function e(t){d(this,e),nn(this,"_serverInfo",undefined),nn(this,"_disposed",!1),this._serverInfo=t,this._ref=1}var n,r;return g(e,[{key:"serverInfo",get:function(){return this._serverInfo}},{key:"requestSync",value:function(e,t){return mn.error("requestSync should be implemented in child class"),undefined}},{key:"request",value:function(){var e=t(l.mark((function n(e,t,r,i){return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return mn.error("request should be implemented in child class"),e.abrupt("return",null);case 2:case"end":return e.stop()}}),n)})));return function(t,n,r,i){return e.apply(this,arguments)}}()},{key:"send",value:(r=t(l.mark((function i(e,t,n){return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:mn.error("reqsenduestSync should be implemented in child class");case 1:case"end":return e.stop()}}),i)}))),function(e,t,n){return r.apply(this,arguments)})},{key:"testConnection",value:(n=t(l.mark((function o(e,t,n,r){return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return mn.error("testConnection should be implemented in child class"),e.abrupt("return");case 2:case"end":return e.stop()}}),o)}))),function(e,t,r,i){return n.apply(this,arguments)})},{key:"disposed",get:function(){return this._disposed}},{key:"dispose",value:function(){if(this._ref--,this._ref>0)return!1;this._disposed=!0,this._terminate()}},{key:"_terminate",value:function(){}},{key:"addRef",value:function(){this._ref++}}]),e}();function En(){return At.isString(Ht.handshakeCode)||At.isString(Ht.organizationID)||Ht.bPublicLTS||At.isString(yt.DWT.ProductKey)&&At.startsWith(yt.DWT.ProductKey,"DLS2")}function vn(e,t,n){e._errorCode=t,e._errorString=n}function bn(e){var t=yt.DWT.licenseException;t.code=e._errorCode,t.message=e._errorString,t.fromLTS=!1}function wn(e){vn(e,-1033,"Invalid index.")}function Cn(e){vn(e,-1034,"Invalid value.")}function An(e){vn(e,_n.LicenseInvalid,En()?"The license is invalid.":"The current product key is empty or invalid."),bn(e)}function Wn(e,t){e._errorCode=_n.LicenseExpired;var n="";if(t&&""!=t&&(-1==t.indexOf("on")&&(n=" on "+t),e.__licenseInfo&&(e.__licenseInfo.ExpireDate=t)),En()){var r,i,o,a,s;if(r=yt.DWT.EnumInstance.dwt_desktop,e._bRemoteMode)i=null!==(o=null===(a=e._dmService)||void 0===a||null===(s=a.attrs)||void 0===s?void 0:s.UUID)&&void 0!==o?o:"";else i="";e._errorString="The license has expired"+n+".",yt.DWT.lcexp(r,i).then((function(){e._errorString=yt.DWT.licenseException.message}))}else e._errorString="The current product key has expired"+n+". Please contact the site administrator.",bn(e)}function yn(e,t,n){En()?t?111==n?(e._errorCode=_n.LicenseExpiredForDLS,e._errorString="The license for v"+Pt+" WebAssembly Core Module has expired."):(e._errorCode=_n.LicenseNoCoreForDLS,e._errorString="The license for v"+Pt+" WebAssembly Core Module is not found."):111==n?(e._errorCode=_n.LicenseExpiredForDLS,e._errorString="The license for v"+Pt+" Service Core Module has expired."):(e._errorCode=_n.LicenseNoCoreForDLS,e._errorString="The license for v"+Pt+" Service Core Module is not found."):(e._errorCode=_n.LicenseNoCore,e._errorString=t?"The current product key is missing the WebAssembly Core license. Please contact the site administrator.":"The current product key is missing the Service Core license. Please contact the site administrator."),bn(e)}function Pn(e){e._errorCode=-2339,En()?e._errorString="The license for the module pdf rasterizer is not found or has expired.":e._errorString="The current product key does not support pdf rasterizer. Please contact the site administrator.",bn(e)}function Dn(e){vn(e,-2352,"The indices are out of range.")}function On(e){vn(e,-2359,"The index is out of range.")}function Ln(e){vn(e,-2360,"The index is null or undefined.")}function Nn(e){vn(e,-2391,"Invalid event name.")}function Rn(e){vn(e,-2416,"Invalid parameter.")}function xn(e){vn(e,-2426,"You have used a full license with a trial license which is not permitted. Please check and update Dynamsoft.DWT.ProductKey.")}function Fn(e){vn(e,-2433,"The ActiveX edition does not support this method or property.")}function kn(e){vn(e,-2506,"The ThumbnailViewer object has been disposed.")}function Mn(e,t,n){vn(e,-2816,["HTTP process error: ",n," (",t,")."].join(""))}z.bSSL,function(e){e.LicenseInvalid=-2325,e.LicenseExpired=-2326,e.LicenseParseFailed=-2546,e.LicenseExpiredForDLS=-2808,e.LicenseNoCoreForDLS=-2809,e.LicenseNoCore=-2810,e.LicenseIsFuture=-2396,e.LicenseVersionNotCurrent=-2539}(_n||(_n={})),yt.DWT.EnumDWT_LicenseErrorCode=_n,function(e){e.UserCancelled=-1032,e.CommonError=-2201,e.ModuleNotExists=-2371,e.MustUpgrade=-2207,e.RemoteDynamsoftServiceStopped=-2613,e.ResponseDataTypeError=-2801,e.HTSTError=-2817,e.CORSError=-2820,e.EnhancedPortNotReady=-2821,e.HTTPRedirected=-2823,e.BboError=-2827}(Sn||(Sn={}));var Bn=/[#\/\?@]/g,Gn=/[#\?]/g,Un={scheme:1,userInfo:2,hostname:3,port:4,path:5},Hn=new RegExp("^(?:([\\w\\d+.-]+):)?(?://(?:([^/?#@]*)@)?([\\w\\d\\-\\u0100-\\uffff.+%]*|\\[[^\\]]+\\])(?::([0-9]+))?)?(.+)?$");function jn(e,t){return At.isString(e)&&At.isString(t)?e.toLowerCase()===t.toLowerCase():e===t}function Vn(e,t){return encodeURI(e).replace(t,(function(e){return"%"+function(e){return 1===e.length?"0"+e:e}(e.charCodeAt(0).toString(16))}))}var Xn,Kn=function(){function e(t){if(d(this,e),nn(this,"scheme",""),nn(this,"userInfo",""),nn(this,"hostname",""),nn(this,"port",""),nn(this,"path",""),t instanceof e)return At.clone(t);e.getComponents(t,this)}return g(e,[{key:"clone",value:function(){var t=new e,n=this;return At.each(Un,(function(e,r){t[r]=n[r]})),t}},{key:"getScheme",value:function(){return this.scheme}},{key:"setScheme",value:function(e){return this.scheme=e,this}},{key:"getHostname",value:function(){return this.hostname}},{key:"setHostname",value:function(e){return this.hostname=e,this}},{key:"setUserInfo",value:function(e){return this.userInfo=e,this}},{key:"getUserInfo",value:function(){return this.userInfo}},{key:"setPort",value:function(e){return this.port=e,this}},{key:"getPort",value:function(){return this.port}},{key:"setPath",value:function(e){return this.path=e,this}},{key:"getPath",value:function(){return this.path}},{key:"isSameOriginAs",value:function(e){var t=this;return jn(t.hostname,e.hostname)&&jn(t.scheme,e.scheme)&&jn(t.port,e.port)}},{key:"toString",value:function(e){var t,n,r,i,o,a=[],s=this;return(t=s.scheme)&&(a.push(Vn(t,Bn)),a.push(":")),(n=s.hostname)&&(a.push("//"),(o=s.userInfo)&&(a.push(Vn(o,Bn)),a.push("@")),a.push(encodeURIComponent(n)),(i=s.port)&&(a.push(":"),a.push(i))),(r=s.path)&&(n&&!At.startsWith(r,"/")&&(r="/"+r),a.push(Vn(r,Gn))),a.join("")}}],[{key:"getComponents",value:function(e,t){var n=(e=e||K).match(Hn)||[],r=t||{};return At.each(Un,(function(e,t){r[t]=n[e]})),r}}]),e}(),zn=At.each,Jn=At.error,Yn=At.isFunction,qn=At.isString,Qn=z.bIE&&z.IEVersion<=9,Zn=z.bIE&&z.IEVersion<=10,$n=window,er=new Kn(location.href),tr=er&&/^(?:about|app|app\-storage|.+\-extension|file|widget)$/.test(er.getScheme()),nr=!1,rr=function(){try{return new $n.XMLHttpRequest}catch(e){}},ir=function(){try{var e=Xt;return zn(["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.3.0","Msxml3.XMLHTTP"],(function(t){try{if(!e)return e=new $n.ActiveXObject(t),Xt}catch(n){Jn("new xhr error: "+n.message)}})),e}catch(t){}},or=!(tr||!$n.XMLHttpRequest)&&"withCredentials"in(rr()||[]),ar=$n.ActiveXObject?function(e){return Qn?ir():!tr&&rr()||ir()}:rr,sr=function(e){return nr},ur=/^(?:GET|HEAD)$/,cr=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,lr={xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":"*/*"},fr=Xn;Zn&&(fr=At.noop);var dr,Tr,hr=function(){function e(){d(this,e),nn(this,"url",!1),nn(this,"onSuccess",!1),nn(this,"onError",!1),nn(this,"onComplete",!1),nn(this,"method","GET"),nn(this,"async",!0),nn(this,"xhrFields",!1),nn(this,"mimeType",!1),nn(this,"username",!1),nn(this,"password",!1),nn(this,"data",!1),nn(this,"dataType","text"),nn(this,"headers",!1),nn(this,"contentType","application/x-www-form-urlencoded; charset=UTF-8"),nn(this,"beforeSend",!1),nn(this,"afterSend",!1),nn(this,"timeout",0),nn(this,"cache",!0),nn(this,"crossDomain",!1),nn(this,"retry",0)}return g(e,[{key:"setRequestHeader",value:function(e,t){this.headers[e]=t}},{key:"getAllResponseHeaders",value:function(){return 2===this.state?this.responseHeadersString:null}},{key:"getNativeXhr",value:function(){return this.nativeXhr}},{key:"getResponseHeader",value:function(e){var t,n;if(e=e.toLowerCase(),2===this.state){if(!(n=this.responseHeaders))for(n=this.responseHeaders={};t=cr.exec(this.responseHeadersString);)n[t[1].toLowerCase()]=t[2];t=n[e]}return t===undefined?null:t}},{key:"overrideMimeType",value:function(e){return this.state||(this.mimeType=e),this}},{key:"abort",value:function(e){return this.state=3,this.status=0,this.statusText=null!=e?e:"abort",this.nativeXhr&&this.nativeXhr.abort(),this._callback(),this}},{key:"_ioReady",value:function(e,t){var n=!1,r=this;if(2!==this.state&&3!==this.state){1===this.state&&(this.state=2),this.readyState=4,e>=200&&e<300||304===e?304===e?(t="not modified",n=!0):(t="success",n=!0):e<0&&(e=0);try{e>=200&&this.handleResponseData()}catch(i){Jn(i,"error"),t=i.message||"parser error"}if((e<200||!n)&&this.retry>0)return this.retry=this.retry-1,void setTimeout((function(){r.sendInternal()}),200);this.status=e,this.statusText=t,this._callback(n)}}},{key:"_callback",value:function(e){var t=this,n=this.timeoutTimer;n&&(clearTimeout(n),this.timeoutTimer=0),zn([e?this.onSuccess:this.onError,this.onComplete],(function(e){Yn(e)&&e.apply(t.context,[t.responseData,t.statusText,t])})),this.responseData=null}},{key:"handleResponseData",value:function(){var e,t=this.dataType,n=this.nativeXhr;if("blob"===t||"arraybuffer"===t)if(Qn){var r,i,o;if("responseBody"in n)r=n.responseBody,i=$n.dsVbsBinGetLength(r),e=new $n.VBArray($n.dsVbsBinGetBytes(r,0,i)).toArray();else for(e=[],i=(r=n.responseText).length,o=0;o<i;++o)e.push(255&r.charCodeAt(o));r=null}else e=$n.Blob?n.response:"responseBody"in n?n.responseBody:n.responseText;else if("json"==t)e=n.responseType&&"json"==n.responseType.toLowerCase()?n.response:n.responseText?At.parse(n.responseText):At.parse(n.response);else if("user-defined"===t)e=n.response!==undefined?n.response:n.responseText;else{this.responseText=e=n.responseText||"";try{var a=n.responseXML;a&&a.documentElement&&(this.responseXML=a)}catch(s){}}this.responseData=e}},{key:"sendInternal",value:function(e){var t,n,r,i,o,a,s,u,c,l,f,d=this;if(n=(t=this._setup(e)).method,qn(n)&&(n=n.toUpperCase()),o=t.contentType,r=t.url,i=t.dataType,u=t.mimeType,qn(r)&&(this.nativeXhr=a=ar(t.crossDomain),a)){try{if(this.state=1,t.username?a.open(n,r,t.async,t.username,t.password):a.open(n,r,t.async),(t.async||z.bIE)&&i&&"user-defined"!=i&&"responseType"in a)try{a.responseType=i}catch(T){}}catch(h){return void(this.state<2?(Jn(h,"error"),this._ioReady(-1,"open error: "+(At.isNumber(h.number)?"("+h.number+")":"")+(h.message||""))):Jn(h))}"withCredentials"in(s=t.xhrFields||{})&&(or||delete s.withCredentials),zn(s,(function(e,t){try{a[t]=e}catch(T){Jn(T)}})),u&&a.overrideMimeType&&a.overrideMimeType(u),!1===(c=t.headers||{})["X-Requested-With"]&&delete c["X-Requested-With"],"setRequestHeader"in a&&(o&&a.setRequestHeader("Content-Type",t.contentType),a.setRequestHeader("Accept",i&&lr[i]?lr[i]+("*"===i?"":", */*; q=0.01"):lr["*"]),zn(c,(function(e,t){a.setRequestHeader(t,e)}))),t.cache||(a.setRequestHeader("If-Modified-Since","0"),a.setRequestHeader("Cache-Control","no-cache")),f=(l=!ur.test(t.method))&&t.data||null,l&&Qn&&(f=t.data),t.async&&t.timeout>0&&(t.timeout<300&&(t.timeout=300),this.timeoutTimer=setTimeout((function(){d.abort("timeout")}),t.timeout));try{if(this.state=1,Yn(this.beforeSend))if(!1===this.beforeSend(a,d))return void this.abort("cancel");a.send(f),f=null,t.data=null,Yn(this.afterSend)&&this.afterSend(d)}catch(T){this.state<2?(Jn(T,"error"),this._ioReady(-1,"send error: "+(T.message||""))):Jn(T)}t.async&&4!==a.readyState?a.onreadystatechange=function(){d._xhrCallback()}:d._xhrCallback()}}},{key:"_xhrCallback",value:function(e,t){var n=this.nativeXhr;try{if(4===n.readyState||t)if(sr()||(n.onreadystatechange=fr),t)4!==n.readyState&&n.abort();else{sr()||(this.responseHeadersString=n.getAllResponseHeaders());var r,i=n.status;try{r=n.statusText}catch(o){Jn("xhr statusText error: "),Jn(o),r=""}this._ioReady(i,r)}}catch(o){Jn(o,"error"),n.onreadystatechange=fr,t||this._ioReady(-1,o.message||"process error")}}},{key:"_setup",value:function(t){var n,r,i,o,a;if(t){for(r in this.context=t.context,delete t.context,t instanceof e&&(t=t.config),this.config=t,o=t.url,At.startsWith(o,"//")&&(t.url=o="http:"+o),(At.startsWith(o,"http://")||At.startsWith(o,"https://"))&&(a=new Kn(o)),n=t.dataType?t.dataType.toLowerCase():"text",t.dataType=n,t.method?t.method=t.method.toUpperCase():t.method="GET",a&&!("crossDomain"in t)&&(t.crossDomain=!a.isSameOriginAs(er)),i=t.headers)i[r]===Xn&&delete i[r];At.mix(this,t)}return this.state=1,this}},{key:"dispose",value:function(){this.responseHeaders=null,this.responseHeadersString=null,this.responseData=null,this.responseText=null,this.responseXML=null,this.context=null,this.config=null,this.onSuccess=null,this.onError=null,this.onComplete=null,this.xhrFields=null,this.data=null,this.headers=null,this.beforeSend=null,this.afterSend=null}}]),e}();var gr=z.bIE&&z.IEVersion<=9;dr=self&&self.fetch?self.fetch:window.fetch;var pr=0;var mr,_r,Sr,Ir,Er=(mr=null,Ir=!1,pr=_r=0,dr?Sr=function(e,t){var n=!1,r="text",i=!1;if(t&&(t.dataType&&(r=t.dataType),t.fetchRaw&&(i=!0),t.timeout)){var o=t.timeout;o<300&&(o=300);var a=new AbortController;t.signal=a.signal,setTimeout((function(){n||a.abort()}),o)}Ir=!1;var s=dr(e,t).then((function(e){if(e.ok){var t,r;if(n=!0,!mr)return e;mr.IfShowCancelDialogWhenImageTransfer?(vr(!0),r=mr.on("cancel",(function(){Ir=!0}))):vr(!1);var i=e.headers.get("Content-Length"),o=0;mr._onPercent&&pr==_r&&mr._onPercent({loaded:o,total:i});var a=null==e||null===(t=e.body)||void 0===t?void 0:t.getReader(),s=new ReadableStream({start:function(e){a?setTimeout((function t(){return a.read().then((function(n){if(n.done||Ir)return Ir?a.cancel():r&&mr.off("cancel",r),e.close(),void(r=null);var s=n.value;o+=s.length,mr._onPercent&&pr==_r&&mr._onPercent({loaded:o,total:i});try{return e.enqueue(s),t()}catch(u){At.error(u)}}))}),0):e.close()}}),u=e.headers.get("Content-Type");return u&&""!=u||(u="application/octet-stream"),new Response(s,{headers:{"Content-Type":u}})}if("opaqueredirect"==e.type)throw{code:Sn.HTTPRedirected,message:"The http url redirected."};var c;throw Mn(c={},e.status,e.statusText),{code:c._errorCode,message:c._errorString,httpCode:e.status}}));return i?s:(s="blob"==r?s.then((function(e){var t=e.headers.get("content-type");return"text/json"==t?e.json():z.bLinux?e.arrayBuffer().then((function(e){return new Blob([e],{type:t})})):e.blob()})):"json"==r?s.then((function(e){return e.json()})):"arraybuffer"==r?s.then((function(e){return"text/json"==e.headers.get("content-type")?e.json():e.arrayBuffer()})):s.then((function(e){return e.text()}))).then((function(e){var t;if(Ir)throw vn(t={},-2615,"User cancelled the operation."),{code:t._errorCode,message:t._errorString};return e}))}:(gr&&At.addVBS(["Function dsVbsBinGetAt(strBinary,iOffset)\r\n"," dsVbsBinGetAt=AscB(MidB(strBinary,iOffset+1,1))\r\n","End Function\r\n","Function dsVbsBinGetBytes(strBinary,iOffset,iLength)\r\n"," Dim aBytes()\r\n"," ReDim aBytes(iLength-1)\r\n"," For i=0 To iLength-1\r\n","  aBytes(i)=dsVbsBinGetAt(strBinary,iOffset+i)\r\n"," Next\r\n"," dsVbsBinGetBytes=aBytes\r\n","End Function\r\n","Function dsVbsBinGetLength(strBinary)\r\n"," dsVbsBinGetLength=LenB(strBinary)\r\n","End Function"].join("")),Sr=function(e,t){return new(wt.nativePromise||window.Promise)((function(n,r){var i,o=!1;i={url:e,async:!0,onSuccess:function(e,t,r){n(e)},onError:function(e,t,n){var i;Mn(i={},n.status,t),r({code:i._errorCode,message:i._errorString,httpCode:n.status})},dataType:"text",method:Tr,data:Tr,headers:Tr,contentType:Tr,mimeType:Tr},t&&(t.method&&(i.method=t.method),t.body&&(i.data=t.body),t.headers&&(i.headers||(i.headers={}),At.each(t.headers,(function(e,t){"content-type"==t.toLowerCase()&&(o=!0),i.headers[t]=e}))),t.dataType&&(i.dataType=t.dataType),t.contentType&&(i.contentType=t.contentType)),o&&(i.contentType=!1),"blob"==i.dataType&&gr&&(i.mimeType="text/plain; charset=x-user-defined"),mr&&(mr._onPercent&&(i.beforeSend=function(e,t,n){e.upload.addEventListener("progress",(function(e){mr._onPercent&&pr==_r&&mr._onPercent(e)}),!1)}),mr.IfShowCancelDialogWhenImageTransfer?vr(!0):vr(!1));var a=function(e){if(e&&qn(e.url)){var t=new hr;return t.sendInternal(e),t}At.log("the url is error.")}(i);mr&&mr.IfShowCancelDialogWhenImageTransfer&&mr.on("cancel",(function(){a.abort()}))}))}),Sr);function vr(e){var t=At.sizzle(".dynamsoft-btnCancel");if(t.length>0){var n=t[0];n.style.display=e?"":"none"}}function br(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=fn(e);if(t){var i=fn(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ln(this,n)}}function wr(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function Cr(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}var Ar=At.getLogger(),Wr=new WeakSet,yr=new WeakSet,Pr=function(e){cn(a,e);var n,r,i,o=br(a);function a(){var e;d(this,a);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return wr(sn(e=o.call.apply(o,[this].concat(n))),yr),wr(sn(e),Wr),e}return g(a,[{key:"send",value:(i=t(l.mark((function s(e,t,n){return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Ar.error("HTTP Client send not supported");case 1:case"end":return e.stop()}}),s)}))),function(e,t,n){return i.apply(this,arguments)})},{key:"requestSync",value:function(e,t,n){return undefined}},{key:"request",value:(r=t(l.mark((function u(e,t,n,r){return l.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",Cr(this,yr,Or).call(this,e,t,n,undefined,undefined,r));case 1:case"end":return i.stop()}}),u,this)}))),function(e,t,n,i){return r.apply(this,arguments)})},{key:"testConnection",value:(n=t(l.mark((function c(e,t,n,r){return l.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",Cr(this,yr,Or).call(this,undefined,undefined,e,t,n,r));case 1:case"end":return i.stop()}}),c,this)}))),function(e,t,r,i){return n.apply(this,arguments)})}]),a}(In);function Dr(e){var t=this.serverInfo,n="";return n=t.ssl?"https://":"http://",n+=t.server,t.port&&(n+=":",n+=t.port),e&&(At.startsWith(e,"/")||At.endsWith(n,"/")||(n+="/"),At.endsWith(e,"/")?n+=e.slice(0,-1):n+=e),n}function Or(e,t,n,r,i,o){return Lr.apply(this,arguments)}function Lr(){return(Lr=t(l.mark((function e(t,n,r,i,o,a){var s,u;return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s=null!=r?r:{},t&&(s.body=t),s.method||(s.method="POST"),a&&(s.timeout=a),u=Cr(this,Wr,Dr).call(this,n),Ar.debug("HTTP URL: "+u),e.next=9,Er(u,s);case 9:return e.abrupt("return",e.sent);case 12:if(e.prev=12,e.t0=e["catch"](0),!(e.t0 instanceof hn||e.t0&&e.t0.code&&e.t0.message)){e.next=18;break}throw e.t0;case 18:if(!e.t0.message){e.next=20;break}throw new hn(e.t0.message);case 20:case"end":return e.stop()}}),e,this,[[0,12]])})))).apply(this,arguments)}function Nr(e){try{return"object"===f(e)?e:(e="string"!=typeof e?At.stringify(e):e,At.parse(e))}catch(t){throw t instanceof hn?t:new hn(rn.JSON_REQUIRED)}}function Rr(e){return Math.random().toString(16).substring(2,2+e)}function xr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=fn(e);if(t){var i=fn(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ln(this,n)}}function Fr(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function kr(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}var Mr,Br=At.getLogger(),Gr=new WeakSet,Ur=new WeakSet,Hr=new WeakSet,jr=new WeakSet,Vr=new WeakSet,Xr=new WeakSet,Kr=new WeakSet,zr=function(e){cn(s,e);var n,r,i,o,a=xr(s);function s(e){var t;return d(this,s),Fr(sn(t=a.call(this,e)),Kr),Fr(sn(t),Xr),Fr(sn(t),Vr),Fr(sn(t),jr),Fr(sn(t),Hr),Fr(sn(t),Ur),Fr(sn(t),Gr),nn(sn(t),"_defaultRetries",1),nn(sn(t),"_ws",Mr),nn(sn(t),"_events",{}),nn(sn(t),"_bHeartBeatStarted",!1),nn(sn(t),"_heartBeatTicks",6e4),t._ws=Mr,t.bUseParentWS=!1,t._tasks=Object.create(null),t.bReady=!1,t._blob_callbacks=[],t._processing_blob=!1,t}return g(s,[{key:"ws",get:function(){return this._ws}},{key:"requestSync",value:function(e,t,n){return Br.error("WebSocket Client requestSync not supported"),undefined}},{key:"send",value:(o=t(l.mark((function u(e,t,n){var r,i,o,a,s;return l.wrap((function(u){for(;;)switch(u.prev=u.next){case 0:if(r=n.client,u.prev=1,(i=n.taskId)!==undefined){u.next=7;break}return u.next=6,t(e,gn.GET_TASKID,r._requestTaskId,n);case 6:i=u.sent;case 7:if(o=r._tasks[i]){u.next=11;break}throw Br.error("invalid task id: "+i),new hn(rn.INVALID_TASK);case 11:return u.next=13,kr(r,Vr,ei).call(r,!1);case 13:return u.next=15,kr(r,Xr,ni).call(r,e,t,n,o);case 15:Br.debug("begin to send data "+i),r.disposed||r._ws.send(e),e=null,Br.debug("end to send data "+i),u.next=27;break;case 21:u.prev=21,u.t0=u["catch"](1),Br.debug("failed to send data."),Br.error(u.t0),delete r._tasks[i],null===(a=o)||void 0===a||null===(s=a.resolver)||void 0===s||s.reject(u.t0.message);case 27:case"end":return u.stop()}}),u,null,[[1,21]])}))),function(e,t,n){return o.apply(this,arguments)})},{key:"request",value:(i=t(l.mark((function c(e,t,n,r){var i,o,a;return l.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return i=this._defaultRetries,o=null!=t?t:kr(this,jr,Zr),a=null!=n?n:{client:this,userData:this},s.abrupt("return",kr(this,Kr,ii).call(this,e,o,a,i,!1,undefined,r));case 2:case"end":return s.stop()}}),c,this)}))),function(e,t,n,r){return i.apply(this,arguments)})},{key:"connected",get:function(){var e;return(null===(e=this._ws)||void 0===e?void 0:e.readyState)==WebSocket.OPEN}},{key:"testConnection",value:function(e,t,n,r){return kr(this,Vr,ei).call(this,!0,null!=t?t:0,n,r)}},{key:"_terminate",value:(r=t(l.mark((function f(){var e;return l.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(e in Br.debug("terminate WSClient"),this.fireEvent("disposed"),this._tasks)this._tasks[e]!==undefined&&this._tasks[e].resolver&&this._tasks[e].resolver.reject(new hn(rn.OBJECT_DISPOSING));this._lic_callback=Mr,this._blob_callbacks=[],this._processing_blob=!1,this._ws&&(this._ws.onopen=null,this._ws.onerror=null,this._ws.onmessage=null,this._ws.onclose=null,this._ws.close()),this._ws=Mr,this._tasks=Object.create(null);case 9:case"end":return t.stop()}}),f,this)}))),function(){return r.apply(this,arguments)})},{key:"setRetry",value:function(e){this._defaultRetries=null!=e?e:1}},{key:"addEvent",value:function(e,t,n){var r=this._events[e];r||(this._events[e]={},r=this._events[e]),At.isString(t)&&At.isFunction(n)&&(r[t]=n)}},{key:"removeEvent",value:function(e,t){var n=this._events[e];n&&At.isString(t)&&delete n[t]}},{key:"clearEvent",value:function(e){this._events[e]&&(this._events[e]={})}},{key:"fireEvent",value:function(e){var t,n=this._events[e];if(n){var r=Object.keys(n);for(t=0;t<r.length;t++)At.isFunction(n[r[t]])&&n[r[t]]()}}},{key:"getRequestTaskId",value:function(){return this._requestTaskId?this._requestTaskId:0}}],[{key:"_waitForPreBlob",value:(n=t(l.mark((function T(e){return l.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e._processing_blob){t.next=3;break}return setTimeout((function(){s._waitForPreBlob(e)}),500),t.abrupt("return");case 3:s._preBlobResolv&&s._preBlobResolv();case 4:case"end":return t.stop()}}),T)}))),function(e){return n.apply(this,arguments)})}]),s}(In);function Jr(e){var t="";return t=e.ssl?"wss://":"ws://",t+=e.server,e.port&&(t+=":",t+=e.port),t}function Yr(e,t,n,r){var i=this;return new wt.Promise((function(o,a){try{var s,u,c=a,l=o;if(r&&(u=setTimeout((function(){var e=new hn("createWebSocket timed out.");Br.debug(e.message),c&&(c(e),c=null,l=null),u&&clearTimeout(u),s&&s.close()}),r)),e.bUseParentWS){var f=window,d=parent,T=f.WebSocket;try{for(;f!=d&&d&&d.WebSocket;)T=d.WebSocket,f=d.window,d=d.parent}catch(h){T=window.WebSocket}s=n?new T(t,n):new T(t)}else s=n?new WebSocket(t,n):new WebSocket(t);s.onopen=function(){u&&clearTimeout(u),e._ws=s,l&&(l(s),c=null,l=null)},s.onerror=function(t){s.close(),e.bReady=!1,u&&clearTimeout(u),i.fireEvent("error"),c&&(c(new hn("websocket error")),c=null,l=null)},s.onmessage=function(t){kr(e,Hr,qr).call(e,e,t.data)},s.onclose=function(t){e.bReady=!1,u&&clearTimeout(u),i.fireEvent("close"),c&&(c(t),c=null,l=null)}}catch(g){if(g instanceof hn||g&&g.code&&g.message)throw g;if(g.message)throw new hn(g.message)}}))}function qr(e,t){return Qr.apply(this,arguments)}function Qr(){return(Qr=t(l.mark((function e(t,n){var r,i,o,a,s,u,c,d,T,h;return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t,e.prev=1,a={client:r,userData:undefined},"object"!==f(n)){e.next=17;break}if(!(r._blob_callbacks.length>0)){e.next=17;break}if(!r._processing_blob){e.next=9;break}return e.next=8,new wt.Promise((function(e){zr._preBlobResolv=e,zr._waitForPreBlob(r)}));case 8:zr._preBlobResolv=null;case 9:return r._processing_blob=!0,s=r._blob_callbacks.shift(),e.next=13,s(n);case 13:return e.sent,r._processing_blob=!1,e.abrupt("return");case 17:if(!(r.bReady&&At.isString(n)&&(n.indexOf("Function not found")>0||n.indexOf("Version not found")>0))){e.next=19;break}return e.abrupt("return");case 19:if(r._cbToGetTaskId){e.next=21;break}return e.abrupt("return");case 21:return e.next=23,r._cbToGetTaskId(n,gn.ONMESSAGE_PROCESS_DATA,r._requestTaskId,a);case 23:return u=e.sent,c=!1,e.next=27,r._cbToGetTaskId(u,gn.ONMESSAGE_GET_TASKID,r._requestTaskId,a);case 27:if(o=e.sent){e.next=36;break}if(!u.Detail||!u.Domain){e.next=32;break}return r._lic_callback&&r._lic_callback(u),e.abrupt("return");case 32:return e.next=34,r._cbToGetTaskId(u,gn.ONMESSAGE_GET_EVENT_TASKID,r._requestTaskId,a);case 34:(o=e.sent)&&(c=!0);case 36:if(i=r._tasks[o]){e.next=46;break}if(!c){e.next=42;break}i={},e.next=44;break;case 42:return""!=o&&Br.log("invalid task id: "+o),e.abrupt("return");case 44:e.next=48;break;case 46:if(!i.timedout){e.next=48;break}return e.abrupt("return");case 48:return e.next=50,r._cbToGetTaskId(n,gn.HANDLE_RAW_MESSAGE,r._requestTaskId,i.ctx);case 50:if((d=e.sent)!==undefined){e.next=55;break}return e.next=54,r._cbToGetTaskId(u,gn.HANDLE_PROCESSED_MESSAGE,r._requestTaskId,i.ctx);case 54:d=e.sent;case 55:d&&!c&&(i.tmid&&clearTimeout(i.tmid),delete r._tasks[o],i.resolver&&i.resolver.resolve(d)),e.next=64;break;case 58:e.prev=58,e.t0=e["catch"](1),Br.debug("failed to handle message."),e.t0 instanceof Error?Br.error(e.t0):Br.error(At.stringify(e.t0)),delete r._tasks[o],null===(T=i)||void 0===T||null===(h=T.resolver)||void 0===h||h.reject(e.t0.message);case 64:case"end":return e.stop()}}),e,null,[[1,58]])})))).apply(this,arguments)}function Zr(e,t,n){return $r.apply(this,arguments)}function $r(){return($r=t(l.mark((function e(t,n,r){var i,o;return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=n,e.next=e.t0===gn.GET_TASKID?3:e.t0===gn.HANDLE_RAW_MESSAGE?7:9;break;case 3:return(o=Nr(t)).cmdId=null!==(i=o.cmdId)&&void 0!==i?i:(r=void 0,a=void 0,a=[Rr(8),"-",Rr(4),"-",Rr(4),"-",Rr(4),"-",Rr(8)],r&&a.unshift(r),a.join("")),wt.Promise.resolve(["cmdId"]),e.abrupt("break",9);case 7:return wt.Promise.resolve(t),e.abrupt("break",9);case 9:case"end":return e.stop()}var r,a}),e)})))).apply(this,arguments)}function ei(e,t,n,r){return ti.apply(this,arguments)}function ti(){return ti=t(l.mark((function e(t,n,r,i){var o,a,s,u;return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.connected&&!this.disposed){e.next=2;break}return e.abrupt("return");case 2:if(!(s=this)._connectPromise){e.next=7;break}return e.next=6,s._connectPromise;case 6:return e.abrupt("return");case 7:return n=null!==(o=n)&&void 0!==o?o:this._defaultRetries,r=null!==(a=r)&&void 0!==a?a:100,u=kr(s,Gr,Jr).call(s,s.serverInfo),Br.debug("WebSocket URL: "+u+", try to create websocket "+n+"/"+r),s._connectPromise=new wt.Promise((function(e,t){var o=function(r){kr(s,Ur,Yr).call(s,s,u,s.serverInfo.protocol,i).then((function(t){e(t)}))["catch"]((function(e){Br.debug("create websocket failed: "+e.message),r<n?a(r):t(e)}))};function a(e,t,n){setTimeout((function(){o(++e)}),r)}o(0)})),e.prev=12,e.next=15,s._connectPromise;case 15:e.next=20;break;case 17:throw e.prev=17,e.t0=e["catch"](12),e.t0;case 20:return e.prev=20,s._connectPromise=null,e.finish(20);case 23:case"end":return e.stop()}}),e,this,[[12,17,20,23]])}))),ti.apply(this,arguments)}function ni(e,t,n,r){return ri.apply(this,arguments)}function ri(){return(ri=t(l.mark((function e(t,n,r,i){var o,a,s,u;return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=this,a=r.eventTaskId,s=r.lastEventTaskId,a!==undefined){e.next=7;break}return e.next=6,n(t,gn.GET_EVENT_TASKID,o._requestTaskId,r);case 6:a=e.sent;case 7:a&&(o._tasks[a]?r&&r.userData&&r.userData.command&&((u=o._tasks[a]).ctx=r,s&&((u=o._tasks[s]).ctx=r)):(u={id:i.id,resolver:null,ctx:r,timedout:!1},o._tasks[a]=u,s&&(o._tasks[s]=u)));case 8:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function ii(e,t,n,r,i,o,a){return oi.apply(this,arguments)}function oi(){return(oi=t(l.mark((function e(t,n,r,i,o,a,s){var u,c,f,d;return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=this,e.prev=1,r.client=u,e.next=5,kr(u,Vr,ei).call(u,o,i,a,s);case 5:if("0"!=(c=r.taskId)){e.next=12;break}return u.disposed||u._ws.send(t),t=null,e.abrupt("return");case 12:if(c!==undefined){e.next=16;break}return e.next=15,n(t,gn.GET_TASKID,null,r);case 15:c=e.sent;case 16:return c===undefined&&Br.debug("websocket send: task id is invalid."),(f={}).promise=new wt.Promise((function(e,t){f.resolve=e,f.reject=t})),d={id:c,resolver:f,ctx:r,timedout:!1},u._tasks[c]=d,u._requestTaskId=c,e.next=24,kr(u,Xr,ni).call(u,t,n,r,d);case 24:return u._cbToGetTaskId=n,s&&(d.tmid=setTimeout((function(){Br.debug("ws request time out."),d.timedout=!0,d.resolver.reject("request timed out.")}),s)),u.disposed||u._ws.send(t),Br.debug("end to send task "+c),t=null,e.abrupt("return",f.promise);case 32:if(e.prev=32,e.t0=e["catch"](1),c&&delete u._tasks[c],!(e.t0 instanceof hn||e.t0&&e.t0.code&&e.t0.message)){e.next=39;break}throw e.t0;case 39:if(!e.t0.message){e.next=41;break}throw new hn(e.t0.message);case 41:return e.prev=41,t=null,e.finish(41);case 44:case"end":return e.stop()}}),e,this,[[1,32,41,44]])})))).apply(this,arguments)}function ai(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return si(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return si(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n["return"]||n["return"]()}finally{if(s)throw o}}}}function si(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ui(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function ci(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}var li=new WeakSet,fi=new WeakSet,di=function(){function e(){d(this,e),ui(this,fi),ui(this,li),nn(this,"_maxWebSocketCon",10),nn(this,"_wsClients",[])}return g(e,[{key:"removeTerminatedWSClient",value:function(){this._wsClients=this._wsClients.filter((function(e){return!e.disposed}))}},{key:"getClient",value:function(e,t){return e.useWS?ci(this,fi,hi).call(this,e,t):new Pr(e)}},{key:"terminate",value:function(){var e=this._wsClients.slice();this._wsClients=[],e.forEach((function(e){e.dispose()}))}}],[{key:"Instance",get:function(){return this._gClientPool||(this._gClientPool=new e),this._gClientPool}}]),e}();function Ti(e){this.removeTerminatedWSClient();var t,n,r,i=ai(this._wsClients);try{for(i.s();!(t=i.n()).done;){var o=t.value;if(n=o.serverInfo,r=e,(null==n?void 0:n.port)==(null==r?void 0:r.port)&&(null==n?void 0:n.protocol)==(null==r?void 0:r.protocol)&&(null==n?void 0:n.server)==(null==r?void 0:r.server)&&(null==n?void 0:n.ssl)==(null==r?void 0:r.ssl)&&(null==n?void 0:n.useWS)==(null==r?void 0:r.useWS)&&!o.disposed)return o.addRef(),o}}catch(a){i.e(a)}finally{i.f()}return null}function hi(e,t){var n;return t||(n=ci(this,li,Ti).call(this,e)),n||(this._wsClients.length<this._maxWebSocketCon?((n=new zr(e)).addEvent("disposed","1",(function(){di.Instance.removeTerminatedWSClient()})),this._wsClients.push(n),n):null)}function gi(e){At.log(e)}nn(di,"_gClientPool",null),wt.ClientPool=di,wt.install={_divDWTNonInstallContainerID:"dwt-NonInstallContainerID",_divDWTemessageContainer:"",_dlgInstall:!1},wt.install._strNonInstallDIV=['<div style="text-align:center;" id="',wt.install._divDWTNonInstallContainerID,'"></div>'].join(""),wt._zdgb_xkz_dhk=function(){var e=wt.install._dlgInstall;if(e){var t=At.sizzle(".dynamsoft-dialog-closeTimer",e);if(t.length>0){var n=t[0],r=parseInt(n.style.width);(r-=1)<=0?yt.DWT.CloseDialog():(n.style.width=r+"%",setTimeout(wt._zdgb_xkz_dhk,100))}}},wt.ShowLicenseDialog=yt.DWT.ShowMessage,wt.createLoadingBarContent=function(){};var pi,mi="Checking Product Key format...";function _i(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function Si(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}!function(e){e.CM_RENDERALL=1,e.CM_IMAGEONLY=2,e.CM_AUTO=3,e.CM_RENDERALLWITHANNOTATION=4}(pi||(pi={}));var Ii=Pt+".",Ei=parseInt(Pt),vi={ActiveX:0,Plugin:1,HTML5:2,WinMacLinux:3,Barcode1D:4,Barcode2D:5,BarcodeWriter:6,OCR:7,Webcam:8,PDFRasterizer:9,OCRPro:10,QR:50,PDF417:51,DataMatrix:52};function bi(e){return At.isString(e)?At.trim(e):e}var wi=new WeakSet,Ci=new WeakSet,Ai=new WeakSet,Wi=new WeakSet,yi=new WeakSet,Pi=new WeakSet,Di=new WeakSet,Oi=new WeakSet,Li=new WeakSet,Ni=function(){function e(){d(this,e),_i(this,Li),_i(this,Oi),_i(this,Di),_i(this,Pi),_i(this,yi),_i(this,Wi),_i(this,Ai),_i(this,Ci),_i(this,wi),nn(this,"isLTS",En)}return g(e,[{key:"isLongKey",value:function(e){if(At.isString(e)&&e.length>0){var t=e.charAt(0);if("f"==t||"t"==t)return!0;if(At.startsWith(e,"DLS"))return!1;if(At.isNumber(e))return!1;var n=parseInt(e)+"-";return!At.startsWith(e,n)}return!1}},{key:"isLicenseMixed",value:function(e,t){var n,r=!1,i=e||yt.DWT.ProductKey;(yt.DWT.lclex(),t)&&((bi(yt.DWT.organizationID)||bi(yt.DWT.handshakeCode))&&i&&(r=!0,vn(n={},-2444,"A license can only be specified once and has already been set using the ProductKey API.")));if(!r&&At.isString(i))if(i=At.trim(i),At.startsWith(i,"f")||At.startsWith(i,"t"));else if(""==i);else if(At.startsWith(i,"DLS2"))try{Si(this,Ci,xi).call(this,i)}catch(a){r=!0,vn(n={},-2440,""),n._errorString=a.message}else{Si(this,wi,Ri).call(this,i).LTS||(r=!0,function(e){vn(e,_n.LicenseParseFailed,"The license is invalid.")}(n={}))}if(r&&n){bn(n);var o=yt.DWT.licenseException;At.error(o.message)}return r}},{key:"reparseProductKey",value:function(e){e&&gi("Parsing Product Key...");var t=bi(yt.DWT.organizationID),n=bi(yt.DWT.handshakeCode),r=t||n,i=At.trim(yt.DWT.ProductKey);if(!r){var o=Si(this,wi,Ri).call(this,i);o.LTS&&(n=bi(o.handshakeCode),r=(t=bi(o.organizationID))||n)}if(r)return this._innerResetLicense(),At.isNumber(i)&&(t=i),Ht.handshakeCode=n,Ht.organizationID=t,Ht.licenseServer=yt.DWT.licenseServer,Ht.sessionPassword=yt.DWT.sessionPassword,void(Ht.bPublicLTS=Si(this,Ai,Fi).call(this,Ht.licenseServer,r));var a=!1;if(Ht.refProductKey!==i&&(this._innerResetLicense(),At.isString(i)&&i.length>0&&(Ht.refProductKey=i,a=!0)),a)if(this.isLongKey(Ht.refProductKey))Ht.bPublicLTS=!1;else{var s,u={_pLoad:{isEmpty:Kt},_license:Ht.refProductKey,_licenseServer:[]};try{s=an(u)}catch(l){At.error(l),s=!1}if(s&&At.isString(s.l)){var c=At.trim(s.l);""==c?Ht.organizationID=c:-1!=c.indexOf("-")?Ht.handshakeCode=c:Ht.organizationID=c,At.isArray(s.ls)&&s.ls.length>0&&(Ht.licenseServer=s.ls),Ht.bPublicLTS=Si(this,Ai,Fi).call(this,Ht.licenseServer,c),Ht.sessionPassword=s.sp}else Ht.bPublicLTS=!1}}},{key:"_innerResetLicense",value:function(){Ht.refProductKey="",Ht.handshakeCode=undefined,Ht.organizationID=undefined,Ht.licenseServer=undefined,Ht.sessionPassword="",Ht.bPublicLTS=!0}},{key:"checkOSForAllowCore",value:function(e,t,n){if(Ht.bHTML5Edition){if(e)return Si(this,Li,Hi).call(this,t);var r=n._bRemoteMode,i=n.__serverPlatform;return this.isOSOK(t,r,i)}return Kt}},{key:"checkLocalPlatformForRemoteService",value:function(e){var t,n,r=e.__licenseInfo,i=Ft.getEnumPlatform(),o=!1;for(t=0;t<r.Detail.length;t++)if(n=r.Detail[t],Si(this,Di,Gi).call(this,n.EnumLicenseType,n.LicenseType).Core&&At.isString(n.Version)&&0==n.Version.indexOf(Ii)){if(o=Si(this,Li,Hi).call(this,n.OS))break;if(o=this.isOSOK(n.OS,true,i))break}return o||(i==Rt.enumWindow?function(e){vn(e,-2344,"The current product key does not support Windows OS. Please contact the site administrator."),bn(e)}(e):i==Rt.enumLinux?function(e){vn(e,-2346,"The current product key does not support Linux OS. Please contact the site administrator."),bn(e)}(e):i==Rt.enumMac?function(e){vn(e,-2345,"The current product key does not support MAC OS. Please contact the site administrator."),bn(e)}(e):function(e){vn(e,-2347,"The current product key does not support your OS. Please contact the site administrator."),bn(e)}(e)),o}},{key:"checkProductKey",value:function(e,t,n){var r,i=yt.DWT.licenseException;return!t.Camera&&(e.__licenseInfo||(e.__licenseInfo={}),(r=Si(this,yi,Mi).call(this,e,e.__licenseInfo,Xt,t,n))||(i.code=e._errorCode,i.message=e._getErrorString(),i.fromLTS=!1),r)}},{key:"isBindDomainOK",value:function(e){if(At.isUndefined(e)||null==e||""==e||"*"==e||"*.*"==e)return Kt;var t=location.hostname,n=Xt;if(""==t)return Kt;for(var r=t.toLowerCase().split("."),i=r.length,o=e.toLowerCase().split(";"),a=0;a<o.length;a++){var s=o[a];if("*.*"==s){n=Kt;break}var u=s.split("."),c=u.length;if(c>0&&c-1<=i){for(var l=Kt,f=c-1;f>0;f--){if(u[f].indexOf("*")>-1){n=Kt;break}if(f+i-c>=0){if(r[f+i-c]!=u[f]){l=Xt;break}}else if("*"!=u[f]){l=Xt;break}}if(l&&("*"==u[0]||i>=c&&r[i-c]==u[0])){n=Kt;break}}}return n}},{key:"isExpiredOrFuture",value:function(e,t){if(""==e)return Xt;if(!t){var n=e.length;if(n>2&&"/"==e[n-2]&&"0"==e[n-1])return Xt}var r=Vi(e),i=(new Date).getTime(),o=i+5184e6;return r.getTime()<i||t&&r.getTime()>o?Kt:Xt}},{key:"willTrialExpire",value:function(e){if(""==e)return Xt;var t=Vi(e),n=(new Date).getTime();return t.getTime()<n+432e6&&t.getTime()>n?Kt:Xt}},{key:"isOSOK",value:function(e,t,n){var r=!1,i=!1,o=!1,a=!1,s=!1,u=!1,c=!1,l=!1;return""==e||"0"==e?Kt:(t?n==Rt.enumWindow?o=!0:n==Rt.enumLinux?i=!0:n==Rt.enumMac?r=!0:n==Rt.enumEmbed?s=!0:n==Rt.enumChromeOS?u=!0:n==Rt.enumAndroid?c=!0:n==Rt.enumHarmonyOS?l=!0:n==Rt.enumiOS&&(a=!0):(r=z.bMac,i=z.bLinux,o=z.bWin,a=z.biPhone||z.biPad,u=z.bChromeOS,s=yt.navInfo.bEmbed,c=z.bAndroid,l=z.bHarmonyOS),(e=e.toLowerCase()).indexOf("windows")>-1&&o||e.indexOf("mac")>-1&&r||e.indexOf("linux")>-1&&(i||u||l)||e.indexOf("android")>-1&&c||e.indexOf("ios")>-1&&a||e.indexOf("embed")>-1&&s?Kt:Xt)}},{key:"isBrowserOK",value:function(e){if(At.isString(e)){if(""==e||"0"==e)return Kt;var t=(e=e.toLowerCase()).split(";"),n=Xt;return At.each(t,(function(e){("chrome"==At.trim(e)&&(z.bChrome||z.bSafari||z.bOpera||z.bEdge)||"ie"==At.trim(e)&&z.bIE||"firefox"==At.trim(e)&&z.bFirefox)&&(n=Kt)})),n}return Xt}},{key:"isAllowLicenseType",value:function(e,t){return t.Core?e.Core:t.PDFRasterizer?e.PDFRasterizer:t.Webcam||t.Camera?e.Webcam:t.barcode1D?e.barcode1D:t.QR?e.QR:t.PDF417?e.PDF417:t.DataMatrix?e.DataMatrix:t.OCR?e.OCR:t.OCRPro?e.OCRPro:e.Core}},{key:"setNoAllowedLicenseTypeError",value:function(e,t,n){n.Core?yn(e,t):n.Webcam||n.Camera?t||n.Camera?function(e){e._errorCode=-2431,En()?e._errorString="The license for the Camera Addon is not found or has expired.":vn(e,-2431,"The current product key does not support Camera Addon. Please contact the site administrator."),bn(e)}(e):function(e){e._errorCode=-2338,En()?e._errorString="The license for the module direct show is not found or has expired.":e._errorString="The current product key does not support Webcam. Please contact the site administrator.",bn(e)}(e):n.PDFRasterizer?t?function(e){e._errorCode=-2370,En()?e._errorString="The license for the module pdf rasterizer is not found or has expired.":e._errorString="The current product key does not support Pdf Rasterizer Wasm. Please contact the site administrator.",bn(e)}(e):Pn(e):n.OCR?function(e){e._errorCode=-2340,En()?e._errorString="The license for the module ocr is not found or has expired.":e._errorString="The current product key does not support OCR. Please contact the site administrator.",bn(e)}(e):n.OCRPro?function(e){e._errorCode=-2341,En()?e._errorString="The license for the module ocr pro is not found or has expired.":e._errorString="The current product key does not support OCR pro. Please contact the site administrator.",bn(e)}(e):An(e)}},{key:"getLicenseDateString",value:function(e){var t,n=e.getFullYear();return[(t=e.getMonth()+1)>=10?""+t:"0"+t,"/",e.getDate()>=10?""+e.getDate():"0"+e.getDate(),"/",n].join("")}},{key:"hasPDFRProductKey",value:function(e){return!!this.checkProductKey(e,{PDFRasterizer:!0},!0)||(e._resetErr(),!1)}},{key:"checkPDFProductKeyWhenNeeds",value:function(e,t){var n;if((t==yt.DWT.EnumDWT_ImageType.IT_PDF||t==yt.DWT.EnumDWT_ImageType.IT_MULTIPAGE_PDF)&&(Ht.bHTML5Edition?e.__addon&&e.__addon.PDF&&(n=e.__addon.PDF.GetConvertMode()):e.Addon&&e.Addon.PDF&&(n=e.Addon.PDF.GetConvertMode()),n==pi.CM_RENDERALL||n==pi.CM_RENDERALLWITHANNOTATION))return this.checkProductKey(e,{PDFRasterizer:!0},!0);return Kt}},{key:"getPublicLicenseContent",value:function(e){var t=[],n=e;if(!At.isString(n)){if(At.isUndefined(n))return"";n=n instanceof Error||"message"in n?n.message:""+n}var r=n.indexOf("["),i=n.indexOf("]",r),o=n.indexOf("(",i),a=n.indexOf(")",o);if(-1==r||-1==i||-1==o||-1==a)return n;r>0&&t.push(n.substring(0,r));var s=n.substring(r+1,i),u=n.substring(o+1,a);return t.push(['<a href="',u,'" target="_blank" class="dynamsoft-major-color">',s,"</a>"].join("")),t.push(n.substring(a+1)),t.join("")}},{key:"getLTSLicense",value:function(){return Ht.bPublicLTS?"":Ht.handshakeCode||Ht.organizationID}}]),e}();function Ri(e){var t,n,r=e,i=e.indexOf("-"),o=-1!=i;return n={},o&&(r=e.substring(0,i)),t=Number(r),isNaN(t)||String(Number(t))!==r||(o?n.handshakeCode=e:n.organizationID=e,n.LTS=Kt),n}function xi(e){an({_pLoad:{isEmpty:Kt},_license:e,_licenseServer:[]})}function Fi(e,t){var n=!0;if(At.isArray(e)&&e.length>0){var r=e[0];At.isString(r)&&""!=r&&-1==r.indexOf("https://mlts.dynamsoft.com")&&(n=!1)}return n&&(!t||"200001"===t||At.startsWith(t,"200001-"))}function ki(e,t,n){return this.checkOSForAllowCore(e,t,n)}function Mi(e,t,n,r,i){var o;if(t&&t.LTS){if(!t||!At.isArray(t.Detail)||0==t.Detail.length)return this.isLTS()?yn(e,n):An(e),Xt}else if(!t||!At.isArray(t.Detail)||0==t.Detail.length)return this.isLTS()?yn(e,n):An(e),Xt;var a,s,u,c,l=0,f=0,d=[],T=[],h=Xt,g=Xt,p=Xt,m=Xt,_=Xt;if(!this.isBindDomainOK(t.Domain))return function(e){vn(e,-2342,"The domain of your current site does not match the domain bound in the current product key. Please contact the site administrator."),bn(e)}(e),Xt;for(t.Detail.length>0&&(o="FALSE"!=(u=t.Detail[0]).Trial),s=1;s<t.Detail.length;s++)if("FALSE"==(u=t.Detail[s]).Trial&&o||"TRUE"==u.Trial&&!o)return xn(e),Xt;if(t.bTrial=o,r.Core||r.Webcam){var S=[],I=!1;for(s=0;s<t.Detail.length;s++)if(u=t.Detail[s],c=Si(this,Di,Gi).call(this,u.EnumLicenseType,u.LicenseType),r.Core&&c.Core&&this.checkOSForAllowCore(n,u.OS,e)||r.Core&&c.Core&&Ht.bActiveXEdition&&c.ActiveX||r.Webcam&&c.Webcam&&!n){if(t.LTS);else if(!At.isString(u.Version)||0!=u.Version.indexOf(Ii)){S.push(u);continue}if(Ht.bHTML5Edition){if(c.ActiveX&&!c.Html5)continue;T.push(u)}else{if(!c.ActiveX&&c.Html5)continue;T.push(u)}I=!0}if(!I&&S.length>0)return S.splice(0),function(e,t){vn(e,_n.LicenseVersionNotCurrent,"The current product key is not for version ".concat(t,". Please contact the site administrator.")),bn(e)}(e,[Pt,Dt].join(".")),!1;S.splice(0)}else T=t.Detail;for(s=0;s<T.length;s++){var E=Kt;if(u=T[s],c=Si(this,Di,Gi).call(this,u.EnumLicenseType,u.LicenseType),r.Core&&c.Core||this.isAllowLicenseType(c,r)){a=u.ExpireDate.replace(/-/g,"/");var v="FALSE"!=u.Trial;if(this.isExpiredOrFuture(a,v))d.push(a);else if(v&&c.Core&&this.willTrialExpire(a)&&(t.ExpireDate=a),t.LTS||c.Core&&Ht.bHTML5Edition&&parseInt(u.Version)>=Ei||c.Core&&Ht.bActiveXEdition||!c.Core){var b=!1;if(c.Core)(this.checkOSForAllowCore(n,u.OS,e)||Ht.bActiveXEdition&&c.ActiveX)&&(b=!0);else{var w=n;r.Camera&&(w=!0),Si(this,Wi,ki).call(this,w,u.OS,e)&&(b=!0)}b?this.isBrowserOK(u.Browser)||i?(l++,E=Xt):g=Kt:r.Core?h=Kt:r.PDFRasterizer?m=Kt:(r.Webcam||r.Camera)&&(_=Kt)}else p=Kt;E&&f++}}if(l>0)return Kt;if(0==f)return this.setNoAllowedLicenseTypeError(e,n,r),Xt;if(d.length>0){var C,A=0,W=1e20,y="",P=(new Date).getTime();for(a="",s=0;s<d.length;s++)(C=Vi(d[s])).getTime()<P&&C.getTime()>A?(A=C.getTime(),a=d[s]):C.getTime()>P&&C.getTime()<W&&(W=C.getTime(),y=d[s]);return""!=a?(C=Vi(a),Wn(e,a=this.getLicenseDateString(C))):""!=y?(C=Vi(y),y=this.getLicenseDateString(C),function(e,t){vn(e,_n.LicenseIsFuture,"The current product key is invalid. Please contact the site administrator."),bn(e)}(e)):Wn(e,""),Xt}return p?(function(e){vn(e,-2348,"The current product key is invalid because it's generated with the licenses of a different major version."),bn(e)}(e),Xt):g?(z.bEdge?function(e){vn(e,-2330,"The current product key does not support Edge. Please contact the site administrator."),bn(e)}(e):z.bChrome?function(e){vn(e,-2327,"The current product key does not support Chrome. Please contact the site administrator."),bn(e)}(e):z.bFirefox?function(e){vn(e,-2328,"The current product key does not support Firefox. Please contact the site administrator."),bn(e)}(e):z.bIE?function(e){vn(e,-2329,"The current product key does not support IE. Please contact the site administrator."),bn(e)}(e):z.bSafari?function(e){vn(e,-2392,"The current product key does not support Safari. Please contact the site administrator."),bn(e)}(e):function(e){vn(e,-2343,"The current product key does not support your browser. Please contact the site administrator."),bn(e)}(e),Xt):h?(this.setNoAllowedLicenseTypeError(e,n,{Core:!0}),Xt):m?(this.setNoAllowedLicenseTypeError(e,n,{PDFRasterizer:!0}),Xt):_?(this.setNoAllowedLicenseTypeError(e,n,{Webcam:!0}),Xt):(An(e),Xt)}function Bi(e){var t=Xt,n=Xt,r=Xt,i=Xt,o=Xt,a=Xt,s=Xt,u=Xt,c=Xt;return At.isString(e)&&""!=e&&At.each(e.split(";"),(function(e){var l=1*e;l==vi.HTML5||l==vi.WinMacLinux||l==vi.ActiveX||l==vi.Plugin?t=Kt:l==vi.Barcode1D?n=Kt:l==vi.QR?r=Kt:l==vi.PDF417?i=Kt:l==vi.DataMatrix?o=Kt:l==vi.OCR?a=Kt:l==vi.Webcam?s=Kt:l==vi.PDFRasterizer?u=Kt:l==vi.OCRPro&&(c=Kt)})),{Core:t,PDFRasterizer:u,Webcam:s,barcode1D:n,QR:r,PDF417:i,DataMatrix:o,OCR:a,OCRPro:c}}function Gi(e,t){var n=Si(this,Pi,Bi).call(this,e),r=Si(this,Oi,Ui).call(this,t);return At.each(["Core","Html5","ActiveX","PDFRasterizer","Webcam","barcode1D","QR","PDF417","DataMatrix","OCR","OCRPro"],(function(e){n[e]=n[e]||r[e]})),n}function Ui(e){var t=Xt,n=Xt,r=Xt,i=Xt,o=Xt,a=Xt,s=Xt,u=Xt,c=Xt,l=Xt,f=Xt;return e&&""!=e&&("html5;activex;oldie"==(e=e.toLowerCase())?(i=Kt,t=Kt):"html5;activex"==e?(n=Kt,i=Kt,t=Kt):e.indexOf("html5")>-1||"win=(aph) or mac=(ph) or linux(h)"==e?(n=Kt,t=Kt):"1d barcode reader"==e?r=Kt:"2d barcode reader(qrcode)"==e?o=Kt:"2d barcode reader(pdf417)"==e?a=Kt:"2d barcode reader(data matrix)"==e?s=Kt:"ocr"==e?u=Kt:"webcam"==e?c=Kt:"pdf rasterizer"==e?l=Kt:"proocr"==e&&(f=Kt)),{Core:t,Html5:n,ActiveX:i,PDFRasterizer:l,Webcam:c,barcode1D:r,QR:o,PDF417:a,DataMatrix:s,OCR:u,OCRPro:f}}function Hi(e){var t=e.toLowerCase();return t.indexOf("wasm")>-1||t.indexOf("mobile")>-1}var ji=new Ni;function Vi(e){var t,n=e;return n=n.replace(/-/g,"/"),t=Date.parse(n),isNaN(t)&&(t=0),(t=new Date(t)).setHours(23,59,59,999),t}function Xi(e){var t=yt.DWT.licenseException;t.code=e.code,t.message=e.message,e&&(!function(e){At.isFunction(yt.DWT.OnWebTwainError)?yt.DWT.OnWebTwainError(e):At.isFunction(window.Dynamsoft_OnError)&&window.Dynamsoft_OnError(e)}(e),e instanceof Error?At.error(e):At.error(At.stringify(e)))}function Ki(e){var t=0,n=e.message;At.isNumber(e.code)?t=e.code:At.isString(n)&&(t=-1),0!=t&&function(e,t){At.isFunction(yt.OnLicenseError)&&yt.OnLicenseError(t,e)}(t,n)}function zi(e){Ki(function(e){return{code:e._errorCode,message:e._errorString}}(e))}yt.DWT.isPublicLicense=function(){return Ht.bPublicLTS};var Ji=z.bWin,Yi=z.bMac,qi=z.bLinux,Qi=z.bSafari,Zi=z.bFirefox,$i=z.bChrome,eo=location.hostname,to=location.pathname,no=0,ro=z.bMobile,io=parseFloat(z.strBrowserVersion);if(z.bWin||z.bMac||z.bLinux||z.bChromeOS){if(yt.navInfo){var oo=yt.navInfo;ro=ro||oo.bAndroid||oo.bPad||oo.biPhone||oo.biPad}}else ro=!0;""===eo?Ji&&to.lastIndexOf("\\")>1?to=to.substring(1,to.lastIndexOf("\\")).replace(/%20/g," "):(no=1,to=to.substring(1,to.lastIndexOf("/")).replace(/%20/g," ")):(no=1,to=to.substring(0,to.lastIndexOf("/")));var ao={bChrome:$i,bFirefox:Zi,bSafari:Qi,bIE:z.bIE,bEdge:z.bEdge,bWin:Ji,bMac:Yi,bLinux:qi,iPluginLength:0,bFileSystem:z.bFileSystem,bMobile:ro,strIEVersion:z.IEVersion,strChromeVersion:z.bChrome?io:"",strFirefoxVersion:z.bFirefox?io:"",basePath:to,pathType:no,isDesktopViewer:function(){return z.bWin||z.bLinux||z.bChromeOS||z.bMac},isPadViewer:function(){return z.bPad||z.biPad},isMobileViewer:function(){return z.bMobile||z.biPhone||z.bAndroid||z.bHarmonyOS},WSVersion:"12.0.0",WSSession:(new Date).getTime(),bDiscardBlankImage:Xt};wt.product=Ht;var so={encodeChars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",decodeChars:[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1]},uo=self||window;wt.btoa=function(e){for(var t,n,r=String(e),i=0,o=so.encodeChars,a="";r.charAt(0|i)||(o="=",i%1);a+=o.charAt(63&t>>8-i%1*8)){if((n=r.charCodeAt(i+=3/4))>255)throw new Error("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");t=t<<8|n}return a},uo.btoa||(uo.btoa=wt.btoa),wt.atob=function(e){var t=String(e).replace(/[=]+$/,"");if(t.length%4==1)throw new Error("'atob' failed: The string to be decoded is not correctly encoded.");for(var n,r,i=0,o=0,a="";r=t.charAt(o++);~r&&(n=i%4?64*n+r:r,i++%4)?a+=String.fromCharCode(255&n>>(-2*i&6)):0)r=so.encodeChars.indexOf(r);return a},uo.atob||(uo.atob=wt.atob);var co={isFunction:function(e){return e&&"function"==typeof e},isReturnSuccess:function(e){if(-2115===e._errorCode)return Kt;if(-2003===e._errorCode&&!yt.DWT.IfHttpPostErrorNoWindow){var t=window.open("","ErrorMessage","height=500,width=750,top=0,left=0,toolbar=no,menubar=no,scrollbars=no, resizable=no,location=no, status=no");null==t||t.document.writeln(e.HTTPPostResponseString)}return 0==e._errorCode?Kt:Xt},setErrorString:function(e){e._errorCode=e.getSWebTwain().ErrorCode,e._errorString=e.getSWebTwain().ErrorString},checkErrorString:function(e){return co.setErrorString(e),co.isReturnSuccess(e)},wrapperRet:function(e,t,n,r,i,o){if(co.checkErrorString(e)){if(co.isFunction(n))if(i){var a=e.getSWebTwain().HTTPPostResponseString;a&&""!=a?(e._errorCode=-2003,e._errorString="HTTP process error.",wt.isFunction(r)&&r(e._errorCode,e._errorString,a)):n(a)}else{if(o)return n(t),!0;n()}}else co.isFunction(r)&&(i?r(e._errorCode,e._errorString,e.getSWebTwain().HTTPPostResponseString):r(e._errorCode,e._errorString));return t},wrapperPromise:function(e,t){return co.setErrorString(e),0==e._errorCode?wt.Promise.resolve(t):wt.Promise.reject({code:e._errorCode,message:e._errorString})},getImageType:function(e){if(e===undefined)return-1;if(e.length<4)return-1;var t=e.lastIndexOf(".");if(-1===t)return-1;var n=e.slice(t).toLowerCase();return".bmp"===n||".dib"===n?yt.DWT.EnumDWT_ImageType.IT_BMP:".jpg"===n||".jpe"===n||".jpeg"===n||".jfif"===n?yt.DWT.EnumDWT_ImageType.IT_JPG:".tif"===n||".tiff"===n?yt.DWT.EnumDWT_ImageType.IT_TIF:".png"===n?yt.DWT.EnumDWT_ImageType.IT_PNG:".pdf"===n?yt.DWT.EnumDWT_ImageType.IT_PDF:".jp2"===n||".j2k"===n||".j2c"===n?yt.DWT.EnumDWT_ImageType.IT_J2K:-1},replaceLocalFilename:function(e){var t=e;return z.bFileSystem&&(t=decodeURI(t)),t},makeParams:function(){var e=arguments;return e===undefined||0===e.length?undefined:e}};wt.checkErrorString=co.checkErrorString,wt.wrapperRet=co.wrapperRet,wt.setErrorString=co.setErrorString,wt.DynamicLoadAddonFuns=[],wt.attachAddon=function(e){if(z.bWin){var t,n=!yt.navInfo.bOSx64||yt.navInfo.bWOW64,r=e.getSWebTwain();t=n?"DynamicPdfCore_"+xt.ActiveXPdfVersion+".dll":"DynamicPdfCorex64_"+xt.ActiveXPdfVersion+".dll";try{r.GetAddOnVersion("pdf",t)["catch"]((function(){}))}catch(i){}wt.each(wt.DynamicLoadAddonFuns,(function(t){wt.isFunction(t)&&t(e)}))}};var lo,fo,To,ho,go,po,mo,_o,So,Io,Eo,vo,bo,wo,Co,Ao,Wo,yo,Po,Do,Oo,Lo,No,Ro,xo,Fo,ko,Mo,Bo,Go;wt.attachProperty=function(e){var t=e,n=function(e,n,r){var i;0!==n&&1!==n?i=n:(i={},n&&(i.set=1==r?function(n){return n*=1,!wt.isNumber(n)||isNaN(n)?(Cn(t),Xt):(t.getSWebTwain()[e]=n,co.checkErrorString(t))}:2==r?function(n){return wt.isBoolean(n)?(t.getSWebTwain()[e]=n,co.checkErrorString(t)):(Cn(t),Xt)}:function(n){return wt.isString(n)?(t.getSWebTwain()[e]=n,co.checkErrorString(t)):(Cn(t),Xt)})),i.get||(i.get=function(){var n=t.getSWebTwain()[e];return t._errorCode=t.getSWebTwain().ErrorCode,t._errorString=t.getSWebTwain().ErrorString,n}),e in t||Object.defineProperty(t,e,i)};n("ErrorCode",{get:function(e){return t._errorCode}}),n("ErrorString",{get:function(e){return t._errorString}}),n("LogLevel",{get:function(){var e=t.getSWebTwain().LogLevel;return t._errorCode=t.getSWebTwain().ErrorCode,t._errorString=t.getSWebTwain().ErrorString,e},set:function(e){var n=1*e;return!wt.isNumber(n)||isNaN(n)?(Cn(t),Xt):(t.getSWebTwain().LogLevel=n,co.checkErrorString(t))}}),n("Manufacturer",1),n("ProductFamily",1),n("ProductKey",{get:function(){return yt.DWT.ProductKey},set:function(e){var n=Kt,r=e;if(r=wt.isString(r)?wt.trim(r):"",yt.DWT.ProductKey=r,ji.reparseProductKey(),t.__licenseInfo=undefined,""==r)n=Xt,ji.checkProductKey(t,{Core:Kt},Xt)||zi(t);else{var i=yt.DWT.licenseException;if(0!=i.code)return t._errorCode=i.code,t._errorString=i.message,n;t.__licenseInfo=undefined,t.GetLicenseInfo(r),n=co.checkErrorString(t)}return n}}),n("ProductName",1),n("VersionInfo",1),n("BitDepth",1,1),n("Brightness",1,1),n("Contrast",1,1),n("CurrentSourceName",0),n("DataSourceStatus",0),n("DefaultSourceName",0),n("Duplex",0),n("IfAppendImage",1,2),n("IfAutoBright",1,2),n("IfAutoDiscardBlankpages",1,2),n("IfAutoFeed",1,2),n("IfAutomaticBorderDetection",1,2),n("IfAutomaticDeskew",1,2),n("IfAutoScan",1,2),n("IfDisableSourceAfterAcquire",1,2),n("IfDuplexEnabled",1,2),n("IfFeederEnabled",1,2),n("IfModalUI",1,2),n("IfScanInNewThread",1,2),n("IfShowCancelDialogWhenImageTransfer",1,2),n("IfShowUI",1,2),n("IfShowIndicator",1,2),n("IfUseTwainDSM",1,2),n("IfFeederLoaded",0,2),n("IfPaperDetectable",0,2),n("IfUIControllable",0,2),n("ImageBitsPerPixel",0),n("ImageCaptureDriverType",1,1),n("ImageLayoutDocumentNumber",0),n("ImageLayoutFrameBottom",0),n("ImageLayoutFrameLeft",0),n("ImageLayoutFrameNumber",0),n("ImageLayoutFrameRight",0),n("ImageLayoutFrameTop",0),n("ImageLayoutPageNumber",0),n("ImageLength",0),n("ImagePixelType",0),n("ImageWidth",0),n("ImageXResolution",0),n("ImageYResolution",0),n("MagData",0),n("MagType",0),n("PageSize",1,1),n("PendingXfers",0),n("PixelFlavor",1,1),n("PixelType",1,1),n("Resolution",1,1),n("SourceCount",0),n("TransferMode",1,1),n("Unit",1,1),n("XferCount",1,1),n("Capability",1,1),n("CapCurrentIndex",1,1),n("CapCurrentValue",1,1),n("CapDefaultIndex",0),n("CapDefaultValue",0),n("CapDescription",1),n("CapMaxValue",1,1),n("CapMinValue",1,1),n("CapNumItems",1,1),n("CapStepSize",1,1),n("CapType",1,1),n("CapValue",1,1),n("CapValueString",1),n("CapValueType",1,1),n("AllowMultiSelect",1,2),n("BackgroundColor",1,1),n("BackgroundFillColor",1,1),n("BlankImageCurrentStdDev",0),n("BlankImageMaxStdDev",1,1),n("BlankImageThreshold",1,1),n("CurrentImageIndexInBuffer",{set:function(e){return e!=t.getSWebTwain().CurrentImageIndexInBuffer&&(t.getSWebTwain().CurrentImageIndexInBuffer=e),co.checkErrorString(t)}}),n("FitWindowType",1,1),n("HowManyImagesInBuffer",0),n("IfFitWindow",1,2),n("ImageMargin",1,1),n("MaxImagesInBuffer",1,1),n("MouseX",0),n("MouseY",0),n("SelectionImageBorderColor",1),n("Zoom",1,1),n("MouseShape",1,2),n("SelectedImagesIndices",{get:function(){for(var e=[],n=t.getSWebTwain().SelectedImagesCount,r=0;r<n;r++)e.push(t.getSWebTwain().GetSelectedImageIndex(r));return e}}),n("HTTPPostResponseString",0),n("AsyncMode",1,2),n("FTPPassword",1),n("FTPPort",{set:function(e){return""!==e?(e*=1,t.getSWebTwain().FTPPort=e,co.checkErrorString(t)):Xt}}),n("FTPUserName",1),n("HTTPPort",{set:function(e){return""!==e?(e*=1,t.getSWebTwain().HTTPPort=e,co.checkErrorString(t)):(e=wt.detect.ssl?443:80,t.getSWebTwain().HTTPPort=e,co.checkErrorString(t))}}),n("HTTPPassword",1),n("HTTPUserName",1),n("IfPASVMode",1,2),n("IfShowProgressBar",1,2),n("ProxyServer",1),n("IfShowFileDialog",1,2),n("IfTiffMultiPage",1,2),n("PDFAuthor",1),n("PDFCompressionType",1,1),n("PDFCreationDate",1),n("PDFCreator",1),n("PDFKeywords",1),n("PDFModifiedDate",1),n("PDFProducer",1),n("PDFSubject",1),n("PDFTitle",1),n("PDFVersion",1),n("TIFFCompressionType",1,1),n("JPEGQuality",{set:function(e){return(e*=1)>=100?e=100:e<0&&(e=0),t.getSWebTwain().JPEGQuality=e,co.checkErrorString(t)}}),n("HttpContentTypeFieldValue",1),n("SelectionRectAspectRatio",1,1),n("IfAllowLocalCache",1,2),n("_AutoCropMethod",1,2),n("BrokerProcessType",1,1),n("BorderStyle",1,1),n("IfShowPrintUI",1,2),n("VScrollBar",1,2),n("EnableInteractiveZoom",1,2),n("ImageEditorIfEnableEnumerator",1,2),n("ImageEditorIfReadonly",1,2),n("ImageEditorIfModal",1,2),n("ImageEditorWindowTitle",1),n("IfSSL",1,2),n("AllowPluginAuthentication",1,2),n("HttpFieldNameOfUploadedImage",1),n("MaxInternetTransferThreads",1,1),n("MaxUploadImageSize",1,1),n("IfOpenImageWithGDIPlus",1,2),n("BufferMemoryLimit",1,1),n("Width",{get:function(){return t.getSWebTwain().style.width},set:function(e){return t._ChangeWidth(e),co.checkErrorString(t)}}),n("Height",{get:function(){return t.getSWebTwain().style.height},set:function(e){return t._ChangeHeight(e),co.checkErrorString(t)}}),n("IfThrowException",1,2),n("IfAutoScroll",1,2),n("ShowPageNumber",{get:function(){return Xt},set:function(e){return Xt}}),n("UseLocalService",{get:function(){return!0}})},wt.attachMethod=function(e){var n=e,r=function(e){return ji.checkProductKey(n,{Core:Kt})?Kt:(wt.isFunction(e)&&e(n.ErrorCode,n.ErrorString),Xt)},i=function(e,t){return ji.checkPDFProductKeyWhenNeeds(n,e)?Kt:(wt.isFunction(t)&&t(n.ErrorCode,n.ErrorString),Xt)},o=function(e,t){return 0!=e.HowManyImagesInBuffer||(function(e){vn(e,-1035,"There is no image.")}(e),wt.isFunction(t)&&t(e.ErrorCode,e.ErrorString),!1)},a=function(e,t,n){return!!o(e,n)&&(!(isNaN(t)||!wt.isNumber(t)||t<0||t>=e.HowManyImagesInBuffer)||(On(e),wt.isFunction(n)&&n(e.ErrorCode,e.ErrorString),!1))};e.UnregisterEvent=function(e,t){if(!wt.isString(e))return Nn(n),!1;if("onwsmessage"===e.toLowerCase())return Nn(n),!1;if("OnPostAllTransfers"===e)return n.__OnPostAllTransfers=null,!0;if("OnBufferChanged"===e)return n.__OnBufferChanged=null,!0;if("OnBitmapChanged"===e)return n.__OnBitmapChanged=null,!0;n.getSWebTwain().UnregisterEvent(e,(function(){}));var r=["__",e].join("");return n[r]=null,co.checkErrorString(n)},e.RegisterEvent=function(e,t){if(!wt.isString(e))return Nn(n),!1;var r=e.toLowerCase();if("onwsmessage"===r)return Nn(n),!1;if(wt.isFunction(t)){if("onpostalltransfers"===r)return n.__OnPostAllTransfers=t,!0;if("onbufferchanged"===r)return n.__OnBufferChanged=t,!0;if("onbitmapchanged"===r)return n.__OnBitmapChanged=t,!0;var i=["__",e].join("");return n[i]=t,n.getSWebTwain().RegisterEvent(e,t),co.checkErrorString(n)}return!0},e.onEvent=function(e,t){return n.RegisterEvent(e,t)},e.on=function(e,t){return n.RegisterEvent(e,t)},e.CancelAllPendingTransfers=function(){return n.getSWebTwain().CancelAllPendingTransfers(),co.checkErrorString(n)},e.CloseSource=function(){return n.getSWebTwain().CloseSource(),co.checkErrorString(n)},e.CloseSourceManager=function(){return n.getSWebTwain().CloseSourceManager(),co.checkErrorString(n)},e.DisableSource=function(){return n.getSWebTwain().DisableSource(),co.checkErrorString(n)},e.FeedPage=function(){return n.getSWebTwain().FeedPage(),co.checkErrorString(n)},e.GetDeviceType=function(){var e=n.getSWebTwain().GetDeviceType();return co.setErrorString(n),e},e.GetSourceNameItems=function(e){var t=n.getSWebTwain().GetSourceNameItems(e);return co.setErrorString(n),t},e.SourceNameItems=function(e){var t=n.getSWebTwain().GetSourceNameItems(e);return co.setErrorString(n),t},e.GetSourceNames=function(){var t,r,i=[];for(t=n.getSWebTwain().SourceCount,r=0;r<t;r++){var o=e.GetSourceNameItems(r);i.push(o)}return i},e.GetSourceType=function(e){var t=n.getSWebTwain().GetSourceType(e);return co.setErrorString(n),t},e.OpenSource=function(){return n.getSWebTwain().OpenSource(),co.checkErrorString(n)},e.OpenSourceManager=function(){return n.getSWebTwain().OpenSourceManager(),co.checkErrorString(n)},e.ResetImageLayout=function(){return n.getSWebTwain().ResetImageLayout(),co.checkErrorString(n)},e.RewindPage=function(){return n.getSWebTwain().RewindPage(),co.checkErrorString(n)},e.SelectSource=function(e,t){return wt.isUndefined(e)?(n.getSWebTwain().SelectSource(),co.checkErrorString(n)):(n.getSWebTwain().SelectSource(),co.checkErrorString(n)?(e(),!0):(t(),!1))},e.SelectSourceByIndex=function(e){return n.getSWebTwain().SelectSourceByIndex(e),co.checkErrorString(n)},e.CloseSourceAsync=function(){return co.wrapperPromise(n,n.CloseSource())},e.CloseSourceManagerAsync=function(){return co.wrapperPromise(n,n.CloseSourceManager())},e.GetSourceNamesAsync=function(){return co.wrapperPromise(n,n.GetSourceNames())},e.GetSourceTypeAsync=function(e){return co.wrapperPromise(n,n.GetSourceType(e))},e.OpenSourceAsync=function(){return co.wrapperPromise(n,n.OpenSource())},e.OpenSourceManagerAsync=function(){return co.wrapperPromise(n,n.OpenSourceManager())},e.SelectSourceAsync=function(e){return e&&0==(e&Vt.TWAINSCANNER)&&0==(e&Vt.WIATWAINSCANNER)?(Rn(n),wt.Promise.reject({code:n._errorCode,message:n._errorString})):co.wrapperPromise(n,n.SelectSource())},e.SelectSourceByIndexAsync=function(e){return co.wrapperPromise(n,n.SelectSourceByIndex(e))},e.SetFileXferInfo=function(e,t){var r=co.replaceLocalFilename(e);return n.getSWebTwain().SetFileXferInfo(r,t),co.checkErrorString(n)},e.SetImageLayout=function(e,t,r,i){return n.getSWebTwain().SetImageLayout(e,t,r,i),co.checkErrorString(n)},e.CapGet=function(){var e=n.getSWebTwain().CapGet();return co.setErrorString(n),e},e.CapGetCurrent=function(){var e=n.getSWebTwain().CapGetCurrent();return co.setErrorString(n),e},e.CapGetDefault=function(){var e=n.getSWebTwain().CapGetDefault();return co.setErrorString(n),e},e.CapGetFrameBottom=function(e){var t=n.getSWebTwain().CapGetFrameBottom(e);return co.setErrorString(n),t},e.CapGetFrameLeft=function(e){var t=n.getSWebTwain().CapGetFrameLeft(e);return co.setErrorString(n),t},e.CapGetFrameRight=function(e){var t=n.getSWebTwain().CapGetFrameRight(e);return co.setErrorString(n),t},e.CapGetFrameTop=function(e){var t=n.getSWebTwain().CapGetFrameTop(e);return co.setErrorString(n),t},e.CapGetHelp=function(){var e=n.getSWebTwain().CapGetHelp();return co.setErrorString(n),e},e.CapGetLabel=function(){var e=n.getSWebTwain().CapGetLabel();return co.setErrorString(n),e},e.CapGetLabels=function(){var e=n.getSWebTwain().CapGetLabels();return co.setErrorString(n),e},e.CapIfSupported=function(e){var t=n.getSWebTwain().CapIfSupported(e);return co.setErrorString(n),t},e.CapReset=function(){return n.getSWebTwain().CapReset(),co.checkErrorString(n)},e.CapSet=function(){return n.getSWebTwain().CapSet(),co.checkErrorString(n)},e.CapSetFrame=function(e,t,r,i,o){return n.getSWebTwain().CapSetFrame(e,t,r,i,o),co.checkErrorString(n)},e.GetCapItems=function(e){var t=n.getSWebTwain().GetCapItems(e);return co.setErrorString(n),t},e.GetCapItemsString=function(e){var t=n.getSWebTwain().GetCapItemsString(e);return co.setErrorString(n),t},e.SetCapItems=function(e,t){return n.getSWebTwain().SetCapItems(e,t),co.checkErrorString(n)},e.SetCapItemsString=function(e,t){return n.getSWebTwain().SetCapItemsString(e,t),co.checkErrorString(n)},e.AddText=function(e,t,r,i,o,a,s,u){var c=parseInt(e);return isNaN(c)||c<0||c>=n.HowManyImagesInBuffer?(On(n),!1):(n.getSWebTwain().AddText(c,t,r,i,o,a,s,u),co.checkErrorString(n))},e.CreateTextFont=function(e,t,r,i,o,a,s,u,c,l,f,d,T,h){return n.getSWebTwain().CreateTextFont(e,t,r,i,o,a,s,u,c,l,f,d,T,h),co.checkErrorString(n)},e.CopyToClipboard=function(e){var t=parseInt(e);return isNaN(t)||t<0||t>=n.HowManyImagesInBuffer?(On(n),!1):(n.getSWebTwain().CopyToClipboard(t),co.checkErrorString(n))},e.Erase=function(e,t,r,i,o,a,s){var u,c=parseInt(e);return isNaN(c)||c<0||c>=n.HowManyImagesInBuffer?(On(n),wt.isFunction(s)&&s(n.ErrorCode,n.ErrorString),!1):(u=n.getSWebTwain().Erase(c,t,r,i,o),co.wrapperRet(n,u,a,s))},e.GetImageBitDepth=function(e){var t=parseInt(e);if(isNaN(t)||t<0||t>=n.HowManyImagesInBuffer)return On(n),!1;var r=n.getSWebTwain().GetImageBitDepth(t);return co.setErrorString(n),r},e.GetImageWidth=function(e){var t=parseInt(e);if(isNaN(t)||t<0||t>=n.HowManyImagesInBuffer)return On(n),!1;var r=n.getSWebTwain().GetImageWidth(t);return co.setErrorString(n),r},e.GetImageHeight=function(e){var t=parseInt(e);if(isNaN(t)||t<0||t>=n.HowManyImagesInBuffer)return On(n),!1;var r=n.getSWebTwain().GetImageHeight(t);return co.setErrorString(n),r},e.GetImageSize=function(e,t,r){var i=parseInt(e);if(isNaN(i)||i<0||i>=n.HowManyImagesInBuffer)return On(n),!1;var o=n.getSWebTwain().GetImageSize(i,t,r);return co.setErrorString(n),o},e.GetImageSizeWithSpecifiedType=function(e,t){var r=parseInt(e);if(isNaN(r)||r<0||r>=n.HowManyImagesInBuffer)return On(n),!1;var i=n.getSWebTwain().GetImageSizeWithSpecifiedType(r,t);return co.setErrorString(n),i},e.GetImageXResolution=function(e){var t=parseInt(e);if(isNaN(t)||t<0||t>=n.HowManyImagesInBuffer)return On(n),!1;var r=n.getSWebTwain().GetImageXResolution(t);return co.setErrorString(n),r},e.GetImageYResolution=function(e){var t=parseInt(e);if(isNaN(t)||t<0||t>=n.HowManyImagesInBuffer)return On(n),!1;var r=n.getSWebTwain().GetImageYResolution(t);return co.setErrorString(n),r},e.CopyToClipboardAsync=function(e){return co.wrapperPromise(n,n.CopyToClipboard(e))},e.EraseAsync=function(e,t,r,i,o){return co.wrapperPromise(n,n.Erase(e,t,r,i,o))},e.GetImageBitDepthAsync=function(e){return co.wrapperPromise(n,n.GetImageBitDepth(e))},e.GetImageWidthAsync=function(e){return co.wrapperPromise(n,n.GetImageWidth(e))},e.GetImageHeightAsync=function(e){return co.wrapperPromise(n,n.GetImageHeight(e))},e.GetImageSizeAsync=function(e,t,r){return co.wrapperPromise(n,n.GetImageSize(e,t,r))},e.GetImageSizeWithSpecifiedTypeAsync=function(e,t){return co.wrapperPromise(n,n.GetImageSizeWithSpecifiedType(e,t))},e.GetImageXResolutionAsync=function(e){return co.wrapperPromise(n,n.GetImageXResolution(e))},e.GetImageYResolutionAsync=function(e){return co.wrapperPromise(n,n.GetImageYResolution(e))},e.SelectAllImages=function(){var e,t=n.getSWebTwain().HowManyImagesInBuffer,r=[];for(n.getSWebTwain().SelectedImagesCount=t,e=0;e<t;e++)n.getSWebTwain().SetSelectedImageIndex(e,e),r.push(e);return co.checkErrorString(n),r},e.SelectImages=function(e){var t=e.length;n.getSWebTwain().SelectedImagesCount=t;for(var r=0;r<t;r++)n.getSWebTwain().SetSelectedImageIndex(r,e[r]);return co.checkErrorString(n)},e.GetSelectedImagesSize=function(e){var t=n.getSWebTwain().GetSelectedImagesSize(e);return co.setErrorString(n),t},e.GetSkewAngle=function(e,t,r){var i,o=parseInt(e);return isNaN(o)||o<0||o>=n.HowManyImagesInBuffer?(On(n),wt.isFunction(r)&&r(n.ErrorCode,n.ErrorString),!1):(i=n.getSWebTwain().GetSkewAngle(o),co.wrapperRet(n,i,t,r,!1,!0))},e.GetSkewAngleEx=function(e,t,r,i,o,a,s){var u,c=parseInt(e);return isNaN(c)||c<0||c>=n.HowManyImagesInBuffer?(On(n),wt.isFunction(s)&&s(n.ErrorCode,n.ErrorString),!1):(u=n.getSWebTwain().GetSkewAngleEx(c,t,r,i,o),co.wrapperRet(n,u,a,s))},e.IsBlankImage=function(e){var t=parseInt(e);if(isNaN(t)||t<0||t>=n.HowManyImagesInBuffer)return On(n),!1;var r=n.getSWebTwain().IsBlankImage(t);return co.setErrorString(n),r},e.IsBlankImageEx=function(e,t,r,i,o,a){var s=parseInt(e);if(isNaN(s)||s<0||s>=n.HowManyImagesInBuffer)return On(n),!1;var u=n.getSWebTwain().IsBlankImageEx(s,t,r,i,o,a);return co.setErrorString(n),u},e.Mirror=function(e,t,r){var i,o=parseInt(e);return isNaN(o)||o<0||o>=n.HowManyImagesInBuffer?(On(n),wt.isFunction(r)&&r(n.ErrorCode,n.ErrorString),!1):(i=n.getSWebTwain().Mirror(o),co.wrapperRet(n,i,t,r))},e.OverlayRectangle=function(e,t,r,i,o,a,s){return n.getSWebTwain().OverlayRectangle(e,t,r,i,o,a,s),co.checkErrorString(n)},e.RemoveAllImages=function(){var e;return n.getSWebTwain().RemoveAllImages(),(e=co.checkErrorString(n))&&n.__innerRefreshImage(),n.Width=parseInt(n.Width)+2,e},e.RemoveAllSelectedImages=function(){var e;return n.getSWebTwain().RemoveAllSelectedImages(),(e=co.checkErrorString(n))&&n.__innerRefreshImage(),e},e.RemoveImage=function(e){var t=parseInt(e);return isNaN(t)||t<0||t>=n.HowManyImagesInBuffer?(On(n),!1):(n.getSWebTwain().RemoveImage(t),co.checkErrorString(n))},e.MirrorAsync=function(e){return co.wrapperPromise(n,n.Mirror(e))},e.RemoveAllImagesAsync=function(){return co.wrapperPromise(n,n.RemoveAllImages())},e.RemoveAllSelectedImagesAsync=function(){return co.wrapperPromise(n,n.RemoveAllSelectedImages())},e.RemoveImageAsync=function(e){return co.wrapperPromise(n,n.RemoveImage(e))},e.Rotate=function(e,t,r,i,o){var a,s=parseInt(e);return isNaN(s)||s<0||s>=n.HowManyImagesInBuffer?(On(n),wt.isFunction(o)&&o(n.ErrorCode,n.ErrorString),!1):(a=n.getSWebTwain().Rotate(s,t,r),co.wrapperRet(n,a,i,o))},e.RotateEx=function(e,t,r,i,o,a){var s,u=parseInt(e);return isNaN(u)||u<0||u>=n.HowManyImagesInBuffer?(On(n),wt.isFunction(a)&&a(n.ErrorCode,n.ErrorString),!1):(s=n.getSWebTwain().RotateEx(u,t,r,i),co.wrapperRet(n,s,o,a))},e.RotateLeft=function(e,t,r){var i,o=parseInt(e);return isNaN(o)||o<0||o>=n.HowManyImagesInBuffer?(On(n),wt.isFunction(r)&&r(n.ErrorCode,n.ErrorString),!1):(i=n.getSWebTwain().RotateLeft(o),co.wrapperRet(n,i,t,r))},e.RotateRight=function(e,t,r){var i,o=parseInt(e);return isNaN(o)||o<0||o>=n.HowManyImagesInBuffer?(On(n),wt.isFunction(r)&&r(n.ErrorCode,n.ErrorString),!1):(i=n.getSWebTwain().RotateRight(o),co.wrapperRet(n,i,t,r))},e.ChangeImageSize=function(e,t,r,i,o,a){var s,u=parseInt(e);return isNaN(u)||u<0||u>=n.HowManyImagesInBuffer?(On(n),wt.isFunction(a)&&a(n.ErrorCode,n.ErrorString),!1):t<=0||r<=0?(vn(n,-2307,"The width or height you entered is invalid."),wt.isFunction(a)&&a(n.ErrorCode,n.ErrorString),!1):(s=n.getSWebTwain().ChangeImageSize(u,t,r,i),co.wrapperRet(n,s,o,a))},e.Flip=function(e,t,r){var i,o=parseInt(e);return isNaN(o)||o<0||o>=n.HowManyImagesInBuffer?(On(n),wt.isFunction(r)&&r(n.ErrorCode,n.ErrorString),!1):(i=n.getSWebTwain().Flip(o),co.wrapperRet(n,i,t,r))},e.Crop=function(e,t,r,i,o,a,s){var u,c=parseInt(e);return isNaN(c)||c<0||c>=n.HowManyImagesInBuffer?(On(n),wt.isFunction(s)&&s(n.ErrorCode,n.ErrorString),!1):(u=n.getSWebTwain().Crop(c,t,r,i,o),co.wrapperRet(n,u,a,s))},e.CropToClipboard=function(e,t,r,i,o){var a=parseInt(e);return isNaN(a)||a<0||a>=n.HowManyImagesInBuffer?(On(n),!1):(n.getSWebTwain().CropToClipboard(a,t,r,i,o),co.checkErrorString(n))},e.CutFrameToClipboard=function(e,t,r,i,o){var a=parseInt(e);return isNaN(a)||a<0||a>=n.HowManyImagesInBuffer?(On(n),!1):(n.getSWebTwain().CutFrameToClipboard(a,t,r,i,o),co.checkErrorString(n))},e.CutToClipboard=function(e){var t=parseInt(e);return isNaN(t)||t<0||t>=n.HowManyImagesInBuffer?(On(n),!1):(n.getSWebTwain().CutToClipboard(t),co.checkErrorString(n))},e.RotateAsync=function(e,t,r){return co.wrapperPromise(n,n.Rotate(e,t,r))},e.RotateExAsync=function(e,t,r,i){return co.wrapperPromise(n,n.RotateEx(e,t,r,i))},e.RotateLeftAsync=function(e){return co.wrapperPromise(n,n.RotateLeft(e))},e.RotateRightAsync=function(e){return co.wrapperPromise(n,n.RotateRight(e))},e.ChangeImageSizeAsync=function(e,t,r,i){return co.wrapperPromise(n,n.ChangeImageSize(e,t,r,i))},e.FlipAsync=function(e){return co.wrapperPromise(n,n.Flip(e))},e.CropAsync=function(e,t,r,i,o){return co.wrapperPromise(n,n.Crop(e,t,r,i,o))},e.CropToClipboardAsync=function(e,t,r,i,o){return co.wrapperPromise(n,n.CropToClipboard(e,t,r,i,o))},e.CutFrameToClipboardAsync=function(e,t,r,i,o){return co.wrapperPromise(n,n.CutFrameToClipboard(e,t,r,i,o))},e.CutToClipboardAsync=function(e){return co.wrapperPromise(n,n.CutToClipboard(e))},e.InvertAsync=function(e){return co.wrapperPromise(n,n.Invert(e))},e.Invert=function(e){var t=parseInt(e);return isNaN(t)||t<0||t>=n.HowManyImagesInBuffer?(On(n),!1):(Fn(n),!1)},e.SetDPI=function(e,t,r,i,o,a,s){var u,c=parseInt(e);return isNaN(c)||c<0||c>=n.HowManyImagesInBuffer?(On(n),wt.isFunction(s)&&s(n.ErrorCode,n.ErrorString),!1):(u=n.getSWebTwain().SetDPI(c,t,r,i,o),co.wrapperRet(n,u,a,s))},e.SetViewMode=function(e,t){return n.getSWebTwain().SetViewMode(e,t),co.checkErrorString(n)},e.GetViewModeH=function(){var e=n.getSWebTwain().GetViewModeH();return co.setErrorString(n),e},e.GetViewModeV=function(){var e=n.getSWebTwain().GetViewModeV();return co.setErrorString(n),e},e.MoveImage=function(e,t){var r=parseInt(e),i=parseInt(t);return isNaN(r)||r<0||r>=n.HowManyImagesInBuffer||isNaN(i)||i<0||i>=n.HowManyImagesInBuffer?(On(n),!1):(n.getSWebTwain().MoveImage(r,i),co.checkErrorString(n))},e.SwitchImage=function(e,t){var r=parseInt(e),i=parseInt(t);return isNaN(r)||r<0||r>=n.HowManyImagesInBuffer||isNaN(i)||i<0||i>=n.HowManyImagesInBuffer?(On(n),!1):(n.getSWebTwain().SwitchImage(r,i),co.checkErrorString(n))},e.Print=function(){return n.getSWebTwain().Print(),co.checkErrorString(n)},e.checkErrorString=function(){return co.isReturnSuccess(n)},e.FileExists=function(e){var t=co.replaceLocalFilename(e),r=n.getSWebTwain().FileExists(t);return co.setErrorString(n),r},e.SaveAllAsMultiPageTIFF=function(e,t,r){if(!o(n,r))return!1;var i,a=co.replaceLocalFilename(e);return i=n.getSWebTwain().SaveAllAsMultiPageTIFF(a),co.wrapperRet(n,i,t,r)},e.SaveAllAsPDF=function(e,t,r){if(!o(n,r))return!1;var i,a=co.replaceLocalFilename(e);return i=n.getSWebTwain().SaveAllAsPDF(a),co.wrapperRet(n,i,t,r)},e.SaveAsBMP=function(e,t,r,i){if(!a(n,t,i))return!1;var o,s=co.replaceLocalFilename(e);return o=n.getSWebTwain().SaveAsBMP(s,t),co.wrapperRet(n,o,r,i)},e.SaveAsJPEG=function(e,t,r,i){if(!a(n,t,i))return!1;var o,s=co.replaceLocalFilename(e);return o=n.getSWebTwain().SaveAsJPEG(s,t),co.wrapperRet(n,o,r,i)},e.SaveAsPDF=function(e,t,r,i){if(!a(n,t,i))return!1;var o,s=co.replaceLocalFilename(e);return o=n.getSWebTwain().SaveAsPDF(s,t),co.wrapperRet(n,o,r,i)},e.SaveAsPNG=function(e,t,r,i){if(!a(n,t,i))return!1;var o,s=co.replaceLocalFilename(e);return o=n.getSWebTwain().SaveAsPNG(s,t),co.wrapperRet(n,o,r,i)},e.SaveAsTIFF=function(e,t,r,i){if(!a(n,t,i))return!1;var o,s=co.replaceLocalFilename(e);return o=n.getSWebTwain().SaveAsTIFF(s,t),co.wrapperRet(n,o,r,i)},e.SaveSelectedImagesAsMultiPagePDF=function(e,t,r){var i,o=co.replaceLocalFilename(e);return i=n.getSWebTwain().SaveSelectedImagesAsMultiPagePDF(o),co.wrapperRet(n,i,t,r)},e.SaveSelectedImagesAsMultiPageTIFF=function(e,t,r){var i,o=co.replaceLocalFilename(e);return i=n.getSWebTwain().SaveSelectedImagesAsMultiPageTIFF(o),co.wrapperRet(n,i,t,r)},e.SaveSelectedImagesToBase64Binary=function(e,t){var r=n.getSWebTwain().SaveSelectedImagesToBase64Binary();return co.wrapperRet(n,r,e,t)},e.ShowFileDialog=function(e,t,r,i,o,a,s,u){return n.getSWebTwain().ShowFileDialog(e,t,r,i,o,a,s,u),co.checkErrorString(n)},e.FTPDownload=function(e,t,i,o){if(!r(o))return!1;var a=n.getSWebTwain().FTPDownload(e,t);return a&&En()&&yt.DWT.lcvrf(n),co.wrapperRet(n,a,i,o)},e.FTPDownloadDirectly=function(e,t,i,o,a){if(!r(a))return!1;var s=n.getSWebTwain().FTPDownloadDirectly(e,t,i);return co.wrapperRet(n,s,o,a)},e.FTPDownloadEx=function(e,t,o,a,s){if(!r(s))return!1;if(o!=yt.DWT.EnumDWT_ImageType.IT_BMP&&o!=yt.DWT.EnumDWT_ImageType.IT_JPG&&o!=yt.DWT.EnumDWT_ImageType.IT_TIF&&o!=yt.DWT.EnumDWT_ImageType.IT_PNG&&o!=yt.DWT.EnumDWT_ImageType.IT_PDF&&o!=yt.DWT.EnumDWT_ImageType.IT_J2K&&(o=-1),!i(o,s))return Xt;var u=n.getSWebTwain().FTPDownloadEx(e,t,o);return co.wrapperRet(n,u,a,s)},e.FTPUpload=function(e,t,i,o,a){if(!r(a))return!1;var s=n.getSWebTwain().FTPUpload(e,t,i);return co.wrapperRet(n,s,o,a)},e.FTPUploadDirectly=function(e,t,i,o,a){if(!r(a))return!1;var s=n.getSWebTwain().FTPUploadDirectly(e,t,i);return co.wrapperRet(n,s,o,a)},e.FTPUploadEx=function(e,t,i,o,a,s){if(!r(s))return!1;var u=n.getSWebTwain().FTPUploadEx(e,t,i,o);return co.wrapperRet(n,u,a,s)},e.FTPUploadAllAsMultiPageTIFF=function(e,t,i,o){if(!r(o))return!1;var a=n.getSWebTwain().FTPUploadAllAsMultiPageTIFF(e,t);return co.wrapperRet(n,a,i,o)},e.FTPUploadAllAsPDF=function(e,t,i,o){if(!r(o))return!1;var a=n.getSWebTwain().FTPUploadAllAsPDF(e,t);return co.wrapperRet(n,a,i,o)},e.FTPUploadAsMultiPagePDF=function(e,t,r,i){var o=n.getSWebTwain().FTPUploadAsMultiPagePDF(e,t);return co.wrapperRet(n,o,r,i)},e.FTPUploadAsMultiPageTIFF=function(e,t,r,i){var o=n.getSWebTwain().FTPUploadAsMultiPageTIFF(e,t);return co.wrapperRet(n,o,r,i)},e.HTTPDownloadDirectly=function(e,t,i,o,a){if(!r(a))return!1;var s=n.getSWebTwain().HTTPDownloadDirectly(e,t,i);return co.wrapperRet(n,s,o,a)},e.HTTPDownload=function(e,t,r,i){var o=co.getImageType(t);return n.HTTPDownloadEx(e,t,o,r,i)},e.HTTPDownloadEx=function(e,t,o,a,s){if(!r(s))return Xt;if(o!=yt.DWT.EnumDWT_ImageType.IT_BMP&&o!=yt.DWT.EnumDWT_ImageType.IT_JPG&&o!=yt.DWT.EnumDWT_ImageType.IT_TIF&&o!=yt.DWT.EnumDWT_ImageType.IT_PNG&&o!=yt.DWT.EnumDWT_ImageType.IT_PDF&&o!=yt.DWT.EnumDWT_ImageType.IT_J2K&&(o=-1),!i(o,s))return Xt;var u=n.getSWebTwain().HTTPDownloadEx(e,t,o);return u&&En()&&yt.DWT.lcvrf(n),co.wrapperRet(n,u,a,s)},e.HTTPDownloadThroughGet=e.HTTPDownloadEx,e.HTTPUploadThroughPostDirectly=function(e,t,i,o,a,s){if(!r(s))return!1;var u=n.getSWebTwain().HTTPUploadThroughPostDirectly(e,t,i,o);return co.wrapperRet(n,u,a,s,!0)},e.HTTPUploadThroughPost=function(e,t,r,i,o,a){if(!wt.isNumber(t)||isNaN(t)||t<-2)return On(n),wt.isFunction(a)&&a(n.ErrorCode,n.ErrorString),!1;var s=n.getSWebTwain().HTTPUploadThroughPost(e,t,r,i);return co.wrapperRet(n,s,o,a,!0)},e.HTTPUploadThroughPostEx=function(e,t,r,i,o,a,s){if(!wt.isNumber(t)||isNaN(t)||t<-2)return On(n),wt.isFunction(s)&&s(n.ErrorCode,n.ErrorString),!1;var u=n.getSWebTwain().HTTPUploadThroughPostEx(e,t,r,i,o);return co.wrapperRet(n,u,a,s,!0)},e.ClearAllHTTPFormField=function(){return n.getSWebTwain().ClearAllHTTPFormField(),co.checkErrorString(n)},e.SetHTTPFormField=function(e,t){return n.getSWebTwain().SetHTTPFormField(e,t),co.checkErrorString(n)},e.HTTPUploadAllThroughPostAsMultiPageTIFF=function(e,t,r,i,o){var a;return a=n.getSWebTwain().HTTPUploadAllThroughPostAsMultiPageTIFF(e,t,r),co.wrapperRet(n,a,i,o,!0)},e.HTTPUploadThroughPostAsMultiPageTIFF=function(e,t,r,i,o){var a;return a=n.getSWebTwain().HTTPUploadThroughPostAsMultiPageTIFF(e,t,r),co.wrapperRet(n,a,i,o,!0)},e.HTTPUploadAllThroughPostAsPDF=function(e,t,r,i,o){var a;return a=n.getSWebTwain().HTTPUploadAllThroughPostAsPDF(e,t,r),co.wrapperRet(n,a,i,o,!0)},e.HTTPUploadThroughPostAsMultiPagePDF=function(e,t,r,i,o){var a;return a=n.getSWebTwain().HTTPUploadThroughPostAsMultiPagePDF(e,t,r),co.wrapperRet(n,a,i,o,!0)},e.HTTPUploadThroughPutDirectly=function(e,t,r,i,o){var a;return a=n.getSWebTwain().HTTPUploadThroughPutDirectly(e,t,r),co.wrapperRet(n,a,i,o)},e.HTTPUploadThroughPut=function(e,t,r,i,o){var a=co.getImageType(r);return n.HTTPUploadThroughPutEx(e,t,r,a,i,o)},e.HTTPUploadThroughPutEx=function(e,t,r,i,o,a){var s;return s=n.getSWebTwain().HTTPUploadThroughPutEx(e,t,r,i),co.wrapperRet(n,s,o,a)},e.HTTPUploadAllThroughPutAsMultiPageTIFF=function(e,t,r,i){return n.HTTPUploadThroughPutEx(e,-1,t,2,r,i)},e.HTTPUploadThroughPutAsMultiPageTIFF=function(e,t,r,i){return n.HTTPUploadThroughPutEx(e,-2,t,2,r,i)},e.HTTPUploadAllThroughPutAsPDF=function(e,t,r,i){return n.HTTPUploadThroughPutEx(e,-1,t,4,r,i)},e.HTTPUploadThroughPutAsMultiPagePDF=function(e,t,r,i){return n.HTTPUploadThroughPutEx(e,-2,t,4,r,i)},e.ShowImageEditor=function(){return n.getSWebTwain().ShowImageEditor(),co.checkErrorString(n)},e.SetCookie=function(e){return n.getSWebTwain().SetCookie(e),co.checkErrorString(n)},e.LoadImageFromBase64Binary=function(e,t,o,a){if(!r())return Xt;if(t!=yt.DWT.EnumDWT_ImageType.IT_BMP&&t!=yt.DWT.EnumDWT_ImageType.IT_JPG&&t!=yt.DWT.EnumDWT_ImageType.IT_TIF&&t!=yt.DWT.EnumDWT_ImageType.IT_PNG&&t!=yt.DWT.EnumDWT_ImageType.IT_PDF&&t!=yt.DWT.EnumDWT_ImageType.IT_J2K&&(t=-1),!i(t))return wt.isFunction(a)&&a(n._errorCode,n._errorString),Xt;var s=n.getSWebTwain().LoadImageFromBase64Binary(e,t);return co.setErrorString(n),s?wt.isFunction(o)&&o():wt.isFunction(a)&&a(n._errorCode,n._errorString),s},e.SaveSelectedImagesToBytes=function(e,t){var r=n.getSWebTwain().SaveSelectedImagesToBytes(e,t);return co.setErrorString(n),r},e.LoadImageFromBytes=function(e,t,o){if(!r())return Xt;if(o!=yt.DWT.EnumDWT_ImageType.IT_BMP&&o!=yt.DWT.EnumDWT_ImageType.IT_JPG&&o!=yt.DWT.EnumDWT_ImageType.IT_TIF&&o!=yt.DWT.EnumDWT_ImageType.IT_PNG&&o!=yt.DWT.EnumDWT_ImageType.IT_PDF&&o!=yt.DWT.EnumDWT_ImageType.IT_J2K&&(o=-1),!i(o))return Xt;var a=n.getSWebTwain().LoadImageFromBytes(e,t,o);return co.setErrorString(n),a},e.SetImageWidth=function(e,t,r,i){var o,a=parseInt(e);return isNaN(a)||a<0||a>=n.HowManyImagesInBuffer?(On(n),wt.isFunction(i)&&i(n.ErrorCode,n.ErrorString),!1):(o=n.getSWebTwain().SetImageWidth(a,t),co.wrapperRet(n,o,r,i))},e.HTTPDownloadThroughPost=function(e,t,o,a,s){if(!r(s))return!1;if(o!=yt.DWT.EnumDWT_ImageType.IT_BMP&&o!=yt.DWT.EnumDWT_ImageType.IT_JPG&&o!=yt.DWT.EnumDWT_ImageType.IT_TIF&&o!=yt.DWT.EnumDWT_ImageType.IT_PNG&&o!=yt.DWT.EnumDWT_ImageType.IT_PDF&&o!=yt.DWT.EnumDWT_ImageType.IT_J2K&&(o=-1),!i(o,s))return Xt;var u=n.getSWebTwain().HTTPDownloadThroughPost(e,t,o);return co.wrapperRet(n,u,a,s)},e.SetCustomDSDataEx=function(e){return n.getSWebTwain().SetCustomDSDataEx(e),co.checkErrorString(n)},e.SetCustomDSData=function(e){return n.getSWebTwain().SetCustomDSData(e),co.checkErrorString(n)},e.GetCustomDSDataEx=function(){var e=n.getSWebTwain().GetCustomDSDataEx();return co.setErrorString(n),e},e.GetCustomDSData=function(e){var t=n.getSWebTwain().GetCustomDSData(e);return co.setErrorString(n),t},e.ChangeBitDepth=function(e,t,r){var i=parseInt(e);return isNaN(i)||i<0||i>=n.HowManyImagesInBuffer?(On(n),!1):(n.getSWebTwain().ChangeBitDepth(i,t,r),co.checkErrorString(n))},e.ConvertToGrayScale=function(e,t,r){var i,o=parseInt(e);return isNaN(o)||o<0||o>=n.HowManyImagesInBuffer?(On(n),wt.isFunction(r)&&r(n.ErrorCode,n.ErrorString),!1):(i=n.getSWebTwain().ConvertToGrayScale(e),co.wrapperRet(n,i,t,r))},e.ShowImageEditorEx=function(e,t,r,i,o){return n.getSWebTwain().ShowImageEditorEx(e,t,r,i,o),co.checkErrorString(n)},e.ClearTiffCustomTag=function(){return n.getSWebTwain().ClearTiffCustomTag(),co.checkErrorString(n)},e.SetTiffCustomTag=function(e,t,r){var i=1*e;return wt.isUndef(e)||wt.isUndef(t)?(Rn(n),!1):i<=0||i>2147483647?(vn(n,-2378,"Invalid value for the tiff tag code."),!1):(n.getSWebTwain().SetTiffCustomTag(e,t,r),co.checkErrorString(n))},e.IsBlankImageExpress=function(e){var t=parseInt(e);if(isNaN(t)||t<0||t>=n.HowManyImagesInBuffer)return On(n),!1;var r=n.getSWebTwain().IsBlankImageExpress(t);return co.setErrorString(n),r},e._ChangeWidth=function(e){var t,r=document.getElementById(n._strDWTInnerContainerID);if(wt.isString(e)&&e.length>0&&"%"===e.charAt(e.length-1)&&(t=e),!t){var i=parseInt(e);i&&i>2&&(t=i-2+"px")}return t&&(n._strWidth=t,n.getSWebTwain().style.width=t,r&&(r.style.width=t)),Kt},e._ChangeHeight=function(e){var t,r=document.getElementById(n._strDWTInnerContainerID);if(wt.isString(e)&&e.length>0&&"%"===e.charAt(e.length-1)&&(t=e),!t){var i=parseInt(e);i&&(t=i+"px")}return t&&(n._strHeight=t,n.getSWebTwain().style.height=t,r&&(r.style.height=t)),Kt},e.SetSize=function(e,t){return this._ChangeWidth(e),this._ChangeHeight(t),Kt},e.SetSelectedImageArea=function(e,t,r,i,o){return n.getSWebTwain().SetSelectedImageArea(e,t,r,i,o),co.checkErrorString(n)},e.SetVideoRotateMode=function(e){return n.getSWebTwain().SetVideoRotateMode(e),co.checkErrorString(n)},e.SetOpenSourceTimeout=function(e){return n.getSWebTwain().SetOpenSourceTimeout(e),co.checkErrorString(n)},e.SetHTTPHeader=function(e,t){return!1},e.GetImageURL=function(e,t,n){return""},e.GetImagePartURL=function(e){var t=parseInt(e);if(isNaN(t)||t<0||t>=n.HowManyImagesInBuffer)return On(n),"";var r=n.getSWebTwain().GetDIB(t);return co.setErrorString(n),r},e.GetLicenseInfo=function(e){try{var t,r=!1;if(En())r=!0,t=n.getSWebTwain().GetLicenseInfo();else if(wt.isString(e))if(ji.isLicenseMixed(e,!1)){var i=yt.DWT.licenseException;n._errorCode=i.code,n._errorString=i.message}else ji.isLongKey(e)?(n.getSWebTwain().ProductKey=e,t=n.getSWebTwain().GetLicenseInfo()):An(n);else An(n);if(t&&co.checkErrorString(n)){var o=wt.parse(t);if(o&&o.message)An(n),n._errorString=o.message,o=undefined;else if(r){if(o&&wt.isArray(o.Detail)&&o.Detail.length>0){var a=o.Detail[0].ExpireDate;yt.DWT.lsexp(yt.DWT.EnumInstance.dwt_desktop,a,"")}o.LTS=!0}u=o,(s=n).__licenseInfo=u,function(e){e.__calic||(e.__calic=e.__licenseInfo)}(s)}else n.__licenseInfo=undefined}catch(c){n.__licenseInfo=undefined}var s,u;return wt.Promise.resolve(n.__licenseInfo)},e.LoadDibFromClipboard=function(e,t){var r=n.getSWebTwain().LoadDibFromClipboard();return r&&En()&&yt.DWT.lcvrf(n),co.wrapperRet(n,r,e,t)},e.LoadImage=function(e,t,i){if(!r(i))return!1;var o,a=co.replaceLocalFilename(e);return(o=n.getSWebTwain().LoadImage(a))&&En()&&yt.DWT.lcvrf(n),co.wrapperRet(n,o,t,i)},e.LoadImageEx=function(e,t,o,a){if(!r(a))return Xt;if(t!=yt.DWT.EnumDWT_ImageType.IT_BMP&&t!=yt.DWT.EnumDWT_ImageType.IT_JPG&&t!=yt.DWT.EnumDWT_ImageType.IT_TIF&&t!=yt.DWT.EnumDWT_ImageType.IT_PNG&&t!=yt.DWT.EnumDWT_ImageType.IT_PDF&&t!=yt.DWT.EnumDWT_ImageType.IT_J2K&&(t=-1),!i(t,a))return Xt;var s,u=co.replaceLocalFilename(e),c=t;return c==yt.DWT.EnumDWT_ImageType.IT_ALL&&(c=-1),(s=n.getSWebTwain().LoadImageEx(u,c))&&En()&&yt.DWT.lcvrf(n),co.wrapperRet(n,s,o,a)},e.EnableSource=function(e,t,r){return this.AcquireImage(e,t,r),co.checkErrorString(n)},e.AcquireImage=function(e,t,i){var o,a,s,u=n.getSWebTwain();if(wt.isUndefined(i)&&(wt.isFunction(e)&&wt.isFunction(t)||wt.isFunction(e)&&wt.isUndefined(t)||wt.isFunction(e)&&null==t||null==e&&wt.isFunction(t))?(o=null,wt.isFunction(e)&&(a=e),wt.isFunction(t)&&(s=function(){t(n._errorCode,n._errorString)})):(o=wt.isUndefined(e)||null==e?{}:wt.clone(e),wt.isFunction(t)&&(a=function(){t(o)}),wt.isFunction(i)&&(s=function(){i(o,n._errorCode,n._errorString)})),!r(s))return!1;var c,l=!1;o!==undefined&&null!==o&&(null!=(c=o.SelectSourceByIndex)&&void 0!==c&&(u.SelectSourceByIndex(c),u.CloseSource()),u.OpenSource(),null!=(c=o.IfShowUI)&&void 0!==c&&(u.IfShowUI=c),null!=(c=o.PixelType)&&void 0!==c&&(u.PixelType=c),null!=(c=o.Resolution)&&void 0!==c&&(u.Resolution=c),null!=(c=o.IfFeederEnabled)&&void 0!==c&&(u.IfFeederEnabled=c),null!=(c=o.IfDuplexEnabled)&&void 0!==c&&(u.IfDuplexEnabled=c),null!=(c=o.IfDisableSourceAfterAcquire)&&void 0!==c&&(u.IfDisableSourceAfterAcquire=c),null!=(c=o.IfCloseSourceAfterAcquire)&&void 0!==c&&(l=!!c));return n.getSWebTwain().RegisterEvent("OnPostTransferAsync",(function(e){var t;e&&wt.isString(e)&&(t=wt.parse(e)),wt.isFunction(n.__OnPostTransferAsync)&&n.__OnPostTransferAsync(t)})),n.getSWebTwain().RegisterEvent("OnPostAllTransfers",(function(){co.checkErrorString(n)?(En()&&yt.DWT.lcvrf(n),wt.isFunction(a)&&a()):wt.isFunction(s)&&s(n._errorCode,n._errorString),wt.isFunction(n.__OnPostAllTransfers)&&n.__OnPostAllTransfers(),l&&u.CloseSource()})),u.AcquireImage(),co.checkErrorString(n)},e.AcquireImageAsync=function(){var e=t(l.mark((function r(e){var t;return l.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t=e?wt.clone(e):{},r.abrupt("return",new wt.Promise((function(e,r){n.AcquireImage(t,(function(){e(!0)}),(function(){r({code:n._errorCode,message:n._errorString})}))})));case 2:case"end":return r.stop()}}),r)})));return function(t){return e.apply(this,arguments)}}(),e.GetDevicesAsync=function(e,t,r){var i,o=null!=e?e:Jt,a=null!=t&&t,s=null!=r&&r;return i=function(e,t){var n,r=[],i=t;if(At.isString(i)&&(i=At.parse(i)),At.isArray(i))for(n=0;n<i.length;n++){var o=$t(i[n]);r.push(o)}for(n=0;n<r.length;n++){var a=r[n],s=a.deviceType;a.strDevice=At.stringify(a),a.name&&(a.name=At.base64.decode(a.name)),s&zt&&a.deviceInfo&&Zt(a.deviceInfo),a.serviceInfo=null==e?void 0:e._dmService,Qt(a,null==e?void 0:e._dmService)}return r}(null,i=n.getSWebTwain().GetDevices(o,a,s)),co.wrapperPromise(n,i)},e.SelectDeviceAsync=function(e,t){var r,i=null!=t?t:en.SMF_NAME;if(n._resetErr(),!(e&&e instanceof qt))throw Rn(n),{code:n._errorCode,message:n._errorString};return r=n.getSWebTwain().SelectDevice(e.strDevice,i),co.wrapperPromise(n,r)},e.GenerateURLForUploadData=function(e,t,r){var i=e;return i==yt.DWT.EnumDWT_ImageType.IT_ALL&&(i=-1),!0,co.wrapperRet(n,true,t,r)},e._innerFun=function(e,t,r){var i=n.getSWebTwain(),o=i[e];return"function"==typeof o?o.apply(i,t):o},e.ActiveUI=function(e,t){},e.startScan=function(){return new wt.Promise((function(e,t){}))},e.IndexToImageID=function(e){return e},e.ImageIDToIndex=function(e){return e},e.first=function(){return n.HowManyImagesInBuffer>0&&(n.CurrentImageIndexInBuffer=0,n.__innerRefreshImage()),Kt},e.previous=function(){var e;return n.HowManyImagesInBuffer>0&&(e=n.CurrentImageIndexInBuffer)>0&&(n.CurrentImageIndexInBuffer=e-1,n.__innerRefreshImage()),Kt},e.next=function(){var e,t=n.HowManyImagesInBuffer;return t>0&&(e=n.CurrentImageIndexInBuffer)>=0&&e<t-1&&(n.CurrentImageIndexInBuffer=e+1,n.__innerRefreshImage()),Kt},e.last=function(){var e=n.HowManyImagesInBuffer;return e>0&&(n.CurrentImageIndexInBuffer=e-1,n.__innerRefreshImage()),Kt},e.isUsingActiveX=function(){return!0},e.show=function(){return e.ShowImageEditor()},e.SetLTSInfo=function(e,t){return n.getSWebTwain().SetLTSInfo(e,t)},e.EnableBuffer=function(e){return n.getSWebTwain().Encrypt(e,0)},e.GetBuffer=function(e){return n.getSWebTwain().GetBuffer(e)},e.GetUUID=function(){return n.getSWebTwain().GetUUID()},e.__OnDispatchThumbnailEvt=function(t,n,r){1==r?wt.isFunction(e["__"+t+"_Thumbnail"])&&("OnMouseClick"==t||"OnMouseDoubleClick"==t||"OnMouseMove"==t||"OnMouseWheel"==t||"OnKeyDown"==t?e["__"+t+"_Thumbnail"]():e["__"+t+"_Thumbnail"](n)):wt.isFunction(e["__"+t])&&e["__"+t](n)},e._OnImageAreaSelected=function(t,n,r,i,o,a){var s="OnImageAreaSelected";1==a?wt.isFunction(e["__"+s+"_Thumbnail"])&&e["__"+s+"_Thumbnail"](t,n,r,i,o):wt.isFunction(e["__"+s])&&e["__"+s](t,n,r,i,o)};var s=function(e,t){(wt.isFunction(e["__"+t])||wt.isFunction(e["__"+t+"_Thumbnail"]))&&("OnImageAreaSelected"==t?e.getSWebTwain().RegisterEvent(t,e._OnImageAreaSelected):e.getSWebTwain().RegisterEvent(t,(function(n,r){return e.__OnDispatchThumbnailEvt(t,n,r)})))};e.getSourceCount=function(e){return Fn(n),wt.Promise.resolve(n.getSWebTwain().SourceCount)},e.GetSourceCountAsync=function(e){return Fn(n),wt.Promise.resolve(n.getSWebTwain().SourceCount)},e._resetErr=function(){this._errorCode=0,this._errorString="";var e=yt.DWT.licenseException;e.code=0,e.message=""},e._setConvertModeInner=function(e){if(!ji.checkProductKey(n,{Core:Kt}))return!1;var t=1*e;return n._resetErr(),isNaN(t)?(vn(n,-2314,"The parameter cannot be empty."),!1):t!=pi.CM_RENDERALL&&t!=pi.CM_IMAGEONLY&&t!=pi.CM_AUTO&&t!=pi.CM_RENDERALLWITHANNOTATION?(Cn(n),!1):(n._pdfConvertMode=t,t==pi.CM_IMAGEONLY||ji.hasPDFRProductKey(n)?n._pdfRealConvertMode=t:n._pdfRealConvertMode=pi.CM_IMAGEONLY,!0)},e._setConvertMode=function(e){return!!n._setConvertModeInner(e)&&(n.getSWebTwain().SetPDFConvertMode(n._pdfRealConvertMode),!(n._pdfRealConvertMode==pi.CM_IMAGEONLY&&n._pdfConvertMode==pi.CM_RENDERALL||n._pdfRealConvertMode==pi.CM_IMAGEONLY&&n._pdfConvertMode==pi.CM_RENDERALLWITHANNOTATION)||(Pn(n),!1))},e._axNotSupportAsync=function(e){var t=this;return Fn(t),wt.Promise.reject({code:t.ErrorCode,message:t.ErrorString})},e.ConvertToBase64=function(e,t,n,r){var i,o,a=this,s=e;s=wt.isArray(s)?s.join(","):-1;var u,c=a.getSWebTwain().SaveImagesToBase64(s,t,(function(e,t){i=e,o=t}));return co.checkErrorString(a)&&(u=new tn(null,o,i,c)),co.wrapperRet(a,[u,e,t],(function(e){n&&n(e[0],e[1],e[2])}),r,!1,!0)},e.ConvertToBlob=function(e,t,n,r){var i=this,o=e;o=wt.isArray(o)?o.join(","):-1;var a=i.getSWebTwain().SaveImagesToBytes(o,t,(function(e,t){}));return co.checkErrorString(i)&&(a=window.VBArray(a).toArray()),co.wrapperRet(i,[a,e,t],(function(e){n&&n(e[0],e[1],e[2])}),r,!1,!0)},e._checkIndices=function(e){var t,n,r=this;if(!wt.isArray(e))return vn(r,-2358,"The type of the parameter indices must be an Array."),!1;if(0==e.length)return function(e){vn(e,-2350,"The indices cannot be empty.")}(r),!1;if(yt.DWT.ConnectWithSocket)return!0;for(t=r.HowManyImagesInBuffer,n=0;n<e.length;n++){var i=e[n];if(wt.isUndefined(i)||null===i)return Ln(r),!1;if(i=parseInt(i),isNaN(i))return wn(r),!1;if(i<0||i>=t)return Dn(r),!1}return!0},e.HTTPUpload=function(e,t,n,r,i,o,a){var s=this,u=t,c=o,l=a,f=arguments;if(!s._checkIndices(t))return l(s._errorCode,s._errorString),!1;u=wt.isArray(u)?u.join(","):-1;var d=s.IfSSL,T=s.HTTPPort,h=new Kn(e),g=h.scheme,p=h.port;wt.isString(g)&&(g=g.toLowerCase()),"https"==g?(s.IfSSL=!0,s.HTTPPort=443):(s.IfSSL=!1,s.HTTPPort=80),p&&(s.HTTPPort=p);var m="RemoteFile";f.length>4&&(wt.isFunction(i)?(c=i,f.length>5&&(l=o)):wt.isString(i)&&(m=i));var _=s.getSWebTwain().HTTPUpload(h.hostname,u,h.path,m,n,r);return _=co.wrapperRet(s,_,(function(e){wt.isFunction(c)&&c(e,t,f)}),l,!0),s.IfSSL=d,s.HTTPPort=T,_},e.__innerRefreshImage=function(){var e,t=n.HowManyImagesInBuffer;t>0&&(e=n.CurrentImageIndexInBuffer,n.__OnRefreshUI&&n.__OnRefreshUI(e,t))},e.__OnBitmapChangedEx=function(t,r,i,o,a){var s=r,u=a;if(u>-1&&e._blts&&(1==s||2==s)){var c=yt.DWT.lgct(u);wt.isFunction(n.__OnLtsverify)&&n.__OnLtsverify(c,1)}if(wt.isFunction(n.__OnBitmapChanged)&&n.__OnBitmapChanged(t,r,i,o),wt.isFunction(n.__OnBufferChanged)){var l=n.CurrentImageIndexInBuffer,f={action:1==s||2==s?"add":3==s?"remove":4==s?"modify":5==s?"shift":"",currentId:l,imageIds:[],selectedIds:[]};-1!=l&&f.selectedIds.push(l),n.__OnBufferChanged(f)}},e._attachEvents=function(){var e,t=n.getSWebTwain();(e=jt(String(n.VersionInfo))).length<=2||e[0]<9||9==e[0]&&e[1]<=2||(""!=n.__OnPostTransfer&&t.RegisterEvent("OnPostTransfer",n.__OnPostTransfer),""!=n.__OnPostAllTransfers&&t.RegisterEvent("OnPostAllTransfers",n.__OnPostAllTransfers),""!=n.__OnPostLoad&&t.RegisterEvent("OnPostLoad",n.__OnPostLoad),s(n,"OnMouseClick"),s(n,"OnImageAreaSelected"),s(n,"OnTopImageInTheViewChanged"),s(n,"OnImageAreaDeSelected"),s(n,"OnMouseDoubleClick"),s(n,"OnMouseRightClick"),s(n,"OnMouseMove"),""!=n.__OnGetFilePath&&t.RegisterEvent("OnGetFilePath",n.__OnGetFilePath),""!=n.__OnAfterOperate&&t.RegisterEvent("OnAfterOperate",n.__OnAfterOperate),""!=n.__OnBeforeOperate&&t.RegisterEvent("OnBeforeOperate",n.__OnBeforeOperate),""!=n.__OnOperateStatus&&t.RegisterEvent("OnOperateStatus",n.__OnOperateStatus),t.RegisterEvent("OnBitmapChangedEx",n.__OnBitmapChangedEx),""!=n.__OnPreAllTransfers&&t.RegisterEvent("OnPreAllTransfers",n.__OnPreAllTransfers),""!=n.__OnPreTransfer&&t.RegisterEvent("OnPreTransfer",n.__OnPreTransfer),""!=n.__OnSourceUIClose&&t.RegisterEvent("OnSourceUIClose",n.__OnSourceUIClose),""!=n.__OnTransferCancelled&&t.RegisterEvent("OnTransferCancelled",n.__OnTransferCancelled),""!=n.__OnTransferError&&t.RegisterEvent("OnTransferError",n.__OnTransferError),""!=n.__OnInternetTransferPercentage&&t.RegisterEvent("OnInternetTransferPercentage",n.__OnInternetTransferPercentage),""!=n.__OnInternetTransferPercentageEx&&t.RegisterEvent("OnInternetTransferPercentageEx",n.__OnInternetTransferPercentageEx),s(n,"OnMouseWheel"),s(n,"OnKeyDown"),s(n,"OnPaintDone"))},e._isMobileMode=function(){return!1}},wt.noControl=function(e){if(yt.DWT.IfUseEmbeddedDownloadNoticeForActiveX)!function(e,t,n,r){var i,o,a=!1;e&&(wt.one(e).before(wt.install._strNonInstallDIV),(i=wt.get(wt.install._divDWTNonInstallContainerID))&&(i.style.width=t,i.style.height=n),wt.show(wt.install._divDWTNonInstallContainerID),wt.hide(e));""!=wt.install._divDWTemessageContainer&&wt.hide(wt.install._divDWTemessageContainer);if(o=Ft.getDSPath(),r){if(wt.isFunction(yt.OnWebTwainNeedUpgradeCallback)){var s={"default":o};yt.OnWebTwainNeedUpgradeCallback(wt.product.name,s,wt.product.bHTML5Edition,Rt.enumWindow,z.bIE,z.bSafari,wt.detect.ssl,ao.strIEVersion)}}else wt.isFunction(yt.OnWebTwainNotFoundOnWindowsCallback)&&yt.OnWebTwainNotFoundOnWindowsCallback(wt.product.name,o,wt.product.bHTML5Edition,z.bIE,z.bSafari,wt.detect.ssl,ao.strIEVersion,a)}(e._containerElement,e._strWidth,e._strHeight,!1);else{var t="";wt.isFunction(yt.OnWebTwainNotFoundOnWindowsCallback)&&(t=z.bIE||wt.product.bHTML5Edition?Ft.getDSPath():wt.product.getMSIPath(),yt.OnWebTwainNotFoundOnWindowsCallback(yt.DWT.ProductName,t,wt.product.bHTML5Edition,z.bIE,z.bSafari,wt.detect.ssl,ao.strIEVersion,!1))}},function(e){e.CAP_NONE=0,e.CAP_XFERCOUNT=1,e.ICAP_COMPRESSION=256,e.ICAP_PIXELTYPE=257,e.ICAP_UNITS=258,e.ICAP_XFERMECH=259,e.CAP_AUTHOR=4096,e.CAP_CAPTION=4097,e.CAP_FEEDERENABLED=4098,e.CAP_FEEDERLOADED=4099,e.CAP_TIMEDATE=4100,e.CAP_SUPPORTEDCAPS=4101,e.CAP_EXTENDEDCAPS=4102,e.CAP_AUTOFEED=4103,e.CAP_CLEARPAGE=4104,e.CAP_FEEDPAGE=4105,e.CAP_REWINDPAGE=4106,e.CAP_INDICATORS=4107,e.CAP_SUPPORTEDCAPSEXT=4108,e.CAP_PAPERDETECTABLE=4109,e.CAP_UICONTROLLABLE=4110,e.CAP_DEVICEONLINE=4111,e.CAP_AUTOSCAN=4112,e.CAP_THUMBNAILSENABLED=4113,e.CAP_DUPLEX=4114,e.CAP_DUPLEXENABLED=4115,e.CAP_ENABLEDSUIONLY=4116,e.CAP_CUSTOMDSDATA=4117,e.CAP_ENDORSER=4118,e.CAP_ALARMS=4120,e.CAP_ALARMVOLUME=4121,e.CAP_AUTOMATICCAPTURE=4122,e.CAP_TIMEBEFOREFIRSTCAPTURE=4123,e.CAP_TIMEBETWEENCAPTURES=4124,e.CAP_CLEARBUFFERS=4125,e.CAP_MAXBATCHBUFFERS=4126,e.CAP_DEVICETIMEDATE=4127,e.CAP_POWERSUPPLY=4128,e.CAP_CAMERAPREVIEWUI=4129,e.CAP_SERIALNUMBER=4132,e.CAP_PRINTER=4134,e.CAP_PRINTERENABLED=4135,e.CAP_PRINTERINDEX=4136,e.CAP_PRINTERMODE=4137,e.CAP_PRINTERSTRING=4138,e.CAP_PRINTERSUFFIX=4139,e.CAP_LANGUAGE=4140,e.CAP_FEEDERALIGNMENT=4141,e.CAP_FEEDERORDER=4142,e.CAP_REACQUIREALLOWED=4144,e.CAP_BATTERYMINUTES=4146,e.CAP_BATTERYPERCENTAGE=4147,e.CAP_CAMERASIDE=4148,e.CAP_SEGMENTED=4149,e.CAP_CAMERAENABLED=4150,e.CAP_CAMERAORDER=4151,e.CAP_MICRENABLED=4152,e.CAP_FEEDERPREP=4153,e.CAP_FEEDERPOCKET=4154,e.CAP_AUTOMATICSENSEMEDIUM=4155,e.CAP_CUSTOMINTERFACEGUID=4156,e.ICAP_AUTOBRIGHT=4352,e.ICAP_BRIGHTNESS=4353,e.ICAP_CONTRAST=4355,e.ICAP_CUSTHALFTONE=4356,e.ICAP_EXPOSURETIME=4357,e.ICAP_FILTER=4358,e.ICAP_FLASHUSED=4359,e.ICAP_GAMMA=4360,e.ICAP_HALFTONES=4361,e.ICAP_HIGHLIGHT=4362,e.ICAP_IMAGEFILEFORMAT=4364,e.ICAP_LAMPSTATE=4365,e.ICAP_LIGHTSOURCE=4366,e.ICAP_ORIENTATION=4368,e.ICAP_PHYSICALWIDTH=4369,e.ICAP_PHYSICALHEIGHT=4370,e.ICAP_SHADOW=4371,e.ICAP_FRAMES=4372,e.ICAP_XNATIVERESOLUTION=4374,e.ICAP_YNATIVERESOLUTION=4375,e.ICAP_XRESOLUTION=4376,e.ICAP_YRESOLUTION=4377,e.ICAP_MAXFRAMES=4378,e.ICAP_TILES=4379,e.ICAP_BITORDER=4380,e.ICAP_CCITTKFACTOR=4381,e.ICAP_LIGHTPATH=4382,e.ICAP_PIXELFLAVOR=4383,e.ICAP_PLANARCHUNKY=4384,e.ICAP_ROTATION=4385,e.ICAP_SUPPORTEDSIZES=4386,e.ICAP_THRESHOLD=4387,e.ICAP_XSCALING=4388,e.ICAP_YSCALING=4389,e.ICAP_BITORDERCODES=4390,e.ICAP_PIXELFLAVORCODES=4391,e.ICAP_JPEGPIXELTYPE=4392,e.ICAP_TIMEFILL=4394,e.ICAP_BITDEPTH=4395,e.ICAP_BITDEPTHREDUCTION=4396,e.ICAP_UNDEFINEDIMAGESIZE=4397,e.ICAP_EXTIMAGEINFO=4399,e.ICAP_MINIMUMHEIGHT=4400,e.ICAP_MINIMUMWIDTH=4401,e.ICAP_AUTODISCARDBLANKPAGES=4404,e.ICAP_FLIPROTATION=4406,e.ICAP_BARCODEDETECTIONENABLED=4407,e.ICAP_SUPPORTEDBARCODETYPES=4408,e.ICAP_BARCODEMAXSEARCHPRIORITIES=4409,e.ICAP_BARCODESEARCHPRIORITIES=4410,e.ICAP_BARCODESEARCHMODE=4411,e.ICAP_BARCODEMAXRETRIES=4412,e.ICAP_BARCODETIMEOUT=4413,e.ICAP_ZOOMFACTOR=4414,e.ICAP_PATCHCODEDETECTIONENABLED=4415,e.ICAP_SUPPORTEDPATCHCODETYPES=4416,e.ICAP_PATCHCODEMAXSEARCHPRIORITIES=4417,e.ICAP_PATCHCODESEARCHPRIORITIES=4418,e.ICAP_PATCHCODESEARCHMODE=4419,e.ICAP_PATCHCODEMAXRETRIES=4420,e.ICAP_PATCHCODETIMEOUT=4421,e.ICAP_FLASHUSED2=4422,e.ICAP_IMAGEFILTER=4423,e.ICAP_NOISEFILTER=4424,e.ICAP_OVERSCAN=4425,e.ICAP_AUTOMATICBORDERDETECTION=4432,e.ICAP_AUTOMATICDESKEW=4433,e.ICAP_AUTOMATICROTATE=4434,e.ICAP_JPEGQUALITY=4435,e.ICAP_FEEDERTYPE=4436,e.ICAP_ICCPROFILE=4437,e.ICAP_AUTOSIZE=4438,e.ICAP_AUTOMATICCROPUSESFRAME=4439,e.ICAP_AUTOMATICLENGTHDETECTION=4440,e.ICAP_AUTOMATICCOLORENABLED=4441,e.ICAP_AUTOMATICCOLORNONCOLORPIXELTYPE=4442,e.ICAP_COLORMANAGEMENTENABLED=4443,e.ICAP_IMAGEMERGE=4444,e.ICAP_IMAGEMERGEHEIGHTTHRESHOLD=4445,e.ICAP_SUPPORTEDEXTIMAGEINFO=4446}(lo||(lo={})),function(e){e.TWLG_DAN=0,e.TWLG_DUT=1,e.TWLG_ENG=2,e.TWLG_FCF=3,e.TWLG_FIN=4,e.TWLG_FRN=5,e.TWLG_GER=6,e.TWLG_ICE=7,e.TWLG_ITN=8,e.TWLG_NOR=9,e.TWLG_POR=10,e.TWLG_SPA=11,e.TWLG_SWE=12,e.TWLG_USA=13,e.TWLG_USERLOCALE=-1,e.TWLG_AFRIKAANS=14,e.TWLG_ALBANIA=15,e.TWLG_ARABIC=16,e.TWLG_ARABIC_ALGERIA=17,e.TWLG_ARABIC_BAHRAIN=18,e.TWLG_ARABIC_EGYPT=19,e.TWLG_ARABIC_IRAQ=20,e.TWLG_ARABIC_JORDAN=21,e.TWLG_ARABIC_KUWAIT=22,e.TWLG_ARABIC_LEBANON=23,e.TWLG_ARABIC_LIBYA=24,e.TWLG_ARABIC_MOROCCO=25,e.TWLG_ARABIC_OMAN=26,e.TWLG_ARABIC_QATAR=27,e.TWLG_ARABIC_SAUDIARABIA=28,e.TWLG_ARABIC_SYRIA=29,e.TWLG_ARABIC_TUNISIA=30,e.TWLG_ARABIC_UAE=31,e.TWLG_ARABIC_YEMEN=32,e.TWLG_BASQUE=33,e.TWLG_BYELORUSSIAN=34,e.TWLG_BULGARIAN=35,e.TWLG_CATALAN=36,e.TWLG_CHINESE=37,e.TWLG_CHINESE_HONGKONG=38,e.TWLG_CHINESE_PRC=39,e.TWLG_CHINESE_SINGAPORE=40,e.TWLG_CHINESE_SIMPLIFIED=41,e.TWLG_CHINESE_TAIWAN=42,e.TWLG_CHINESE_TRADITIONAL=43,e.TWLG_CROATIA=44,e.TWLG_CZECH=45,e.TWLG_DANISH=0,e.TWLG_DUTCH=1,e.TWLG_DUTCH_BELGIAN=46,e.TWLG_ENGLISH=2,e.TWLG_ENGLISH_AUSTRALIAN=47,e.TWLG_ENGLISH_CANADIAN=48,e.TWLG_ENGLISH_IRELAND=49,e.TWLG_ENGLISH_NEWZEALAND=50,e.TWLG_ENGLISH_SOUTHAFRICA=51,e.TWLG_ENGLISH_UK=52,e.TWLG_ENGLISH_USA=13,e.TWLG_ESTONIAN=53,e.TWLG_FAEROESE=54,e.TWLG_FARSI=55,e.TWLG_FINNISH=4,e.TWLG_FRENCH=5,e.TWLG_FRENCH_BELGIAN=56,e.TWLG_FRENCH_CANADIAN=3,e.TWLG_FRENCH_LUXEMBOURG=57,e.TWLG_FRENCH_SWISS=58,e.TWLG_GERMAN=6,e.TWLG_GERMAN_AUSTRIAN=59,e.TWLG_GERMAN_LUXEMBOURG=60,e.TWLG_GERMAN_LIECHTENSTEIN=61,e.TWLG_GERMAN_SWISS=62,e.TWLG_GREEK=63,e.TWLG_HEBREW=64,e.TWLG_HUNGARIAN=65,e.TWLG_ICELANDIC=7,e.TWLG_INDONESIAN=66,e.TWLG_ITALIAN=8,e.TWLG_ITALIAN_SWISS=67,e.TWLG_JAPANESE=68,e.TWLG_KOREAN=69,e.TWLG_KOREAN_JOHAB=70,e.TWLG_LATVIAN=71,e.TWLG_LITHUANIAN=72,e.TWLG_NORWEGIAN=9,e.TWLG_NORWEGIAN_BOKMAL=73,e.TWLG_NORWEGIAN_NYNORSK=74,e.TWLG_POLISH=75,e.TWLG_PORTUGUESE=10,e.TWLG_PORTUGUESE_BRAZIL=76,e.TWLG_ROMANIAN=77,e.TWLG_RUSSIAN=78,e.TWLG_SERBIAN_LATIN=79,e.TWLG_SLOVAK=80,e.TWLG_SLOVENIAN=81,e.TWLG_SPANISH=11,e.TWLG_SPANISH_MEXICAN=82,e.TWLG_SPANISH_MODERN=83,e.TWLG_SWEDISH=12,e.TWLG_THAI=84,e.TWLG_TURKISH=85,e.TWLG_UKRANIAN=86,e.TWLG_ASSAMESE=87,e.TWLG_BENGALI=88,e.TWLG_BIHARI=89,e.TWLG_BODO=90,e.TWLG_DOGRI=91,e.TWLG_GUJARATI=92,e.TWLG_HARYANVI=93,e.TWLG_HINDI=94,e.TWLG_KANNADA=95,e.TWLG_KASHMIRI=96,e.TWLG_MALAYALAM=97,e.TWLG_MARATHI=98,e.TWLG_MARWARI=99,e.TWLG_MEGHALAYAN=100,e.TWLG_MIZO=101,e.TWLG_NAGA=102,e.TWLG_ORISSI=103,e.TWLG_PUNJABI=104,e.TWLG_PUSHTU=105,e.TWLG_SERBIAN_CYRILLIC=106,e.TWLG_SIKKIMI=107,e.TWLG_SWEDISH_FINLAND=108,e.TWLG_TAMIL=109,e.TWLG_TELUGU=110,e.TWLG_TRIPURI=111,e.TWLG_URDU=112,e.TWLG_VIETNAMESE=113}(fo||(fo={})),function(e){e.TWSS_NONE=0,e.TWSS_A4LETTER=1,e.TWSS_B5LETTER=2,e.TWSS_USLETTER=3,e.TWSS_USLEGAL=4,e.TWSS_A5=5,e.TWSS_B4=6,e.TWSS_B6=7,e.TWSS_USLEDGER=9,e.TWSS_USEXECUTIVE=10,e.TWSS_A3=11,e.TWSS_B3=12,e.TWSS_A6=13,e.TWSS_C4=14,e.TWSS_C5=15,e.TWSS_C6=16,e.TWSS_4A0=17,e.TWSS_2A0=18,e.TWSS_A0=19,e.TWSS_A1=20,e.TWSS_A2=21,e.TWSS_A4=1,e.TWSS_A7=22,e.TWSS_A8=23,e.TWSS_A9=24,e.TWSS_A10=25,e.TWSS_ISOB0=26,e.TWSS_ISOB1=27,e.TWSS_ISOB2=28,e.TWSS_ISOB3=12,e.TWSS_ISOB4=6,e.TWSS_ISOB5=29,e.TWSS_ISOB6=7,e.TWSS_ISOB7=30,e.TWSS_ISOB8=31,e.TWSS_ISOB9=32,e.TWSS_ISOB10=33,e.TWSS_JISB0=34,e.TWSS_JISB1=35,e.TWSS_JISB2=36,e.TWSS_JISB3=37,e.TWSS_JISB4=38,e.TWSS_JISB5=2,e.TWSS_JISB6=39,e.TWSS_JISB7=40,e.TWSS_JISB8=41,e.TWSS_JISB9=42,e.TWSS_JISB10=43,e.TWSS_C0=44,e.TWSS_C1=45,e.TWSS_C2=46,e.TWSS_C3=47,e.TWSS_C7=48,e.TWSS_C8=49,e.TWSS_C9=50,e.TWSS_C10=51,e.TWSS_USSTATEMENT=52,e.TWSS_BUSINESSCARD=53,e.TWSS_MAXSIZE=54}(To||(To={})),function(e){e.TWON_NONE=0,e.TWON_ARRAY=3,e.TWON_ENUMERATION=4,e.TWON_ONEVALUE=5,e.TWON_RANGE=6}(ho||(ho={})),function(e){e.TWTY_INT8=0,e.TWTY_INT16=1,e.TWTY_INT32=2,e.TWTY_UINT8=3,e.TWTY_UINT16=4,e.TWTY_int=5,e.TWTY_BOOL=6,e.TWTY_FIX32=7,e.TWTY_FRAME=8,e.TWTY_STR32=9,e.TWTY_STR64=10,e.TWTY_STR128=11,e.TWTY_STR255=12}(go||(go={})),function(e){e.TWFA_NONE=0,e.TWFA_LEFT=1,e.TWFA_CENTER=2,e.TWFA_RIGHT=3}(po||(po={})),function(e){e.TWFO_FIRSTPAGEFIRST=0,e.TWFO_LASTPAGEFIRST=1}(mo||(mo={})),function(e){e.TWPR_IMPRINTERTOPBEFORE=0,e.TWPR_IMPRINTERTOPAFTER=1,e.TWPR_IMPRINTERBOTTOMBEFORE=2,e.TWPR_IMPRINTERBOTTOMAFTER=3,e.TWPR_ENDORSERTOPBEFORE=4,e.TWPR_ENDORSERTOPAFTER=5,e.TWPR_ENDORSERBOTTOMBEFORE=6,e.TWPR_ENDORSERBOTTOMAFTER=7}(_o||(_o={})),function(e){e.TWPM_SINGLESTRING=0,e.TWPM_MULTISTRING=1,e.TWPM_COMPOUNDSTRING=2}(So||(So={})),function(e){e.TWBR_THRESHOLD=0,e.TWBR_HALFTONE=1,e.TWBR_CUSTHALFTONE=2,e.TWBR_DIFFUSION=3}(Io||(Io={})),function(e){e.TWBO_LSBFIRST=0,e.TWBO_MSBFIRST=1}(Eo||(Eo={})),function(e){e.TWFT_RED=0,e.TWFT_GREEN=1,e.TWFT_BLUE=2,e.TWFT_NONE=3,e.TWFT_WHITE=4,e.TWFT_CYAN=5,e.TWFT_MAGENTA=6,e.TWFT_YELLOW=7,e.TWFT_BLACK=8}(vo||(vo={})),function(e){e.TWFL_NONE=0,e.TWFL_OFF=1,e.TWFL_ON=2,e.TWFL_AUTO=3,e.TWFL_REDEYE=4}(bo||(bo={})),function(e){e.TWFR_BOOK=0,e.TWFR_FANFOLD=1}(wo||(wo={})),function(e){e.TWIF_NONE=0,e.TWIF_AUTO=1,e.TWIF_LOWPASS=2,e.TWIF_BANDPASS=3,e.TWIF_HIGHPASS=4,e.TWIF_TEXT=3,e.TWIF_FINELINE=4}(Co||(Co={})),function(e){e.TWLP_REFLECTIVE=0,e.TWLP_TRANSMISSIVE=1}(Ao||(Ao={})),function(e){e.TWLS_RED=0,e.TWLS_GREEN=1,e.TWLS_BLUE=2,e.TWLS_NONE=3,e.TWLS_WHITE=4,e.TWLS_UV=5,e.TWLS_IR=6}(Wo||(Wo={})),function(e){e.TWNF_NONE=0,e.TWNF_AUTO=1,e.TWNF_LONEPIXEL=2,e.TWNF_MAJORITYRULE=3}(yo||(yo={})),function(e){e.TWOR_ROT0=0,e.TWOR_ROT90=1,e.TWOR_ROT180=2,e.TWOR_ROT270=3,e.TWOR_PORTRAIT=0,e.TWOR_LANDSCAPE=3,e.TWOR_AUTO=4,e.TWOR_AUTOTEXT=5,e.TWOR_AUTOPICTURE=6}(Po||(Po={})),function(e){e.TWOV_NONE=0,e.TWOV_AUTO=1,e.TWOV_TOPBOTTOM=2,e.TWOV_LEFTRIGHT=3,e.TWOV_ALL=4}(Do||(Do={})),function(e){e.TWPF_CHOCOLATE=0,e.TWPF_VANILLA=1}(Oo||(Oo={})),function(e){e.TWPC_CHUNKY=0,e.TWPC_PLANAR=1}(Lo||(Lo={})),function(e){e.TWAIN=0,e.ICA=3,e.SANE=3,e.TWAIN_AND_ICA=4,e.TWAIN_AND_TWAIN64=4,e.TWAIN64=5}(No||(No={})),function(e){e.url=0,e.blob=1,e.base64=2}(Ro||(Ro={})),function(e){e.IT_BMP=0,e.IT_JPG=1,e.IT_TIF=2,e.IT_PNG=3,e.IT_PDF=4,e.IT_ALL=5,e.IT_MULTIPAGE_PDF=7,e.IT_MULTIPAGE_TIF=8,e.IT_J2K=14}(xo||(xo={})),function(e){e.Info=1,e.Error=2,e.NotInstalledError=3}(Fo||(Fo={})),function(e){e.text=0,e.blob=1,e.arraybuffer=2,e.xml=3,e.json=4,e.userDefined=5}(ko||(ko={})),function(e){e.Binary=0,e.Base64=1}(Mo||(Mo={})),function(e){e.CONNECTING=0,e.OPEN=1,e.CLOSING=2,e.CLOSED=3}(Bo||(Bo={})),function(e){e.normal=0,e.balance=1}(Go||(Go={})),At.mix(yt.DWT,{EnumDWT_DeviceType:Vt,EnumDWT_Cap:lo,EnumDWT_CapLanguage:fo,EnumDWT_CapSupportedSizes:To,EnumDWT_CapType:ho,EnumDWT_CapValueType:go,EnumDWT_CapFeederAlignment:po,EnumDWT_CapFeederOrder:mo,EnumDWT_CapPrinter:_o,EnumDWT_CapPrinterMode:So,EnumDWT_CapBitdepthReduction:Io,EnumDWT_CapBitOrder:Eo,EnumDWT_CapFilterType:vo,EnumDWT_CapFlash:bo,EnumDWT_CapFlipRotation:wo,EnumDWT_CapImageFilter:Co,EnumDWT_CapLightPath:Ao,EnumDWT_CapLightSource:Wo,EnumDWT_CapNoiseFilter:yo,EnumDWT_CapORientation:Po,EnumDWT_CapOverscan:Do,EnumDWT_CapPixelFlavor:Oo,EnumDWT_CapPlanarChunky:Lo,EnumDWT_ImageType:xo,EnumDWT_ImageFormatType:Ro,EnumDWT_ResponseType:ko,EnumDWT_SourceMatchField:en,EnumDWT_UploadDataFormat:Mo,EnumDWT_WorkMode:Go,EnumDWT_ConvertMode:pi});var Uo,Ho,jo,Vo,Xo,Ko=yt.DWT;function zo(e){var t=this;t._stwain=e,wt.attachAxViewerPropertyUI(t),wt.attachAxViewerFunctions(t),t._thumbnailViewer=null}Ko.EnumPDF_Page={Page_Default:0,Page_Custom:1,Page_A4:2,Page_A4_Reverse:3,Page_A3:4,Page_A3_Reverse:5,Page_Letter:6,Page_Letter_Reverse:7,Page_Legal:8,Page_Legal_Reverse:9},Ko.EnumDWT_PixelType={TWPT_BW:0,TWPT_GRAY:1,TWPT_RGB:2,TWPT_PALLETE:3,TWPT_CMY:4,TWPT_CMYK:5,TWPT_YUV:6,TWPT_YUVK:7,TWPT_CIEXYZ:8,TWPT_LAB:9,TWPT_SRGB:10,TWPT_SCRGB:11,TWPT_INFRARED:16},Ko.EnumDWT_BorderStyle={TWBS_NONE:0,TWBS_SINGLEFLAT:1,TWBS_SINGLE3D:2},Ko.EnumDWT_MessageType={TWQC_GET:1,TWQC_SET:2,TWQC_GETDEFAULT:4,TWQC_GETCURRENT:8,TWQC_RESET:16},Ko.EnumDWT_TransferMode={TWSX_NATIVE:0,TWSX_FILE:1,TWSX_MEMORY:2},Ko.EnumDWT_FileFormat={TWFF_TIFF:0,TWFF_PICT:1,TWFF_BMP:2,TWFF_XBM:3,TWFF_JFIF:4,TWFF_FPX:5,TWFF_TIFFMULTI:6,TWFF_PNG:7,TWFF_SPIFF:8,TWFF_EXIF:9,TWFF_PDF:10,TWFF_JP2:11,TWFF_JPN:12,TWFF_JPX:13,TWFF_DEJAVU:14,TWFF_PDFA:15,TWFF_PDFA2:16},Ko.EnumDWT_TIFFCompressionType={TIFF_AUTO:0,TIFF_NONE:1,TIFF_RLE:2,TIFF_FAX3:3,TIFF_T4:3,TIFF_FAX4:4,TIFF_T6:4,TIFF_LZW:5,TIFF_JPEG:7,TIFF_PACKBITS:32773},Ko.EnumDWT_InterpolationMethod={IM_NEARESTNEIGHBOUR:1,IM_BILINEAR:2,IM_BICUBIC:3,IM_BESTQUALITY:5},Ko.EnumDWT_PDFCompressionType={PDF_AUTO:0,PDF_FAX3:1,PDF_FAX4:2,PDF_LZW:3,PDF_RLE:4,PDF_JPEG:5,PDF_JP2000:6,PDF_JBIG2:7},Ko.EnumDWT_ShowMode={SW_ACTIVE:0,SW_MAX:1,SW_MIN:2,SW_CLOSE:3,SW_IFLIVE:4},Ko.EnumDWT_UnitType={TWUN_INCHES:0,TWUN_CENTIMETERS:1,TWUN_PICAS:2,TWUN_POINTS:3,TWUN_TWIPS:4,TWUN_PIXELS:5,TWUN_MILLIMETERS:6},Ko.EnumDWT_DUPLEX={TWDX_NONE:0,TWDX_1PASSDUPLEX:1,TWDX_2PASSDUPLEX:2},Ko.EnumDWT_MagType={TWMD_MICR:0,TWMD_RAW:1,TWMD_INVALID:2},Ko.EnumDWT_DataSourceStatus={TWDSS_CLOSED:0,TWDSS_OPENED:1,TWDSS_ENABLED:2,TWDSS_ACQUIRING:3},function(e){e.enumFitWindow=0,e.enumFitWindowHeight=1,e.enumFitWindowWidth=2}(Uo||(Uo={})),Ko.EnumDWT_FitWindowType={enumFitWindow:Uo.enumFitWindow,enumFitWindowHeight:Uo.enumFitWindowHeight,enumFitWindowWidth:Uo.enumFitWindowWidth},Ko.EnumDWT_PlatformType={enumUnknown:Rt.enumUnknown,enumWindow:Rt.enumWindow,enumMac:Rt.enumMac,enumLinux:Rt.enumLinux,enumEmbed:Rt.enumEmbed,enumChromeOS:Rt.enumChromeOS,enumHarmonyOS:Rt.enumHarmonyOS,enumAndroid:Rt.enumAndroid,enumiOS:Rt.enumiOS},function(e){e.Default=0,e.Hand=1,e.Crosshair=2,e.Zoom=3,e.NWResize=4,e.EResize=5,e.NResize=6,e.Resize=7,e.Move=8}(Ho||(Ho={})),Ko.EnumDWT_MouseShape={Default:Ho.Default,Hand:Ho.Hand,Crosshair:Ho.Crosshair,Zoom:Ho.Zoom,NWResize:Ho.NWResize,EResize:Ho.EResize,NResize:Ho.NResize,Resize:Ho.Resize,Move:Ho.Move},Ko.EnumDWT_Language={English:0,French:1,Arabic:2,Spanish:3,Portuguese:4,German:5,Italian:6,Russian:7,Chinese:8},Ko.EnumDWT_InitMsg={Info:Fo.Info,Error:Fo.Error,NotInstalledError:Fo.NotInstalledError},Ko.EnumDWT_Driver={TWAIN:No.TWAIN,ICA:No.ICA,SANE:No.SANE,TWAIN_AND_ICA:No.TWAIN_AND_ICA,TWAIN_AND_TWAIN64:No.TWAIN_AND_TWAIN64,TWAIN64:No.TWAIN64},Ko.EnumDWT_CompressionType={TWCP_NONE:0,TWCP_PACKBITS:1,TWCP_GROUP31D:2,TWCP_GROUP31DEOL:3,TWCP_GROUP32D:4,TWCP_GROUP4:5,TWCP_JPEG:6,TWCP_LZW:7,TWCP_JBIG:8,TWCP_PNG:9,TWCP_RLE4:10,TWCP_RLE8:11,TWCP_BITFIELDS:12,TWCP_ZIP:13,TWCP_JPEG2000:14},function(e){e.Single=0,e.Multiple=1}(jo||(jo={})),Ko.EnumDWT_SelectionMode={Single:jo.Single,Multiple:jo.Multiple},Ko.EnumDWT_ConfirmExitType={Cancel:0,Exit:1,SaveAndExit:2},Ko.EnumDWT_WebsocketReadyState={CONNECTING:Bo.CONNECTING,OPEN:Bo.OPEN,CLOSING:Bo.CLOSING,CLOSED:Bo.CLOSED},function(e){e.TwainService=1}(Vo||(Vo={})),Ko.EnumDWT_ServiceType={TwainService:Vo.TwainService},function(e){e["default"]=0,e.standard=1,e.supported=2}(Xo||(Xo={})),Ko.EnumDWT_ExtImageInfo={"default":Xo["default"],standard:Xo.standard,supported:Xo.supported},wt.attachAxViewerPropertyUI=function(e){var t=function(t,n){t in e||Object.defineProperty(e,t,n)};t("width",{get:function(){return e._stwain.Width},set:function(t){return e._stwain.Width=t,wt.checkErrorString(e._stwain)}}),t("height",{get:function(){return e._stwain.Height},set:function(t){return e._stwain.Height=t,wt.checkErrorString(e._stwain)}}),t("background",{get:function(){return e._stwain.BackgroundColor},set:function(t){return e._stwain.BackgroundColor=t,t}}),t("cursor",{get:function(){return e._stwain.MouseShape?"pointer":"crosshair"},set:function(t){return e._stwain.MouseShape="pointer"==t,t}}),t("showPageNumber",{get:function(){return!1},set:function(e){return!1}}),t("ifAutoScroll",{get:function(){return e._stwain.IfAutoScroll},set:function(t){return e._stwain.IfAutoScroll=t,t}}),t("pageMargin",{get:function(){return e._stwain.ImageMargin},set:function(t){return e._stwain.ImageMargin=t,t}}),t("zoom",{get:function(){return e._stwain.Zoom},set:function(t){return e._stwain.Zoom=t,t}})},wt.attachAxViewerFunctions=function(e){e.next=function(){return this._stwain.next()},e.previous=function(){return this._stwain.previous()},e.first=function(){return this._stwain.first()},e.last=function(){return this._stwain.last()},e.gotoPage=function(e){var t=this,n=1*e;return wt.isNaN(n)||!wt.isNumber(n)?(wn(t._stwain),!1):n<0||n>=t._stwain.HowManyImagesInBuffer?(On(t._stwain),!1):(t._stwain.CurrentImageIndexInBuffer=n,n)},e.setSelectedAreas=function(e){return this._stwain.SetSelectedImageArea(this._stwain.CurrentImageIndexInBuffer,e.left,e.top,e.right,e.bottom)},e.fitWindow=function(e){var t=this;return"height"==e?(t._stwain.IfFitWindow=!0,t._stwain.FitWindowType=Uo.enumFitWindowHeight):"width"==e?(t._stwain.IfFitWindow=!0,t._stwain.FitWindowType=Uo.enumFitWindowWidth):(t._stwain.IfFitWindow=!0,t._stwain.FitWindowType=Uo.enumFitWindow),!0},e.setViewMode=function(e,t){return this._stwain.SetViewMode(e,t)},e.createImageEditor=function(){return this._stwain},e.on=function(e,t){var n,r=this;return""!=(n=r._convertEvtName(e))&&("OnImageAreaSelected"==n?(r.OnImageAreaSelected=function(e,n,r,i,o){t(e,[{x:n,y:r,width:i-n,height:o-r}])},r._stwain.RegisterEvent(n,r.OnImageAreaSelected)):r._stwain.RegisterEvent(n,t))},e.off=function(e,t){var n;return""!=(n=this._convertEvtName(e))&&this._stwain.UnregisterEvent(n,(function(){}))},e.createThumbnailViewer=function(e){var t=this;if(t._thumbnailViewer)vn(t._stwain,-2501,"A ThumbnailViewer already exists.");else{var n=new wt.UI.ThumbnailViewer(t._stwain,e);t._thumbnailViewer=n.getInstance()}return t._thumbnailViewer},e._convertEvtName=function(e){if(!wt.isString(e))return"";var t=wt.trim(e).toLowerCase();return"toppagechanged"==t?"OnTopImageInTheViewChanged":"click"==t?"OnMouseClick":"dblclick"==t?"OnMouseDoubleClick":"mousemove"==t?"OnMouseMove":"rightclick"==t?"OnMouseRightClick":"wheel"==t?"OnMouseWheel":"keydown"==t?"OnKeyDown":"pageareaselected"==t?"OnImageAreaSelected":"pageareaunselected"==t?"OnImageAreaDeSelected":wt.trim(e)}},zo.prototype.getInstance=function(){return this};var Jo={showThumbnail:!1,location:"horizontal",sequence:-1,size:"30%",columns:1,rows:3,scrollDirection:"vertical",pageMargin:10,border:"",allowKeyboardControl:!0,allowPageDragging:!0,allowResizing:!1,pageBackground:"transparent",pageBorder:"1px solid rgb(238, 238, 238)",hoverPageBackground:"rgb(239, 246, 253)",hoverPageBorder:"1px solid rgb(238, 238, 238)",placeholderBackground:"rgb(251, 236, 136)",autoChangeIndex:!1};function Yo(e,t){var n=this,r=t;if(r){if(r.location)switch(r.location){case"left":default:r.location="horizontal",r.sequence=-1;break;case"right":r.location="horizontal",r.sequence=1;break;case"top":r.location="vertical",r.sequence=-1;break;case"bottom":r.location="vertical",r.sequence=1}else r.location="horizontal",r.sequence=-1;wt.isUndefined(r.size)&&(r.size=Jo.size),wt.isUndefined(r.columns)&&(r.columns=Jo.columns),wt.isUndefined(r.rows)&&(r.rows=Jo.rows),(wt.isUndefined(r.scrollDirection)||"horizontal"!=r.scrollDirection)&&(r.scrollDirection=Jo.scrollDirection),wt.isUndefined(r.pageMargin)&&(r.pageMargin=Jo.pageMargin),wt.isUndefined(r.allowKeyboardControl)&&(r.allowKeyboardControl=Jo.allowKeyboardControl),wt.isUndefined(r.allowPageDragging)&&(r.allowPageDragging=Jo.allowPageDragging),wt.isUndefined(r.allowResizing)&&(r.allowResizing=Jo.allowResizing),wt.isUndefined(r.border)&&(r.border=Jo.border),wt.isUndefined(r.pageBackground)&&(r.pageBackground=Jo.pageBackground),wt.isUndefined(r.pageBorder)&&(r.pageBorder=Jo.pageBorder),wt.isUndefined(r.hoverPageBackground)&&(r.hoverPageBackground=Jo.hoverPageBackground),wt.isUndefined(r.hoverPageBorder)&&(r.hoverPageBorder=Jo.hoverPageBorder),wt.isUndefined(r.placeholderBackground)&&(r.placeholderBackground=Jo.placeholderBackground),wt.isUndefined(r.autoChangeIndex)&&(r.autoChangeIndex=Jo.autoChangeIndex)}else r=Jo;n._stwain=e,n._settings=r,wt.attachViewerPropertyThumbnailUI(n),wt.attachViewerFunctionsThumbnailUI(n),e.getSWebTwain().SetViewMode(-1,-1),e.getSWebTwain().ShowThumbnail(wt.stringify(r))}Yo.prototype.getInstance=function(){return this},wt.attachViewerFunctionsThumbnailUI=function(e){e.show=function(){e._stwain?(e._stwain.getSWebTwain().SetViewMode(-1,-1),e._stwain.getSWebTwain().ShowThumbnail('{"mode":"show"}')):kn(e._stwain)},e.hide=function(){e._stwain?e._stwain.getSWebTwain().ShowThumbnail('{"mode":"hide"}'):kn(e._stwain)},e.dispose=function(){e.hide(),e._stwain=null},e.updateViewMode=function(t){if(e._stwain){if(t&&t.columns&&t.rows){if(t.columns<0||t.rows<0)return vn(e._stwain,-2514,"Invalid property value."),!1;e._stwain.getSWebTwain().ShowThumbnail('{"columns":'+t.columns+',"rows":'+t.rows+"}")}}else kn(e._stwain)},e.on=function(t,n){var r=t,i=!1;wt.isFunction(n)&&("click"==r&&(r="OnMouseClick"),"rightclick"==r&&(r="OnMouseRightClick"),"dblclick"==r&&(r="OnMouseDoubleClick"),"mousemove"==r&&(r="OnMouseMove"),"wheel"==r&&(r="OnMouseWheel"),"keydown"==r&&(r="OnKeyDown"),"toppagechanged"==r&&(r="OnTopImageInTheViewChanged"),"pageareaselected"==r&&(r="OnImageAreaSelected"),"pageareaunselected"==r&&(r="OnImageAreaDeSelected"),"OnMouseClick"==r||"OnMouseDoubleClick"==r||"OnMouseRightClick"==r||"OnMouseMove"==r||"OnMouseWheel"==r||"OnKeyDown"==r||"OnPaintDone"==r||"OnImageAreaDeSelected"==r||"OnTopImageInTheViewChanged"==r?(wt.isFunction(e._stwain["__"+r])||wt.isFunction(e._stwain["__"+r+"_Thumbnail"])||(i=!0),e._stwain["__"+r+"_Thumbnail"]=n,i&&e._stwain.getSWebTwain().RegisterEvent(r,(function(t,n){return e._stwain.__OnDispatchThumbnailEvt(r,t,n)}))):"OnImageAreaSelected"==r&&(wt.isFunction(e._stwain["__"+r])||wt.isFunction(e._stwain["__"+r+"_Thumbnail"])||(i=!0),e._stwain["__"+r+"_Thumbnail"]=n,i&&e._stwain.getSWebTwain().RegisterEvent(r,e._stwain._OnImageAreaSelected)))},e.off=function(t,n){e._stwain["__"+t+"_Thumbnail"]=""}},wt.attachViewerPropertyThumbnailUI=function(e){var t=function(t,n){t in e||Object.defineProperty(e,t,n)};t("location",{get:function(){return e._settings.location},set:function(t){e._settings.location=t,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"location":"'+t+'"}')}}),t("size",{get:function(){return e._settings.size},set:function(t){e._settings.size=t,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"size":"'+t+'"}')}}),t("pageMargin",{get:function(){return e._settings.pageMargin},set:function(t){e._settings.pageMargin=t,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"pageMargin":"'+t+'"}')}}),t("background",{get:function(){return e._settings.background},set:function(t){e._settings.background=t,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"background":"'+t+'"}')}}),t("pageBackground",{get:function(){return e._settings.pageBackground},set:function(t){e._settings.pageBackground=t,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"pageBackground":"'+t+'"}')}}),t("selectedPageBorder",{get:function(){return e._settings.selectedPageBorder},set:function(t){e._settings.selectedPageBorder=t,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"selectedPageBorder":"'+t+'"}')}}),t("selectedPageBackground",{get:function(){return e._settings.selectedPageBackground},set:function(t){e._settings.selectedPageBackground=t,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"selectedPageBackground":"'+t+'"}')}}),t("scrollDirection",{get:function(){return e._settings.scrollDirection},set:function(t){e._settings.scrollDirection=t,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"scrollDirection":"'+t+'"}')}}),t("showPageNumber",{get:function(){return e._settings.showPageNumber},set:function(t){e._settings.showPageNumber=t,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"showPageNumber":"'+t+'"}')}}),t("border",{get:function(){return e._settings.border},set:function(t){e._settings.border=t,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"border":"'+t+'"}')}}),t("pageBorder",{get:function(){return e._settings.pageBorder},set:function(t){e._settings.pageBorder=t,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"pageBorder":"'+t+'"}')}}),t("hoverPageBackground",{get:function(){return e._settings.hoverPageBackground},set:function(t){e._settings.hoverPageBackground=t,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"hoverPageBackground":"'+t+'"}')}}),t("hoverPageBorder",{get:function(){return e._settings.hoverPageBorder},set:function(t){e._settings.hoverPageBorder=t,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"hoverPageBorder":"'+t+'"}')}}),t("placeholderBackground",{get:function(){return e._settings.placeholderBackground},set:function(t){e._settings.placeholderBackground=t,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"placeholderBackground":"'+t+'"}')}}),t("allowKeyboardControl",{get:function(){return e._settings.allowKeyboardControl},set:function(t){e._settings.allowKeyboardControl=t,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"allowKeyboardControl":"'+t+'"}')}}),t("allowPageDragging",{get:function(){return e._settings.allowPageDragging},set:function(t){e._settings.allowPageDragging=t,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"allowPageDragging":"'+t+'"}')}}),t("allowResizing",{get:function(){return e._settings.allowResizing},set:function(t){e._settings.allowResizing=t,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"allowResizing":"'+t+'"}')}}),t("autoChangeIndex",{get:function(){return e._settings.autoChangeIndex},set:function(t){e._settings.autoChangeIndex=t,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"autoChangeIndex":"'+t+'"}')}})},wt.UI=wt.UI||{},wt.UI.DWTAxViewer=zo,wt.UI.ThumbnailViewer=Yo;var qo=At.isString,Qo=At.isArray,Zo=At.each;function $o(e,t){if(qo(t))e.push('"'),e.push(t),e.push('"');else if(Qo(t)){var n=Kt;e.push("["),Zo(t,(function(t){n?n=Xt:e.push(","),$o(e,t)})),e.push("]")}else t===undefined?e.push('""'):e.push(t)}var ea=1;var ta=function(){function e(t,n){d(this,e),nn(this,"m_server",""),nn(this,"m_iUsingTime",0),nn(this,"m_countMap",{}),nn(this,"m_newConsum",!1),nn(this,"m_mapSavedToDb",!1),this.clearData(),this.m_enumInstance=t,t==yt.DWT.EnumInstance.dwt_desktop?(this.m_deploymentType="desktop",this.m_server=n):t==yt.DWT.EnumInstance.dbr&&(this.m_deploymentType="browser",this.m_server="")}return g(e,[{key:"clearData",value:function(){this.m_iUsingTime=0,this.m_jvUsingTime=At.nil,this.m_countMap={},this.m_newConsum=!1,this.m_mapSavedToDb=!1,this.m_minExpiredTime=At.nil,this.m_maxExpiredTime=At.nil,this.m_cu=At.nil,this.m_ar=At.nil,this.m_ltsInstance=At.nil}},{key:"set_cu",value:function(e){this.m_cu=e}},{key:"get_cu",value:function(){return this.m_cu}},{key:"set_ar",value:function(e){this.m_ar=e}},{key:"get_ar",value:function(){return this.m_ar}},{key:"get_ltsInstance",value:function(e){return this.m_ltsInstance||(this.m_ltsInstance=e(this.m_enumInstance)),this.m_ltsInstance}},{key:"inited_ltsInstance",value:function(){return!!this.m_ltsInstance}},{key:"set_maxExpiredTime",value:function(e){this.m_maxExpiredTime=e}},{key:"get_maxExpiredTime",value:function(){return this.m_maxExpiredTime}},{key:"set_minExpiredTime",value:function(e){this.m_minExpiredTime=e}},{key:"get_minExpiredTime",value:function(){return this.m_minExpiredTime}},{key:"get_deploymentType",value:function(){return this.m_deploymentType}},{key:"get_enumDeploymentType",value:function(){return this.m_enumInstance}}]),e}();var na=yt.DWT;na.LTS=na.LTS||{},na.licenseException={code:0,message:"",fromLTS:!1},na.bLTSOnline=!0,na.axInstance=undefined,na.lOnUpdateDWObj=[],na.EnumInstance={dwt_desktop:0,dwt_browser:1,dbr:2};var ra,ia,oa,aa=0,sa={},ua=!1,ca=!1,la=!1,fa=!1,da=!1;function Ta(){var e=Ht.handshakeCode;return At.isString(e)||(e=""),e}function ha(){var e=Ht.organizationID;return At.isNumber(e)?e=""+e:At.isString(e)||(e=""),e}function ga(){return At.replaceAll(xt.JSVersion,",",".")}function pa(e,t){var n=e;return n===At.nil&&(n=na.EnumInstance.dwt_desktop),n==na.EnumInstance.dbr?(oa||(oa=new ta(n,"")),oa):(ia||(ia=new ta(n,"")),ia)}na.lupverfy=function(){pa(na.EnumInstance.dwt_desktop).get_ltsInstance(Sa),pa(na.EnumInstance.dbr).get_ltsInstance(Sa)},na.lsmid=function(e,t){pa(na.EnumInstance.dwt_desktop).set_cu(e)},na.lsar=function(e,t){pa(na.EnumInstance.dwt_desktop).set_ar(e)},na.lsmid2b=function(e){pa(na.EnumInstance.dwt_desktop).set_cu(e)},na.lgar=function(e,t){pa(e).get_ar()},na.laddDWTObj=function(e){var t=!1;At.each(na.lOnUpdateDWObj,(function(n){if(n==e)return t=!0,!1})),t||na.lOnUpdateDWObj.push(e)},na.lremoveDWTObj=function(e){At.each(na.lOnUpdateDWObj,(function(t,n){if(t==e)return na.lOnUpdateDWObj.splice(n,1),!1}))},na.lsendUpdateEvt=function(e,t){var n=[];if(At.each(na.lOnUpdateDWObj,(function(t){e==na.EnumInstance.dwt_desktop&&n.push(t)})),0==n.length)return wt.Promise.resolve();var r,i=n[0];return i._bAx?(At.each(n,(function(t){t.SetLTSInfo(pa(e).get_ar(),pa(e).get_cu())})),i.GetLicenseInfo().then((function(n){n&&At.isArray(n.Detail)&&n.Detail.length>0&&na.lsexp(e,n.Detail[0].ExpireDate,t)}))):(r=i.SetLTSLicenseAsync(pa(e).get_ar()).then((function(n){n&&At.isArray(n.Detail)&&n.Detail.length>0&&na.lsexp(e,n.Detail[0].ExpireDate,t)})),At.each(n,(function(t,n){0!=n&&t.SetLTSLicenseAsync(pa(e).get_ar())})),r)},na.lgcb=function(){var e=[];return z.bChrome?e.push("Chrome"):z.bFirefox?e.push("Firefox"):z.bEdge?e.push("Edge"):z.bIE?e.push("IE"):z.bSafari?e.push("Safari"):z.bOpera?e.push("Opera"):z.b360SE?e.push("360SE"):z.bTencentTraveler?e.push("TencentTraveler"):z.bMaxthon?e.push("Maxthon"):z.bMetaSr?e.push("MetaSr"):z.bTheWorld?e.push("TheWorld"):z.bUC?e.push("UC"):z.bHuaWeiBrowser&&e.push("HuaWeiBrowser"),e.push(z.strBrowserVersion),z.bWin?e.push("Windows"):z.bMac?e.push("Mac"):z.bLinux?e.push("Linux"):z.bAndroid?e.push("Android"):z.bChromeOS?e.push("ChromeOS"):z.bHarmonyOS?e.push("HarmonyOS"):ao.bMobile?e.push("Mobile OS"):yt.navInfo.bEmbed&&e.push("Embed OS"),e.join(" ")};var ma,_a={NetworkError:-2440,Timedout:-2441,JsonError:-2442,CorsError:-2443,Expired:-2445,LtsJsLoadError:-2446,UUIDError:-2447};function Sa(e){var t,n,r=Ht.licenseServer;if(r&&r.length>0)for(t=0;t<r.length;t++)n=r[t],At.endsWith(n,"/")||(r[t]=n+"/");var i={dm:location.origin?At.startsWith(location.origin,"http")?location.origin:"https://localhost":At.startsWith(location.href,"http")?location.href:"https://localhost",lf:wt.localforage,btoa:At.btoa,atob:At.atob,sutlcb:function(){At.isFunction(na.lonsend)&&na.lonsend()},fol:na.OnFirstOffline,dwt:!0};if(e==na.EnumInstance.dwt_browser||e==na.EnumInstance.dbr?i.feab=na.lfeab_wasm:i.feab=na.lfeab_ax,!z.bIE&&Ht.ltsDebug&&(i.debugLog=console.log),yt.LTS&&yt.LTS._)return yt.LTS._.createLtsInstance(i);var o={},a=function(){return wt.Promise.reject({code:_a.LtsJsLoadError,message:"The dynamsoft.lts.js load failed."})};return o.i=a,o.s=a,o.u=a,o.caret=a,o}function Ia(e,t){var n=null!=t?t:"",r=pa(e),i=r.get_enumDeploymentType();if(na.lclex(),r.get_ar()&&r.get_cu())return wt.Promise.resolve({ar:r.get_ar(),cu:r.get_cu()});var o={pd:na.lgpd(e),v:ga(),os:na.lgcb(),fn:na.DeviceFriendlyName||"",ls:Ht.licenseServer,sp:Ht.sessionPassword,l:ji.getLTSLicense(),mnet:function(){return r.get_maxExpiredTime()},mxet:function(){return r.get_minExpiredTime()},fol:na.OnFirstOffline};return o.dt=r.get_deploymentType(),i==na.EnumInstance.dwt_desktop?o.lsu=r.get_cu():i==na.EnumInstance.dbr||(o.dwt=!0,""!=r.get_cu()&&(o.lsu=r.get_cu()),o.updateLicense=function(e){r.set_ar(e.ar),r.get_cu()||r.set_cu(e.cu),na.lsendUpdateEvt(i,n)}),r.get_ltsInstance(Sa).i(o).then((function(e){return r.get_ar()||r.set_ar(e.ar),r.get_cu()||r.set_cu(e.cu),e}))}function Ea(){return Date.now()}function va(e){var t=e?new Date(e):new Date,n="yyyy-MM-ddTHH:mm:ss.SSSZ",r={"M+":t.getUTCMonth()+1,"d+":t.getUTCDate(),"H+":t.getUTCHours(),"h+":t.getUTCHours()%12||12,"m+":t.getUTCMinutes(),"s+":t.getUTCSeconds(),"q+":Math.floor((t.getUTCMonth()+3)/3),"S+":t.getUTCMilliseconds()};for(var i in/(y+)/.test(n)&&(n=n.replace(RegExp.$1,(t.getUTCFullYear()+"").substr(4-RegExp.$1.length))),r)new RegExp("("+i+")").test(n)&&(n=n.replace(RegExp.$1,1==RegExp.$1.length?r[i]:("000"+r[i]).substr(("000"+r[i]).length-RegExp.$1.length)));return n}function ba(e){var t=this,n=e||{};t._id=n.id,t._containerID=(n.container?n.container.id:n.containerId)||"dwtcontrolContainer",t._containerElement=wt.get(t._containerID),t._strWidth=n.width||270,t._strHeight=n.height||350,wt.isString(t._strWidth)&&t._strWidth.indexOf("%")>0||(t._strWidth=[parseInt(t._strWidth),"px"].join("")),wt.isString(t._strHeight)&&t._strHeight.indexOf("%")>0||(t._strHeight=[parseInt(t._strHeight),"px"].join("")),t._strObjectName=t._containerID+"_Obj",function(e,t){t&&wt.each(["onAfterOperate","onBeforeOperate","onOperateStatus","onBitmapChanged","onGetFilePath","onImageAreaDeSelected","onImageAreaSelected","onMouseClick","onMouseDoubleClick","onMouseMove","onMouseRightClick","onPreAllTransfers","onPreTransfer","onPostLoad","onPostTransfer","onPostTransferAsync","onPreAllTransfersAsync","onPostAllTransfers","onSourceUIClose","onTopImageInTheViewChanged","onTransferCancelled","onTransferError","onInternetTransferPercentage","onInternetTransferPercentageEx","onRemoteScanStatusAsync","onKeyDown","onMouseWheel"],(function(n){e["__O"+n.substring(1)]=t[n]||""}))}(t,n),t.__OnAxReady=n.onAxReady,t.__OnAxNotInstalled=n.onAxNotInstalled,t.__OnRefreshUI=n.onRefreshUI||"",t._objectWebTwain=null,t._strDWTInnerContainerID=t._containerID+"_CID",t._strDWTNonInstallInnerContainerID=t._containerID+"_NonInstallCID",t.Addon={},t._pdfConvertMode=3,t._pdfRealConvertMode=3,t._bAx=!0,wt.UI.DWTAxViewer&&(t.Viewer=new wt.UI.DWTAxViewer(t))}function wa(e){return e&&!At.isString(e)?Kt:Xt}na.lgpd=function(e){return z.bWin&&e==na.EnumInstance.dwt_desktop?"dwt|dbr":"dwt"},na.lglic=Ia,na.lgbuuid=function(){return""},na.lshow=function(){return{t:ra,t2:aa,m:At.stringify(sa)}},na.lgct=function(e){switch(e){case 0:return"3011";case 1:return"3012";case 2:return"3014";case 3:return"3013";case 4:return"3015";case 14:return"3016";case 3001:return"3001";case 3002:return"3002";case 3003:return"3003";case 3004:return"3004";case 3005:return"3005";case 3006:return"3006";case 3007:return"3007";case 3008:return"3008";case 3009:return"3009";case 5001:return"5001";case 4001:return"4001";case 4002:return"4002";case 4003:return"4003"}return""},na.lcvrf=function(e){e&&setTimeout((function(){na.lcvrf_(e)}),1)},na.lcvrf_=function(e){var t;t=na.EnumInstance.dwt_desktop;var n,r=na.DeviceFriendlyName||"",i=na.lgcb(),o=pa(t),a={hs:Ta(),og:ha(),cu:o.get_cu(),fn:r,cw:"",os:i,v:ga(),dt:o.get_deploymentType(),ed:"js"},s=function(e,t){var n,r,i=0;if(At.isString(e)&&""!=e&&"{}"!=e&&t&&At.isArray(t)&&!(t.length<1)){if(r=pa(t[0]),n=At.parse(e),na.lclex(),0==aa){var o=Ea(),a="";aa=o,ra=va(o),sa={},i=0,At.each(n,(function(e,t){(t<i||0==i)&&(i=t,a=e)})),i>0&&r.get_ltsInstance(Sa).s(Ht.licenseServer,a,i,!0).then((function(){}),(function(e){}))}At.each(n,(function(e,t){var n=!1,o=parseInt(t);o>0&&o!=i&&(o+18e4<Ea()&&(n=!0),r.get_ltsInstance(Sa).s(Ht.licenseServer,e,t,n).then((function(){}),(function(e){})))}))}};if(a.pd=na.lgpd(t),n=At.stringify(a),!e._bAx){var u="GetBuffer",c=function(){for(var e=[],t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];if(n.length>0)if(1===n.length){var i=n[0];e.push("["),$o(e,i),e.push("]")}else if(2===n.length){var o=n[0],a=n[1];e.push("["),$o(e,o),e.push(","),$o(e,a),e.push("]")}else $o(e,Array.prototype.slice.call(n));return e.join("")}(At.replaceAll(n,'"','\\"')),l={cmd:u,cmdId:(++ea).toString(),sFun:s,fFun:function(){},params:[t]};return e._innerSendByWS(u,c,l,null,!0)}s(e.GetBuffer(n),[t,""])},na.lavrf=function(e,t,n,r){var i=1;if(""!=e){t>1&&(i=t);var o=Ea();if(aa>0&&aa+18e4<o){ca?(sa={},na.lavrf__unload()):na.lavrf__(!0,n,r);var a=Ea()+1;aa=a,ra=va(a),sa={}}ua=!0,ca=!1,sa[e]?sa[e]+=i:sa[e]=i,0==aa&&na.lavrf__(!0,n,r)}},na.lavrf_=function(e,t,n){if(ua){var r=1;e&&(r=e),setTimeout((function(){na.lavrf__(!1,t,n)}),r)}},na.lavrf__=function(e,t,n){var r,i,o,a=Ea(),s=!1,u=!!e,c=0,l=t;At.isUndefined(l)&&(l=na.EnumInstance.dwt_desktop),o=pa(l),ua=!1,0==aa&&(s=!0,aa=a,ra=va(a)),r=aa,i=ra;var f={};f.ut=i;var d={};if(At.each(sa,(function(e,t){d[t]=e,e>0&&c++})),f.cts=d,u||r+18e4<a){u=!0;var T=Ea()+1;if(aa=T,ra=va(T),sa={},ca=!1,0==c)return}else{if(0==c)return;ca=!0}f.dur=s?1:180;var h,g=na.DeviceFriendlyName||"",p=na.lgcb(),m={hs:Ta(),og:ha(),cu:o.get_cu(),fn:g,cw:"",os:p,v:ga(),dt:o.get_deploymentType(),ed:"js",rcs:[f]};m.product=na.lgpd(t),h=At.stringify(m),Ht.ltsDebug&&va(),na.lclex(),o.get_ltsInstance(Sa).s(Ht.licenseServer,h,""+r,u).then((function(){}),(function(e){}))},na.lavrf__unload=function(){var e,t=Ea(),n=pa(na.EnumInstance.dwt_desktop),r=pa(na.EnumInstance.dbr);ua=!1,0==aa&&(aa=t,ra=va(t)),e=aa;var i=Ea()+1;aa=i,ra=va(i),sa={},ca=!1,e+=1,na.lclex(),n.inited_ltsInstance()&&n.get_ltsInstance(Sa).s(Ht.licenseServer,false,""+e,true).then((function(){}),(function(e){})),r.inited_ltsInstance()&&r.get_ltsInstance(Sa).s(Ht.licenseServer,false,""+e,true).then((function(){}),(function(e){}))},na.lclex=function(){var e=na.licenseException;e.code=0,e.message="",e.httpResponse="",e.fromLTS=!1},na.li=function(e,t){var n;if(e.axInstance&&(na.axInstance=e.axInstance,na.axInstance))return n=na.axInstance.GetUUID(),Ht.ltsDebug&&At.log("ActiveX cu: "+n),pa(e.instanceMode).set_cu(n),n;return pa(e.instanceMode).get_cu()},na.lfeab_ax=function(e){return new wt.Promise((function(t,n){var r="";if(na.axInstance)try{r=na.axInstance.Encrypt(e,0)}catch(i){}t(r)}))},na.lfeab_wasm=function(e){return wt.Promise.resolve("")},na.lwsproc=function(e,t){try{e=At.parse(e)}catch(n){return void(t.fFun&&t.fFun(n))}"GetBuffer"==e.method?t.sFun&&e.result.length>0?t.sFun(e.result[0],t.params):t.sFun("",t.params):t.sFun&&t.sFun(e)},na.lsexp=function(e,t,n){var r,i=t;if(3==(r=(i=At.replaceAll(i,"/","-")).split("-")).length){var o=r[0],a=r[1],s=r[2];a.length<2&&(a=(a="00"+a).substr(a.length-2)),s.length<2&&(s=(s="00"+s).substr(s.length-2)),i=[o,a,s].join("-")}var u=[i,"T23:59:59.999Z"].join("");pa(e).set_minExpiredTime(u),pa(e).set_maxExpiredTime(u)},na.lunload=function(){na.lavrf__unload();var e=pa(na.EnumInstance.dwt_desktop),t=pa(na.EnumInstance.dbr);e.clearData(),t.clearData(),aa=0,ra=At.nil,sa={},ca=!1,ua=!1,la=!1,fa=!1,da=!1,na.lclex(),na.bLTSOnline=!0,na.axInstance=At.nil,na.lOnUpdateDWObj=[]},na.lcexp=function(e,t){return pa(e).get_ltsInstance(Sa).caret().then((function(){return!1}),(function(e){var t=na.licenseException,n="";return e instanceof Error||"message"in e?n=e.message:At.isString(e)&&(n=e),na.lsetException(_a.Expired,n,!1),fa||(fa=!0,At.error(n),yt.OnLTSLicenseError&&yt.OnLTSLicenseError(ji.getPublicLicenseContent(t.message),t.code)),!0}))},na.OnLicenseException=function(){var e=na.licenseException,t=e.message;if(At.isString(t)&&(t.indexOf("Error Code")>-1?t=At.replaceAll(t,"Error Code","error code"):t.indexOf("Error code")>-1&&(t=At.replaceAll(t,"Error code","error code"))),t.indexOf("(https://www.dynamsoft.com/purchase-center/)")>-1&&(t=t.replace("(https://www.dynamsoft.com/purchase-center/)","(https://www.dynamsoft.com/store/dynamic-web-twain/)"),e.message=t),t.indexOf("error code:")>-1){var n=t.substr(0,t.indexOf("message")),r=t.substr(t.indexOf("message"));n.indexOf("{")>-1&&(n=n.substr(n.indexOf("{")+1)),r.indexOf("}")>-1&&(r=r.substr(0,r.indexOf("}"))),n=At.replaceAll(n,"error code:",""),r=At.replaceAll(r,"message: ",""),na.lsetException(parseInt(n),r,!0),At.error(r),yt.OnLTSLicenseError&&yt.OnLTSLicenseError(ji.getPublicLicenseContent(t),e.code)}else{if(!e.code){var i=_a.NetworkError;t.indexOf("timed out")>-1||t.indexOf("timeout")>-1?i=_a.Timedout:(t.indexOf("access-control-allow-origin")>-1||t.indexOf("cors")>-1)&&(i=_a.CorsError),na.lsetException(i,t,!0)}if(At.error(e.message),e.code==_a.LtsJsLoadError)return;yt.OnLTSLicenseError&&yt.OnLTSLicenseError(ji.getPublicLicenseContent(e.message),e.code)}},na.lol=function(){return na.bLTSOnline},na.OnFirstOffline=function(e){na.bLTSOnline=!1},na.lpubdlg=function(e,t){if(At.isString(e)&&""!=e){if(e=At.atob(e),console&&console.warn,1==t)return la||(la=!0,yt.OnLTSPublicLicenseWarning&&yt.OnLTSPublicLicenseWarning(ji.getPublicLicenseContent(e))),!0;2==t&&(la||(la=!0))}return!1},na.lcheckLic=function(e,t,n){var r=!1;if(t){if(At.isArray(t.Detail)&&t.Detail.length>0){var i=t.Detail[0].ExpireDate;return na.lsexp(e,i,n),na.lcexp(e,n).then((function(e){var n=!1;e?n=!0:1!=t.Trial&&2!=t.Trial||(n=na.lpubdlg(t.Message,t.Trial)),n||na.bLTSOnline||da||(da=!0,yt.OnLTSConnectionWarning&&yt.OnLTSConnectionWarning())}))}1!=t.Trial&&2!=t.Trial||(r=na.lpubdlg(t.Message,t.Trial))}return r||na.bLTSOnline||da||(da=!0,yt.OnLTSConnectionWarning&&yt.OnLTSConnectionWarning()),wt.Promise.resolve()},na.lisValidID=function(e){if(At.isString(e)&&""!=e)return!0;var t,n=na.licenseException;return na.lsetException(_a.UUIDError,"Failed to generate an ID for your device to license it: not enough permission.",!0),At.error(n.message),t=n.message,yt.OnLTSLicenseError&&yt.OnLTSLicenseError(t,n.code),!1},na.lsetException=function(e,t,n){var r=na.licenseException;r.code=e,r.message=t,At.isUndefined(n)||(r.fromLTS=n)},na.lgcuid=function(e){var t=yt.DWT.li({instanceMode:e},"");return t?wt.Promise.resolve(t):pa(e).get_ltsInstance(Sa).u().then((function(e){return yt.DWT.lsmid(e,""),yt.DWT.lsmid2b(e),e}))},(ma=ba.prototype).getSWebTwain=function(){return this._objectWebTwain},ma.getInstance=function(){return!!this._objectWebTwain&&this},ma._createControl=function(){var e,t,n=this,r=n._strWidth,i=n._strHeight;if(wt.isString(r)&&(r=r.indexOf("%")>0?"100%":parseInt(r)+2+"px"),wt.isString(i)&&(i=i.indexOf("%")>0?"100%":parseInt(i)+2+"px"),t=['<div id="',n._strDWTInnerContainerID,'" style="width:',r,";height:",i,'">'],z.bIE)yt.DWT.ActiveXInstallWithCAB?t.push('<object id="',n._strObjectName,'" style="width:',n._strWidth,";height:",n._strHeight,';border:1px solid #AAAAAA"',' codebase="',z.bWin64?Ht.getActiveXCABx64Path():Ht.getActiveXCABx86Path(),"#version=",xt.ActiveXVersion,'"',' classid="clsid:',Ht.strFullClassID,'" viewastext>','<param name="wmode" value="transparent"/>',"</object>"):t.push('<object id="',n._strObjectName,'" style="width:',n._strWidth,";height:",n._strHeight,';border:1px solid #AAAAAA"',' classid="clsid:',Ht.strFullClassID,'" viewastext>','<param name="wmode" value="transparent"/>',"</object>");else{var o=n._strWidth;wt.isString(o)&&-1==o.indexOf("%")&&(o=parseInt(o)-2+"px"),t.push('<embed id="',n._strObjectName,'" style="display: inline; width:',o,";height:",n._strHeight,'" type="',Ht.strMIMEType,'"',' pluginspage="',z.bWin?Ht.getMSIPath():Ht.getPKGPath(),'"></embed>')}t.push('</div><div id="',n._strDWTNonInstallInnerContainerID,'" style="width: ',r,';display:none"></div>'),(e=n._containerElement)&&(e.innerHTML=t.join("")),n._objectWebTwain=wt.get(n._strObjectName)},ma._createNonAllowedDivPlugin=function(){var e=this,t=wt.get(e._strDWTNonInstallInnerContainerID);if(""==t.innerHTML){var n=e._strHeight;wt.isString(n)&&-1==n.indexOf("%")&&(n=parseInt(n)-10+"px");var r=['<div style="display: block; border:1px solid black; width:',e._strWidth,";height:",n,'">','<div style="margin: 200px 0 0 0; padding: 5px; font-size: 16px;line-height: 30px; ">',"<div>The Component is not allowed to run on this site.</div>",'<div>Please click <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAYAAABG1c6oAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAJeSURBVDhPvZRNSxthEMeX0mNpKS09tP04tdBqobT9WCGJ5kU9pIk5xB4KaoJGmoiNMS+IUiqNB08mjUoUN2vU3WyS9d+ZIbvEZREP0j8Mk5ln5sfs7jxRcM/6f8BKpYKZmRlEIhGUSiUYhjE8uV2eQIal0xmobQ3aeQc/CwWUy+Xh6e3yBM7OzuJMbcPs9cUYzNPeRQLc29tDKpVCOBx2LJ3JQDe66Jo9fI3HEY1GnTOurdVqAnBLgFxwcNBAp3N5w0yTJiTTtA5UVXPy9XpDerwkwOnpaZydtWma/p3s8OgYcZraSwIMhULoXFx6NntZvf4XyWRSAG45QO38wrO51x/Asq7F27nbJMBEIoFm8wiLS0uYm0s6j88QfXUF6ucJXNMe2lAWx+qXD3I+KgHu7OwgEAjI/q2vr2N5eUUaebIWwRovFLTG38AaQtlzLPlP4wKyJcB8Pi83IpfLoVqtYmFh0ZnQ0nU0qHn/uSJ+0G7fiPl8VAL0+/20cyZdsTLm57+hdXIqQAdKE+1T869nCnZfK+I5dsNYAgwGg7i8MhwIG8cbG0Wafo1+X6FPk5VfPUDxqSK+r6oCcEuAU1NT0GhhDQLZVtwsIZvNShFPuDX+FqtPFORfPhS/9X5M8m4JkO/pyakKo0uwof3e/SMF3FQg2PfHCgoEMWlS9nbshgqQt755eIwr3RTYOV+vRlMK1j5OIPlIwY93YxgM39mAIBxzns9HJcDt7W3EYjH5OD6fD5OTk7KbrDo99go12TBbDOV8Peuxh5Zl0Z8ATUdFOjWy55jztt1VArw/Af8A9+n0bhYJ0I4AAAAASUVORK5CYII="/>','at the right end of the address bar and click "<b>Always allow plug-ins</b>". Then refresh/restart the browser.</div>',"</div></div>"].join("");t.innerHTML=r;for(var i=window.document,o=0;o<i.links.length;o++)"DWT_CloseNonAllowedDiv"==i.links[o].className&&(i.links[o].onclick=a)}function a(){wt.get(e._strDWTNonInstallInnerContainerID).style.display="none",wt.get(e._strDWTInnerContainerID).style.display="inline"}},ma.__unload=ma.dispose=function(){var e,t=this;if(t._containerElement)e=t._containerElement;else{var n=t._containerID;n&&(e=wt.get(n))}e&&(e.innerHTML=""),this._containerElement=null,delete yt.DWT.ContainerMap[t._containerID],delete yt.DWT.WebTwainIdMap[t._id]},ma._getErrorString=function(){return this._errorString},wt.detect._controlDetect=function(){var e=wt.detect.arySTwains,t=e[0],n=t&&t._objectWebTwain;if(n){var r,i=!1;if(z.bIE)r=!yt.navInfo.bOSx64||yt.navInfo.bWOW64?"DynamicPdfCore_"+xt.ActiveXPdfVersion+".dll":"DynamicPdfCorex64_"+xt.ActiveXPdfVersion+".dll",0==n.ErrorCode&&""!=n.GetAddOnVersion("pdf",r)&&(i=!0);else 0==n.ErrorCode&&(i=!0);if(i){clearInterval(wt.detect._varSeed);var o=function(t,n,r){var i,o;for(i=0;i<e.length;i++)o=e[i],wt.attachProperty(o),wt.attachMethod(o),o._attachEvents(),wt.detect.ssl&&(o.IfSSL=!0,o.HTTPPort=443),0==t?o.GetLicenseInfo(n).then((function(e){e&&o._setConvertMode(o._pdfConvertMode)})):(o._blts=!0,""!=n&&""!=r?(o.SetLTSInfo(n,r),o.GetLicenseInfo().then((function(e){return e&&o._setConvertMode(o._pdfConvertMode),yt.DWT.lcheckLic(yt.DWT.EnumInstance.dwt_desktop,e,"")}))):o.__licenseInfo={LTS:!0,Detail:[]},yt.DWT.laddDWTObj(o)),wt.attachAddon(o),o._objectWebTwain.BrokerProcessType=Ht._iBrokerProcessType,z.bWin||(o._objectWebTwain.ImageCaptureDriverType=Ht._iImageCaptureDriverType),wt.isFunction(o.__OnAxReady)&&o.__OnAxReady()};if(En()){var a=yt.DWT.li({instanceMode:yt.DWT.EnumInstance.dwt_desktop,axInstance:n},"");if(!yt.DWT.lisValidID(a))return void o(1,"","");Ia(yt.DWT.EnumInstance.dwt_desktop,"").then((function(e){o(1,e.ar,e.cu)}),(function(e){e&&(yt.DWT.lsetException(e.code||e.ltsErrorCode,e.message,!0),yt.DWT.OnLicenseException()),o(1,"","")}))}else o(0,yt.DWT.ProductKey,"")}else wt.detect.bNoControlEvent||(wt.noControl(t),wt.detect.bNoControlEvent=!0),wt.isFunction(t.__OnAxNotInstalled)&&t.__OnAxNotInstalled()}else clearInterval(wt.detect._varSeed)},wt.ie={},wt.ie.DynamicWebTwain=function(e){var t=new ba(e);return t._createControl(),wt.detect.arySTwains.push(t),t},wt.ie.closeAll=function(){var e,t,n,r=wt.detect.arySTwains;for(e=0;e<r.length;e++)(t=r[e])&&t._objectWebTwain&&(n=t._objectWebTwain)&&0==n.ErrorCode&&n.RemoveAllImages();wt.detect.arySTwains=[]},wt.closeAll=wt.ie.closeAll,yt.DWT.RemoveAllAuthorizations=function(){return!1},yt.DWT.GetWebTwain=yt.DWT.GetWebTwainEx=function(e){var t=e,n=yt.DWT.WebTwainIdMap;if(!t){var r=Object.keys(n);return r.length>0?n[t=r[0]]:void 0}if(t in n)return n[t];var i=yt.DWT.ContainerMap;return t in i?i[t]:void 0};var Ca=!1;function Aa(e,t){return Wa.apply(this,arguments)}function Wa(){return(Wa=t(l.mark((function e(t,n){var r,i;return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n&&gi(mi),ji.isLicenseMixed(null,!0)||ji.reparseProductKey(n),0==(r=yt.DWT.licenseException).code){e.next=6;break}throw t&&Ki(r),{code:r.code,message:r.message};case 6:if(Ca){e.next=11;break}if(i=!1,z.bIE&&(i=z.IEVersion<=7),i||!En()){e.next=11;break}return e.abrupt("return",new wt.Promise((function(e,t){var n=yt.DWT.ResourcesPath,r="";z.bFileSystem||(r=wt.timestamp),At.addScript([n,"/src/dynamsoft.lts.js",r].join(""),!0,!1,(function(){Ca=!0,e()}))})));case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ya,Pa=window;Pa.console=Pa.console||((ya={}).log=ya.warn=ya.debug=ya.info=ya.error=ya.time=ya.dir=ya.profile=ya.clear=ya.exception=ya.trace=ya.assert=function(){},ya),Pa.addEventListener("beforeunload",(function(){wt.page.bUnload=!0,yt.DWT.Unload(),wt.page.OnUnload&&wt.page.OnUnload()}));var Da,Oa,La=function(e){var t=e.VersionInfo;if(!wt.detect.bNeedUpgradeEvent&&!function(e){if(At.isUndefined(e))return!1;var t,n,r=jt(e.toString().toLowerCase());t=Ht.bActiveXEdition?xt.ActiveXVersion:Ht.getServerVersionInfo(!0),n=(t=At.replaceAll(String(t),"[.]",",")).split(",");for(var i=r.length>n.length?r.length:n.length,o=0;o<i;o++){if(null==r[o]&&(r[o]=0),null==n[o]&&(n[o]=0),parseInt(r[o])<parseInt(n[o]))return!1;if(parseInt(r[o])>parseInt(n[o]))return!0}return!0}(t)){if(wt.detect.bNeedUpgradeEvent=Kt,wt.isFunction(yt.DWT.OnWebTwainNeedUpgrade)&&yt.DWT.OnWebTwainNeedUpgrade())return;var n=e._containerElement;n&&(wt.one(n).before(wt.install._strNonInstallDIV),wt.show(wt.install._divDWTNonInstallContainerID),wt.hide(n)),""!=wt.install._divDWTemessageContainer&&wt.hide(wt.install._divDWTemessageContainer),function(e,t){if(wt.isFunction(yt.OnWebTwainNeedUpgradeCallback)){var n,r,i={};z.bWin&&(r=z.bIE||wt.product.bHTML5Edition?Ft.getDSPath():wt.product.getMSIPath(),n=Rt.enumWindow),i["default"]=r;var o=wt.one(".dynamsoft-dialog-license");o&&o.getEL()&&(o.getEL().style.display="none"),wt.detect.needUpgrade=Kt,yt.OnWebTwainNeedUpgradeCallback(wt.product.name,i,wt.product.bHTML5Edition,n,z.bIE,z.bSafari,wt.detect.ssl,ao.strIEVersion,wt.detect.bPromptJSOrServerOutdated,e,t)}}()}};function Na(){var e,t,n,r,i,o=yt.DWT.Containers,a=wt.Promise.resolve(0),s=yt.DWT.licenseException;if(o&&o.length>0){for(0==s.code?Pa.DCP_DWT_OnClickCloseInstall&&Pa.DCP_DWT_OnClickCloseInstall(!1,!0):wt.error(s.message),t=0;t<o.length;t++)if(wt.product.bActiveXEdition){if(o[t].Container?r=o[t].Container:o[t].ContainerId&&(r=wt.get(o[t].ContainerId)),!wa(r)||!r.id)continue;if(i=yt.DWT.ContainerMap[r.id])break;if(n=o[t].WebTwainId,i=yt.DWT.WebTwainIdMap[n])break}i&&La(i)}var u=!1;for(En()&&wt.isNumber(s.code)&&0!==s.code&&!0===s.fromLTS&&(u=!0),t=0;t<o.length;t++)n=o[t].ContainerId,(e=yt.DWT.ContainerMap[n])||(n=o[t].WebTwainId,e=yt.DWT.WebTwainIdMap[n]),e&&(u?wt.product.bActiveXEdition&&wt.hide(e._containerElement):wt.product.bActiveXEdition&&(e.IfAllowLocalCache=!0,e.IfShowFileDialog=!0,e.IfDisableSourceAfterAcquire=!0,e.BrokerProcessType=wt.product._iBrokerProcessType,0==t&&e.__licenseInfo&&(ji.checkProductKey(e,{Core:!0})||z.bWin&&ji.checkProductKey(e,{Webcam:!0},!0)||ji.checkProductKey(e,{Core:!0},!1)||zi(e)))),e=null;o=null,u?(yt.DWT.WebTwainIdMap={},yt.DWT.ContainerMap={},wt.detect.arySTwains.splice(0)):a=a.then((function(){setTimeout((function(){try{wt.isFunction(yt.DWT.OnWebTwainReady)?yt.DWT.OnWebTwainReady():wt.isFunction(Pa.Dynamsoft_OnReady)&&Pa.Dynamsoft_OnReady()}catch(t){e=t,window.console&&(e instanceof Error||At.isString(e)?window.console.error(e):window.console.error(At.stringify(e)))}var e}),100)}),(function(e){Xi(e)}))}function Ra(e,t,n){var r,i,o,a,s,u={id:e.WebTwainId,width:e.Width,height:e.Height};if(e.ContainerId?(u.container=wt.get(e.ContainerId),u.containerId=e.ContainerId):e.Container&&(u.container=e.Container,u.containerId=e.Container.id),(""==(r=u.id)||!At.isString(r)&&!At.isNumber(r)?Xt:Kt)||(u.id=["dwt_",At.getRandom()].join("")),function(e){var t=e||{};t.basePath&&(ao.basePath=t.basePath),t.pathType&&(ao.pathType=t.pathType),At.isUndefined(t.bDiscardBlankImage)||(ao.bDiscardBlankImage=t.bDiscardBlankImage),t.msgPrefix&&t.msgPrefix,t.msgSuffix&&t.msgSuffix,t.detectType&&(wt.detect.detectType=t.detectType),t.tryTimes&&(wt.detect.tryTimes=t.tryTimes);var n=yt.DWT.RemoteScanConfig;n||(n={sessionTimeout:300,keepAwake:!0},yt.DWT.RemoteScanConfig=n),n.keepAwake===undefined&&(n.keepAwake=!0)}(u),u.onAxReady=function(){if(yt.DWT.ContainerMap[u.containerId]=i.getInstance(),yt.DWT.WebTwainIdMap[u.id]=i.getInstance(),wt.isFunction(t)){var e={stwain:i.getInstance(),bError:!1};t(e)}},u.onAxNotInstalled=function(){var e={};!function(e){vn(e,-2800,"Please make sure the Dynamsoft Service has been installed.")}(e),wt.isFunction(n)&&n({code:e._errorCode,message:e._errorString})},i=new wt.ie.DynamicWebTwain(u),a=0,s=yt.DWT.Containers)for(o=s.length-1;o>=0;o--){var c=s[o];c.Container?wa(c.Container)&&a++:c.ContainerId&&wa(wt.get(c.ContainerId))&&a++}return wt.detect.arySTwains.length==a&&(wt.detect._varSeed=setInterval(wt.detect._controlDetect,200)),i}function xa(){if(!wt.detect.axAutoLoadDone){var e,t=yt.DWT.Containers;if(t)for(e=0;e<t.length;e++){var n=void 0;if(wa(wt.get(t[e].ContainerId))&&(n=t[e].ContainerId),n)if(!yt.DWT.ContainerMap[n])return void setTimeout(xa,200)}t=null,Na(),wt.detect.axAutoLoadDone=!0,Da()}}yt.DWT._innerLoad=t(l.mark((function Ba(){var e,t,n;return l.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return wt.page.bUnload=Xt,r.next=3,Aa(!0,!1);case 3:if((e=yt.DWT.Containers)&&0!==e.length){r.next=7;break}return wt.log("Dynamsoft.DWT.Containers was not set."),r.abrupt("return",Xt);case 7:for(t=0;t<e.length;t++)n=e[t],!wt.isString(n.WebTwainId)||wt.isString(n.ContainerId)&&""!=n.ContainerId||(n.ContainerId=n.WebTwainId),o=void 0,a=void 0,(i=n).ContainerId?o=i.ContainerId:i.Container&&(o=i.Container.id),(wa(wt.get(o))?((a=yt.DWT.ContainerMap[o])||wt.isString(i.WebTwainId)&&(a=yt.DWT.WebTwainIdMap[i.WebTwainId]),a?Xt:Kt):Xt)&&Ra(n,(function(){}),(function(e){Oa(e),wt.detect.axAutoLoadDone=!0}));return r.abrupt("return",wt.detect.axAutoLoadDone?wt.Promise.resolve():new wt.Promise((function(e,t){Da=e,Oa=t,setTimeout(xa,200)})));case 9:case"end":return r.stop()}var i,o,a}),Ba)})))}();
